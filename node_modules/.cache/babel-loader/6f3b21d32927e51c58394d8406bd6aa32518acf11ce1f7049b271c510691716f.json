{"ast":null,"code":"import _objectSpread from\"C:/bringo-edu/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Plus,Trash2,Download,AlertCircle,Users,Home,ChevronDown,ChevronUp,ClipboardList,Calendar,Sparkles,User,LogOut,LogIn,TrendingUp,BarChart3,Target,Award,AlertTriangle,Search,Share,Eye,EyeOff,PieChart}from'lucide-react';import{initializeApp}from'firebase/app';import{getAuth,createUserWithEmailAndPassword,signInWithEmailAndPassword,signOut,onAuthStateChanged}from'firebase/auth';import{getFirestore,collection,addDoc,getDocs,updateDoc,deleteDoc,doc,query,where}from'firebase/firestore';// Importar librerías REALES de exportación\nimport*as XLSX from'xlsx';import jsPDF from'jspdf';import'jspdf-autotable';import{Document,Packer,Paragraph,TextRun,Table,TableCell,TableRow,HeadingLevel,AlignmentType}from'docx';// Configuración de Firebase\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const firebaseConfig={apiKey:\"AIzaSyCdRpj7y3L4PIwWiJgzYRHDU3XxcIVfmW4\",authDomain:\"bringoedu.firebaseapp.com\",projectId:\"bringoedu\",storageBucket:\"bringoedu.firebasestorage.app\",messagingSenderId:\"667720262345\",appId:\"1:667720262345:web:ad55dd71c19ffcb73fa318\"};// Inicializar Firebase\nconst app=initializeApp(firebaseConfig);const auth=getAuth(app);const db=getFirestore(app);// Componente para gráfico de distribución\nconst DistribucionNotas=_ref=>{let{estudiantes,calcularPromedioFinal}=_ref;const calcularDistribucion=()=>{const distribucion={excelente:0,// 4.5 - 5.0\nbueno:0,// 3.5 - 4.4\nregular:0,// 3.0 - 3.4\nriesgo:0// 0 - 2.9\n};estudiantes.forEach(estudiante=>{const promedio=parseFloat(calcularPromedioFinal(estudiante));if(promedio>=4.5)distribucion.excelente++;else if(promedio>=3.5)distribucion.bueno++;else if(promedio>=3.0)distribucion.regular++;else if(promedio>0)distribucion.riesgo++;});return distribucion;};const distribucion=calcularDistribucion();const total=estudiantes.length;if(total===0){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8 text-gray-500\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No hay datos suficientes\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-semibold text-green-600\",children:\"Excelente (4.5-5.0)\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-bold\",children:[distribucion.excelente,\" (\",Math.round(distribucion.excelente/total*100),\"%)\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-green-500 h-3 rounded-full transition-all duration-500\",style:{width:\"\".concat(distribucion.excelente/total*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-semibold text-blue-600\",children:\"Bueno (3.5-4.4)\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-bold\",children:[distribucion.bueno,\" (\",Math.round(distribucion.bueno/total*100),\"%)\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-500 h-3 rounded-full transition-all duration-500\",style:{width:\"\".concat(distribucion.bueno/total*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-semibold text-yellow-600\",children:\"Regular (3.0-3.4)\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-bold\",children:[distribucion.regular,\" (\",Math.round(distribucion.regular/total*100),\"%)\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-yellow-500 h-3 rounded-full transition-all duration-500\",style:{width:\"\".concat(distribucion.regular/total*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-semibold text-red-600\",children:\"En Riesgo (0-2.9)\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-bold\",children:[distribucion.riesgo,\" (\",Math.round(distribucion.riesgo/total*100),\"%)\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-gray-200 rounded-full h-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-500 h-3 rounded-full transition-all duration-500\",style:{width:\"\".concat(distribucion.riesgo/total*100,\"%\")}})})]});};// Componente para Fila de Notas Rápidas\nconst FilaNotasRapidas=_ref2=>{let{estudiante,onAgregarNota,calcularPromedioFinal,claseSeleccionada,usuario,actualizarNota}=_ref2;const[notaDiaria,setNotaDiaria]=useState('');const[notaApreciacion,setNotaApreciacion]=useState('');const[notaExamen,setNotaExamen]=useState('');const[fecha,setFecha]=useState(new Date().toISOString().split('T')[0]);const handleAgregarNota=async(tipo,valor)=>{if(valor&&parseFloat(valor)>=0&&parseFloat(valor)<=5){try{await onAgregarNota(estudiante.id,tipo,parseFloat(valor),fecha);// Limpiar el campo\nif(tipo==='notasDiarias')setNotaDiaria('');if(tipo==='apreciacion')setNotaApreciacion('');if(tipo==='examen')setNotaExamen('');}catch(error){console.error('Error agregando nota:',error);alert('Error al agregar la nota');}}else{alert('Por favor ingresa una nota válida entre 0 y 5');}};const compartirPorWhatsApp=()=>{const formatoNotas=notas=>{return notas.filter(n=>n.valor&&parseFloat(n.valor)>0).map(n=>\"\\uD83D\\uDCC5 \".concat(n.fecha,\": \").concat(n.valor,\"/5.0\")).join('\\n')||'📭 Sin notas registradas';};const mensaje=\"\\uD83D\\uDCCA *REPORTE DE NOTAS - \".concat(claseSeleccionada===null||claseSeleccionada===void 0?void 0:claseSeleccionada.nombre,\"*\\n\\n*Estudiante:* \").concat(estudiante.nombre,\"\\n*Profesor:* \").concat(usuario===null||usuario===void 0?void 0:usuario.nombre,\"\\n*Instituci\\xF3n:* \").concat((claseSeleccionada===null||claseSeleccionada===void 0?void 0:claseSeleccionada.institucion)||'Bringo Edu',\"\\n*Fecha de reporte:* \").concat(new Date().toLocaleDateString('es-PA'),\"\\n\\n*\\uD83D\\uDCDD NOTAS DIARIAS:*\\n\").concat(formatoNotas(estudiante.notasDiarias),\"\\n\\n*\\u2B50 APRECIACI\\xD3N:*\\n\").concat(formatoNotas(estudiante.apreciacion),\"\\n\\n*\\uD83D\\uDCCB EXAMEN:*\\n\").concat(formatoNotas(estudiante.examen),\"\\n\\n*\\uD83C\\uDFC6 PROMEDIO FINAL:* \").concat(calcularPromedioFinal(estudiante),\"/5.0\\n\\n---\\nGenerado con Bringo Edu \\uD83D\\uDCDA | Transparente y Confiable\");const url=\"https://wa.me/?text=\".concat(encodeURIComponent(mensaje));window.open(url,'_blank');};return/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b border-gray-200 hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 font-semibold\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-purple-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm\",children:estudiante.nombre.charAt(0).toUpperCase()}),/*#__PURE__*/_jsx(\"span\",{children:estudiante.nombre})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.1\",min:\"0\",max:\"5\",placeholder:\"0-5\",value:notaDiaria,onChange:e=>setNotaDiaria(e.target.value),className:\"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 text-center\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAgregarNota('notasDiarias',notaDiaria),className:\"bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 transition text-sm font-semibold\",children:\"+\"})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.1\",min:\"0\",max:\"5\",placeholder:\"0-5\",value:notaApreciacion,onChange:e=>setNotaApreciacion(e.target.value),className:\"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-green-500 text-center\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAgregarNota('apreciacion',notaApreciacion),className:\"bg-green-600 text-white px-3 py-2 rounded-lg hover:bg-green-700 transition text-sm font-semibold\",children:\"+\"})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.1\",min:\"0\",max:\"5\",placeholder:\"0-5\",value:notaExamen,onChange:e=>setNotaExamen(e.target.value),className:\"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 text-center\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAgregarNota('examen',notaExamen),className:\"bg-purple-600 text-white px-3 py-2 rounded-lg hover:bg-purple-700 transition text-sm font-semibold\",children:\"+\"})]})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-xl font-bold \".concat(parseFloat(calcularPromedioFinal(estudiante))>=4.5?'text-green-600':parseFloat(calcularPromedioFinal(estudiante))>=3.5?'text-blue-600':parseFloat(calcularPromedioFinal(estudiante))>=3.0?'text-yellow-600':'text-red-600'),children:calcularPromedioFinal(estudiante)})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-center\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:compartirPorWhatsApp,className:\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition font-semibold flex items-center gap-2 text-sm\",children:[/*#__PURE__*/_jsx(Share,{className:\"w-4 h-4\"}),\"WhatsApp\"]})})]});};// Componente de Modal Login\nconst ModalLogin=_ref3=>{let{mostrarLogin,setMostrarLogin,email,setEmail,password,setPassword,errorAuth,cargandoAuth,iniciarSesion,limpiarFormulariosAuth,setMostrarRegistro}=_ref3;const[mostrarPassword,setMostrarPassword]=useState(false);if(!mostrarLogin)return null;const handleSubmit=e=>{e.preventDefault();iniciarSesion();};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-gradient-to-br from-purple-900/95 via-blue-900/95 to-indigo-900/95 backdrop-blur-sm flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-3xl shadow-2xl max-w-md w-full overflow-hidden transform transition-all\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 p-8 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block bg-white rounded-full p-4 mb-4 shadow-lg\",children:/*#__PURE__*/_jsx(LogIn,{className:\"w-8 h-8 text-purple-600\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-3xl font-bold text-white mb-2\",children:\"\\xA1Bienvenido de nuevo!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-purple-100 text-sm\",children:\"Ingresa a tu cuenta de Bringo Edu\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"p-8\",children:[errorAuth&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border-2 border-red-200 rounded-lg p-3 mb-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-red-800 text-sm font-semibold\",children:errorAuth})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-5\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-purple-600\",children:\"\\uD83D\\uDCE7\"}),\" Email\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"profesor@ejemplo.com\",value:email,onChange:e=>setEmail(e.target.value),className:\"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-purple-600\",children:\"\\uD83D\\uDD12\"}),\" Contrase\\xF1a\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:mostrarPassword?\"text\":\"password\",placeholder:\"\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\",value:password,onChange:e=>setPassword(e.target.value),className:\"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all pr-12\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setMostrarPassword(!mostrarPassword),className:\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition\",children:mostrarPassword?/*#__PURE__*/_jsx(EyeOff,{className:\"w-5 h-5\"}):/*#__PURE__*/_jsx(Eye,{className:\"w-5 h-5\"})})]})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:cargandoAuth,className:\"w-full mt-8 py-4 rounded-xl font-bold text-lg shadow-lg transition-all \".concat(cargandoAuth?'bg-gray-400 cursor-not-allowed':'bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 hover:shadow-xl transform hover:scale-[1.02]',\" text-white\"),children:cargandoAuth?'Iniciando sesión...':'Iniciar Sesión'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setMostrarLogin(false);limpiarFormulariosAuth();},className:\"w-full mt-3 bg-gray-100 text-gray-700 py-3 rounded-xl hover:bg-gray-200 transition font-semibold\",children:\"Cancelar\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm mb-2\",children:\"\\xBFNo tienes cuenta?\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setMostrarLogin(false);setMostrarRegistro(true);},className:\"text-purple-600 hover:text-purple-800 font-bold text-lg hover:underline\",children:\"Reg\\xEDstrate aqu\\xED\"})]})]})]})});};// Componente de Modal Registro\nconst ModalRegistro=_ref4=>{let{mostrarRegistro,setMostrarRegistro,email,setEmail,password,setPassword,nombreUsuario,setNombreUsuario,confirmarPassword,setConfirmarPassword,errorAuth,cargandoAuth,registrarUsuario,limpiarFormulariosAuth,setMostrarLogin}=_ref4;const[mostrarPassword,setMostrarPassword]=useState(false);const[mostrarConfirmarPassword,setMostrarConfirmarPassword]=useState(false);if(!mostrarRegistro)return null;const handleSubmit=e=>{e.preventDefault();registrarUsuario();};return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-gradient-to-br from-green-900/95 via-teal-900/95 to-blue-900/95 backdrop-blur-sm flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-3xl shadow-2xl max-w-md w-full overflow-hidden transform transition-all\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-green-600 via-teal-600 to-blue-600 p-8 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block bg-white rounded-full p-4 mb-4 shadow-lg\",children:/*#__PURE__*/_jsx(User,{className:\"w-8 h-8 text-green-600\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-3xl font-bold text-white mb-2\",children:\"\\xA1\\xDAnete a Bringo Edu!\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-green-100 text-sm\",children:\"Crea tu cuenta y comienza a gestionar tus clases\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"p-8\",children:[errorAuth&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border-2 border-red-200 rounded-lg p-3 mb-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-red-800 text-sm font-semibold\",children:errorAuth})}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-5\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\uD83D\\uDC64\"}),\" Nombre Completo\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Prof. Juan P\\xE9rez\",value:nombreUsuario,onChange:e=>setNombreUsuario(e.target.value),className:\"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 transition-all\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\uD83D\\uDCE7\"}),\" Email\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"profesor@escuela.edu\",value:email,onChange:e=>setEmail(e.target.value),className:\"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 transition-all\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\uD83D\\uDD12\"}),\" Contrase\\xF1a\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:mostrarPassword?\"text\":\"password\",placeholder:\"M\\xEDnimo 6 caracteres\",value:password,onChange:e=>setPassword(e.target.value),className:\"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 transition-all pr-12\",required:true,minLength:6}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setMostrarPassword(!mostrarPassword),className:\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition\",children:mostrarPassword?/*#__PURE__*/_jsx(EyeOff,{className:\"w-5 h-5\"}):/*#__PURE__*/_jsx(Eye,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-500 mt-1 ml-1\",children:\"Usa letras, n\\xFAmeros y s\\xEDmbolos\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\u2705\"}),\" Confirmar Contrase\\xF1a\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:mostrarConfirmarPassword?\"text\":\"password\",placeholder:\"Repite tu contrase\\xF1a\",value:confirmarPassword,onChange:e=>setConfirmarPassword(e.target.value),className:\"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 transition-all pr-12\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setMostrarConfirmarPassword(!mostrarConfirmarPassword),className:\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition\",children:mostrarConfirmarPassword?/*#__PURE__*/_jsx(EyeOff,{className:\"w-5 h-5\"}):/*#__PURE__*/_jsx(Eye,{className:\"w-5 h-5\"})})]})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:cargandoAuth,className:\"w-full mt-8 py-4 rounded-xl font-bold text-lg shadow-lg transition-all \".concat(cargandoAuth?'bg-gray-400 cursor-not-allowed':'bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700 hover:shadow-xl transform hover:scale-[1.02]',\" text-white\"),children:cargandoAuth?'Creando cuenta...':'Crear Cuenta'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setMostrarRegistro(false);limpiarFormulariosAuth();},className:\"w-full mt-3 bg-gray-100 text-gray-700 py-3 rounded-xl hover:bg-gray-200 transition font-semibold\",children:\"Cancelar\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm mb-2\",children:\"\\xBFYa tienes cuenta?\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setMostrarRegistro(false);setMostrarLogin(true);},className:\"text-green-600 hover:text-green-800 font-bold text-lg hover:underline\",children:\"Inicia sesi\\xF3n aqu\\xED\"})]})]})]})});};// Componente de Barra de Búsqueda de ESTUDIANTES MEJORADO con sugerencias\nconst BarraBusquedaEstudiantes=_ref5=>{let{estudiantes,onBuscarEstudiante,busquedaEstudiante,setBusquedaEstudiante}=_ref5;const[sugerencias,setSugerencias]=useState([]);const[mostrarSugerencias,setMostrarSugerencias]=useState(false);// Normalizar texto para búsqueda (minúsculas, sin tildes, sin comas)\nconst normalizarTexto=texto=>{return texto.toLowerCase().normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g,\"\")// eliminar tildes\n.replace(/[.,]/g,\"\");// eliminar comas y puntos\n};// Filtrar sugerencias en tiempo real\nuseEffect(()=>{if(busquedaEstudiante.length>=2){const textoBusqueda=normalizarTexto(busquedaEstudiante);const sugerenciasFiltradas=estudiantes.filter(estudiante=>normalizarTexto(estudiante.nombre).includes(textoBusqueda));setSugerencias(sugerenciasFiltradas);setMostrarSugerencias(true);}else{setSugerencias([]);setMostrarSugerencias(false);}},[busquedaEstudiante,estudiantes]);const buscarYRedirigirEstudiante=nombre=>{if(!nombre.trim())return;const estudianteEncontrado=estudiantes.find(e=>normalizarTexto(e.nombre).includes(normalizarTexto(nombre)));if(estudianteEncontrado){onBuscarEstudiante(estudianteEncontrado);setBusquedaEstudiante('');setMostrarSugerencias(false);}else{alert('Estudiante no encontrado');}};const seleccionarSugerencia=estudiante=>{onBuscarEstudiante(estudiante);setBusquedaEstudiante('');setMostrarSugerencias(false);};return/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-r from-blue-100 to-purple-100 rounded-xl p-4 mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row gap-4 items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 w-full relative\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-bold text-gray-700 mb-2\",children:\"\\uD83D\\uDD0D Buscar Estudiante\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Escribe el nombre del estudiante...\",value:busquedaEstudiante,onChange:e=>setBusquedaEstudiante(e.target.value),onKeyPress:e=>e.key==='Enter'&&buscarYRedirigirEstudiante(busquedaEstudiante),className:\"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 text-sm md:text-base\"}),mostrarSugerencias&&sugerencias.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto\",children:sugerencias.map(estudiante=>/*#__PURE__*/_jsx(\"div\",{onClick:()=>seleccionarSugerencia(estudiante),className:\"px-4 py-3 hover:bg-purple-50 cursor-pointer border-b border-gray-100 last:border-b-0\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-purple-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm\",children:estudiante.nombre.charAt(0).toUpperCase()}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:estudiante.nombre})]})},estudiante.id))})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-600 mt-2\",children:\"\\uD83D\\uDCA1 Comienza a escribir para ver sugerencias. Ignora may\\xFAsculas, tildes y comas.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 md:mt-6\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>buscarYRedirigirEstudiante(busquedaEstudiante),className:\"bg-purple-600 text-white px-4 md:px-6 py-3 rounded-lg hover:bg-purple-700 transition font-bold flex items-center gap-2 text-sm md:text-base\",children:[/*#__PURE__*/_jsx(Search,{className:\"w-4 h-4 md:w-5 md:h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline\",children:\"Buscar\"})]})})]})});};// Componente para Cuadro de Porcentajes (En construcción)\nconst CuadroPorcentajes=()=>{return/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-2xl shadow-lg p-8 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-md mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-yellow-100 border-2 border-yellow-300 rounded-xl p-6 mb-6\",children:[/*#__PURE__*/_jsx(PieChart,{className:\"w-16 h-16 text-yellow-600 mx-auto mb-4\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold text-yellow-800 mb-2\",children:\"En Construcci\\xF3n\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-yellow-700\",children:\"Estamos trabajando en el Cuadro de Porcentajes. Pronto tendr\\xE1s acceso a estad\\xEDsticas detalladas y an\\xE1lisis avanzados de rendimiento.\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-100 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"\\uD83D\\uDCCA \",/*#__PURE__*/_jsx(\"strong\",{children:\"Pr\\xF3ximamente:\"}),\" Gr\\xE1ficos de porcentajes, an\\xE1lisis comparativos, tendencias de rendimiento y m\\xE1s herramientas de an\\xE1lisis educativo.\"]})})]})});};// Utilidades comunes\nconst normalizarDatos=datosIn=>{try{if(typeof datosIn==='string')return JSON.parse(datosIn);return datosIn!==null&&datosIn!==void 0?datosIn:{};}catch(_unused){return datosIn;}};const objetoATabla=obj=>{return Object.entries(obj).map(_ref6=>{let[key,value]=_ref6;return{Campo:key,Valor:typeof value==='object'?JSON.stringify(value):String(value)};});};const descargarBlob=(blob,nombreArchivo)=>{const url=URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.download=nombreArchivo;document.body.appendChild(link);link.click();document.body.removeChild(link);URL.revokeObjectURL(url);};// Exportar a Excel (arreglado)\nconst exportarAExcel=(datosIn,nombreArchivo)=>{try{const datos=normalizarDatos(datosIn);const workbook=XLSX.utils.book_new();let worksheet;if(Array.isArray(datos)){worksheet=XLSX.utils.json_to_sheet(datos);}else if(typeof datos==='object'&&datos){worksheet=XLSX.utils.json_to_sheet(objetoATabla(datos));}else{worksheet=XLSX.utils.json_to_sheet([{Valor:String(datos)}]);}XLSX.utils.book_append_sheet(workbook,worksheet,'Datos');XLSX.writeFile(workbook,\"\".concat(nombreArchivo,\".xlsx\"));console.log('✅ Archivo Excel generado exitosamente');}catch(error){console.error('❌ Error al exportar a Excel:',error);alert('Error al generar archivo Excel');}};// Exportar a PDF (arreglado)\n// FUNCIONES DE EXPORTACIÓN CORREGIDAS - BACKEND FUNCIONA\nconst exportarAPDF=(datosIn,nombreArchivo)=>{try{const datos=normalizarDatos(datosIn);// Crear instancia de jsPDF\nconst doc=new jsPDF();// Configuración inicial\ndoc.setFontSize(16);doc.setTextColor(40);doc.text('Reporte Bringo Edu',20,20);doc.setFontSize(10);doc.setTextColor(100);doc.text(\"Generado: \".concat(new Date().toLocaleDateString('es-PA')),20,30);let yPosition=45;// Función auxiliar para agregar tabla\nconst agregarTabla=(titulo,datosTabla)=>{if(!Array.isArray(datosTabla)||datosTabla.length===0)return;// Verificar si necesitamos nueva página\nif(yPosition>260){doc.addPage();yPosition=20;}// Agregar título\ndoc.setFontSize(12);doc.setTextColor(40);doc.text(titulo,20,yPosition);yPosition+=8;// Preparar datos para la tabla\nconst headers=Object.keys(datosTabla[0]||{});const body=datosTabla.map(fila=>headers.map(header=>{const valor=fila[header];// Manejar diferentes tipos de datos\nif(valor===null||valor===undefined)return'';if(typeof valor==='object')return JSON.stringify(valor);return String(valor);}));// Usar autoTable correctamente - FORMA SIMPLIFICADA Y SEGURA\ndoc.autoTable({startY:yPosition,head:[headers],body:body,styles:{fontSize:8,cellPadding:2,overflow:'linebreak'},headStyles:{fillColor:[128,100,255],textColor:255,fontStyle:'bold'},margin:{left:15,right:15},tableWidth:'auto'});// Actualizar posición Y\nyPosition=doc.lastAutoTable.finalY+10;};// Procesar datos según el tipo\nif(Array.isArray(datos)){agregarTabla('Datos del Reporte',datos);}else if(typeof datos==='object'&&datos!==null){// Convertir objeto a array para tabla\nconst datosArray=Object.entries(datos).map(_ref7=>{let[clave,valor]=_ref7;return{Campo:clave,Valor:typeof valor==='object'?JSON.stringify(valor,null,2):String(valor)};});agregarTabla('Resumen del Reporte',datosArray);// Procesar arrays dentro del objeto\nObject.entries(datos).forEach(_ref8=>{let[clave,valor]=_ref8;if(Array.isArray(valor)&&valor.length>0){if(typeof valor[0]==='object'){agregarTabla(clave,valor);}else{// Si es array de valores simples\nconst arraySimple=valor.map((v,i)=>({'#':i+1,'Valor':v}));agregarTabla(clave,arraySimple);}}});}else{agregarTabla('Datos',[{Valor:String(datos)}]);}// Guardar el PDF\ndoc.save(\"\".concat(nombreArchivo,\".pdf\"));console.log('✅ Archivo PDF generado exitosamente');}catch(error){console.error('❌ Error al exportar a PDF:',error);alert('Error al generar archivo PDF: '+error.message);}};// Exportar a Word (CORREGIDO para navegador)\nconst exportarAWord=async(datosIn,nombreArchivo)=>{try{const datos=normalizarDatos(datosIn);const children=[];children.push(new Paragraph({children:[new TextRun({text:'Reporte Bringo Edu',bold:true,size:32})],alignment:AlignmentType.CENTER,spacing:{after:400}}),new Paragraph({children:[new TextRun({text:\"Generado: \".concat(new Date().toLocaleDateString('es-PA')),italics:true,size:20})],alignment:AlignmentType.CENTER,spacing:{after:400}}));if(Array.isArray(datos)&&datos.length>0){const headers=Object.keys(datos[0]);const tableRows=[new TableRow({children:headers.map(key=>new TableCell({children:[new Paragraph({children:[new TextRun({text:key,bold:true})]})],shading:{fill:'D0C9FF'}}))}),...datos.map(row=>new TableRow({children:headers.map(key=>{var _row$key;return new TableCell({children:[new Paragraph({children:[new TextRun({text:typeof row[key]==='object'?JSON.stringify(row[key]):String((_row$key=row[key])!==null&&_row$key!==void 0?_row$key:'')})]})]});})}))];children.push(new Paragraph({children:[new TextRun({text:'Datos del Reporte',bold:true,size:24})],spacing:{after:200}}),new Table({width:{size:100,type:'pct'},rows:tableRows}));}else if(typeof datos==='object'&&datos){Object.entries(datos).forEach(_ref9=>{let[key,value]=_ref9;children.push(new Paragraph({children:[new TextRun({text:\"\".concat(key,\": \"),bold:true,size:20}),new TextRun({text:typeof value==='object'?JSON.stringify(value,null,2):String(value!==null&&value!==void 0?value:''),size:20})],spacing:{after:200}}));});}else{children.push(new Paragraph({children:[new TextRun({text:String(datos!==null&&datos!==void 0?datos:''),size:20})]}));}const doc=new Document({sections:[{properties:{},children}]});// CAMBIO PRINCIPAL: Usar toBlob() en lugar de toBuffer()\nconst blob=await Packer.toBlob(doc);// Descargar directamente el blob\nconst url=URL.createObjectURL(blob);const link=document.createElement('a');link.href=url;link.download=\"\".concat(nombreArchivo,\".docx\");document.body.appendChild(link);link.click();document.body.removeChild(link);URL.revokeObjectURL(url);console.log('✅ Archivo Word generado exitosamente');}catch(error){console.error('❌ Error al exportar a Word:',error);alert('Error al generar archivo Word: '+error.message);}};// Función optimizada para generar blob de PDF (para Google Drive)\nconst generarBlobPDF=datosIn=>{return new Promise((resolve,reject)=>{try{const datos=normalizarDatos(datosIn);const doc=new jsPDF();// Configuración del documento\ndoc.setFontSize(16);doc.setTextColor(40);doc.text('Reporte Bringo Edu',20,20);doc.setFontSize(10);doc.setTextColor(100);doc.text(\"Generado: \".concat(new Date().toLocaleDateString('es-PA')),20,30);let yPosition=45;const agregarTabla=(titulo,datosTabla)=>{if(!Array.isArray(datosTabla)||datosTabla.length===0)return;if(yPosition>260){doc.addPage();yPosition=20;}doc.setFontSize(12);doc.setTextColor(40);doc.text(titulo,20,yPosition);yPosition+=8;const headers=Object.keys(datosTabla[0]||{});const body=datosTabla.map(fila=>headers.map(header=>{const valor=fila[header];if(valor===null||valor===undefined)return'';if(typeof valor==='object')return JSON.stringify(valor);return String(valor);}));// AutoTable seguro\ndoc.autoTable({startY:yPosition,head:[headers],body:body,styles:{fontSize:8,cellPadding:2,overflow:'linebreak'},headStyles:{fillColor:[128,100,255],textColor:255,fontStyle:'bold'},margin:{left:15,right:15}});yPosition=doc.lastAutoTable.finalY+10;};// Lógica de procesamiento de datos\nif(Array.isArray(datos)){agregarTabla('Datos del Reporte',datos);}else if(typeof datos==='object'&&datos!==null){const datosArray=Object.entries(datos).map(_ref0=>{let[clave,valor]=_ref0;return{Campo:clave,Valor:typeof valor==='object'?JSON.stringify(valor,null,2):String(valor)};});agregarTabla('Resumen del Reporte',datosArray);Object.entries(datos).forEach(_ref1=>{let[clave,valor]=_ref1;if(Array.isArray(valor)&&valor.length>0){if(typeof valor[0]==='object'){agregarTabla(clave,valor);}else{const arraySimple=valor.map((v,i)=>({'#':i+1,'Valor':v}));agregarTabla(clave,arraySimple);}}});}else{agregarTabla('Datos',[{Valor:String(datos)}]);}// Generar blob\nconst blob=doc.output('blob');resolve({blob,ext:'pdf',mime:'application/pdf'});}catch(error){reject(error);}});};// Generar Blob por formato (útil también para Google Drive) - CORREGIDO\nconst generarBlobPorFormato=async(datosIn,formato)=>{const datos=normalizarDatos(datosIn);console.log(\"\\uD83D\\uDCCA Generando blob para formato: \".concat(formato),datos);if(formato==='excel'){const workbook=XLSX.utils.book_new();let worksheet;if(Array.isArray(datos)){worksheet=XLSX.utils.json_to_sheet(datos);}else if(typeof datos==='object'&&datos!==null){worksheet=XLSX.utils.json_to_sheet(objetoATabla(datos));}else{worksheet=XLSX.utils.json_to_sheet([{Valor:String(datos)}]);}XLSX.utils.book_append_sheet(workbook,worksheet,'Datos');const arrayBuffer=XLSX.write(workbook,{bookType:'xlsx',type:'array'});return{blob:new Blob([arrayBuffer],{type:'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'}),ext:'xlsx',mime:'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'};}if(formato==='pdf'){return await generarBlobPDF(datos);}if(formato==='word'){const children=[new Paragraph({children:[new TextRun({text:'Reporte Bringo Edu',bold:true,size:32})],alignment:AlignmentType.CENTER,spacing:{after:400}}),new Paragraph({children:[new TextRun({text:\"Generado: \".concat(new Date().toLocaleDateString('es-PA')),italics:true,size:20})],alignment:AlignmentType.CENTER,spacing:{after:400}})];if(Array.isArray(datos)&&datos.length>0){const headers=Object.keys(datos[0]);const rows=[new TableRow({children:headers.map(k=>new TableCell({children:[new Paragraph({children:[new TextRun({text:k,bold:true})]})],shading:{fill:'D0C9FF'}}))}),...datos.map(row=>new TableRow({children:headers.map(k=>{var _row$k;return new TableCell({children:[new Paragraph({children:[new TextRun({text:typeof row[k]==='object'?JSON.stringify(row[k]):String((_row$k=row[k])!==null&&_row$k!==void 0?_row$k:'')})]})]});})}))];children.push(new Paragraph({children:[new TextRun({text:'Datos del Reporte',bold:true,size:24})],spacing:{after:200}}),new Table({width:{size:100,type:'pct'},rows}));}else if(typeof datos==='object'&&datos){Object.entries(datos).forEach(_ref10=>{let[key,value]=_ref10;children.push(new Paragraph({children:[new TextRun({text:\"\".concat(key,\": \"),bold:true,size:20}),new TextRun({text:typeof value==='object'?JSON.stringify(value,null,2):String(value!==null&&value!==void 0?value:''),size:20})],spacing:{after:200}}));});}else{children.push(new Paragraph({children:[new TextRun({text:String(datos!==null&&datos!==void 0?datos:''),size:20})]}));}const docx=new Document({sections:[{properties:{},children}]});const blob=await Packer.toBlob(docx);return{blob,ext:'docx',mime:'application/vnd.openxmlformats-officedocument.wordprocessingml.document'};}throw new Error(\"Formato no soportado: \".concat(formato));};// Subir a Google Drive (REAL con backend) - MEJORADO\nconst subirAGoogleDrive=async function(datosIn,nombreArchivoBase){let formato=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'pdf';try{console.log('🔄 Iniciando subida a Google Drive...',{nombreArchivoBase,formato});const{blob,ext,mime}=await generarBlobPorFormato(datosIn,formato);const nombreArchivo=\"\".concat(nombreArchivoBase,\".\").concat(ext);console.log('📦 Preparando FormData...',{nombreArchivo,tipo:mime});const formData=new FormData();formData.append('file',blob,nombreArchivo);formData.append('filename',nombreArchivo);formData.append('mimeType',mime);// Configurar headers de autenticación\nlet headers={'Accept':'application/json'};// Agregar token de autenticación si está disponible\nif(auth!==null&&auth!==void 0&&auth.currentUser){try{const token=await auth.currentUser.getIdToken();headers['Authorization']=\"Bearer \".concat(token);console.log('🔐 Token de autenticación incluido');}catch(tokenError){console.warn('⚠️ No se pudo obtener token, intentando sin autenticación');}}const DRIVE_UPLOAD_URL='https://bringo-edu-backend-2.onrender.com/api/drive/upload';console.log('🚀 Enviando a:',DRIVE_UPLOAD_URL);// Timeout de 25 segundos\nconst controller=new AbortController();const timeoutId=setTimeout(()=>controller.abort(),25000);const response=await fetch(DRIVE_UPLOAD_URL,{method:'POST',headers:headers,body:formData,signal:controller.signal});clearTimeout(timeoutId);console.log('📨 Respuesta del servidor:',response.status);if(!response.ok){const errorText=await response.text();console.error('❌ Error response:',errorText);throw new Error(\"Error \".concat(response.status,\": \").concat(errorText||'Error del servidor'));}const result=await response.json();console.log('✅ Subida a Drive exitosa:',result);// Mostrar mensaje de éxito\nalert(\"\\uD83C\\uDF89 \\xA1Archivo subido exitosamente a Google Drive!\\n\\n\\uD83D\\uDCC1 Nombre: \".concat(nombreArchivo,\"\\n\\uD83D\\uDCCA Tipo: \").concat(formato.toUpperCase()));return result;}catch(error){console.error('❌ Error completo en subida a Drive:',error);let mensajeUsuario='Error al subir a Google Drive';if(error.name==='AbortError'){mensajeUsuario='⏰ El servidor tardó demasiado en responder. Intenta nuevamente.';}else if(error.message.includes('Failed to fetch')){mensajeUsuario='🌐 Error de conexión. Verifica tu internet e intenta nuevamente.';}else if(error.message.includes('404')){mensajeUsuario='🔍 Servicio no encontrado. El backend podría estar en mantenimiento.';}else{mensajeUsuario=\"\\u274C \".concat(error.message);}alert(mensajeUsuario);throw error;}};// Componente OpcionesExportacion mejorado\nfunction OpcionesExportacion(_ref11){let{datos,nombreArchivo,onExportar}=_ref11;const[mostrarOpciones,setMostrarOpciones]=useState(false);const[mostrarDrive,setMostrarDrive]=useState(false);const[exportando,setExportando]=useState('');const handleExportar=async function(formato){let destino=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'descarga';const operacion=\"\".concat(destino,\"-\").concat(formato);setExportando(operacion);try{console.log(\"\\uD83D\\uDE80 Iniciando exportaci\\xF3n: \".concat(destino,\" - \").concat(formato));if(destino==='descarga'){switch(formato){case'excel':exportarAExcel(datos,nombreArchivo);break;case'pdf':exportarAPDF(datos,nombreArchivo);break;case'word':await exportarAWord(datos,nombreArchivo);break;}alert(\"\\u2705 Descarga completada: \".concat(formato.toUpperCase()));}else if(destino==='drive'){await subirAGoogleDrive(datos,nombreArchivo,formato);// El alert ya se muestra en subirAGoogleDrive\n}setMostrarOpciones(false);setMostrarDrive(false);if(onExportar)onExportar(formato,destino);}catch(error){console.error(\"Error en exportaci\\xF3n \".concat(formato,\" a \").concat(destino,\":\"),error);// El error ya se muestra en las funciones individuales\n}finally{setExportando('');}};const getBotonTexto=(formato,destino)=>{if(exportando===\"\".concat(destino,\"-\").concat(formato)){return'⏳ Procesando...';}const formatos={excel:'📊 Excel',pdf:'📄 PDF',word:'📝 Word'};const destinos={descarga:'Descargar',drive:'Subir a Drive'};return\"\".concat(destinos[destino],\" \").concat(formatos[formato]);};return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setMostrarOpciones(v=>!v);setMostrarDrive(false);},disabled:!!exportando,className:\"bg-gradient-to-r from-purple-600 to-blue-600 text-white px-4 py-2 rounded-lg hover:from-purple-700 hover:to-blue-700 transition font-bold flex items-center gap-2 \".concat(exportando?'opacity-50 cursor-not-allowed':''),children:exportando?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"}),\"Exportando...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Download,{className:\"w-5 h-5\"}),\"Exportar\"]})}),mostrarOpciones&&!exportando&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-xl border border-gray-200 z-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-2\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-bold text-gray-700 mb-2 px-2\",children:\"\\uD83D\\uDCE5 Descargar Localmente\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleExportar('excel','descarga'),className:\"w-full px-4 py-3 text-left hover:bg-green-50 flex items-center gap-2 rounded-lg border-b border-gray-100 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\uD83D\\uDCCA\"}),/*#__PURE__*/_jsx(\"span\",{children:getBotonTexto('excel','descarga')})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleExportar('pdf','descarga'),className:\"w-full px-4 py-3 text-left hover:bg-red-50 flex items-center gap-2 rounded-lg border-b border-gray-100 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-red-600\",children:\"\\uD83D\\uDCC4\"}),/*#__PURE__*/_jsx(\"span\",{children:getBotonTexto('pdf','descarga')})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleExportar('word','descarga'),className:\"w-full px-4 py-3 text-left hover:bg-blue-50 flex items-center gap-2 rounded-lg text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-600\",children:\"\\uD83D\\uDCDD\"}),/*#__PURE__*/_jsx(\"span\",{children:getBotonTexto('word','descarga')})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t border-gray-200\",children:!mostrarDrive?/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setMostrarDrive(true),className:\"w-full px-4 py-3 text-left hover:bg-yellow-50 flex items-center gap-2 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-600\",children:\"\\u2601\\uFE0F\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Google Drive\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-auto\",children:\"\\u25B6\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"p-2 bg-yellow-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mb-2 px-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setMostrarDrive(false),className:\"text-gray-500 hover:text-gray-700\",children:\"\\u25C0\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"text-sm font-bold text-gray-700\",children:\"\\u2601\\uFE0F Subir a Google Drive\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleExportar('excel','drive'),className:\"w-full px-4 py-3 text-left hover:bg-white flex items-center gap-2 rounded-lg border-b border-yellow-100 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600\",children:\"\\uD83D\\uDCCA\"}),/*#__PURE__*/_jsx(\"span\",{children:getBotonTexto('excel','drive')})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleExportar('pdf','drive'),className:\"w-full px-4 py-3 text-left hover:bg-white flex items-center gap-2 rounded-lg border-b border-yellow-100 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-red-600\",children:\"\\uD83D\\uDCC4\"}),/*#__PURE__*/_jsx(\"span\",{children:getBotonTexto('pdf','drive')})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleExportar('word','drive'),className:\"w-full px-4 py-3 text-left hover:bg-white flex items-center gap-2 rounded-lg text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-600\",children:\"\\uD83D\\uDCDD\"}),/*#__PURE__*/_jsx(\"span\",{children:getBotonTexto('word','drive')})]})]})})]})]});}// [El resto del código se mantiene igual hasta el final...]\nexport default function AsistenteProfesor(){const[usuario,setUsuario]=useState(null);const[mostrarLogin,setMostrarLogin]=useState(false);const[mostrarRegistro,setMostrarRegistro]=useState(false);const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[nombreUsuario,setNombreUsuario]=useState('');const[confirmarPassword,setConfirmarPassword]=useState('');const[errorAuth,setErrorAuth]=useState('');const[cargandoAuth,setCargandoAuth]=useState(false);const[view,setView]=useState('home');const[clases,setClases]=useState([]);const[claseSeleccionada,setClaseSeleccionada]=useState(null);const[nombreClase,setNombreClase]=useState('');const[grado,setGrado]=useState('');const[seccion,setSeccion]=useState('');const[nombreProfesorClase,setNombreProfesorClase]=useState('');const[institucionClase,setInstitucionClase]=useState('');const[estudiantes,setEstudiantes]=useState([]);const[nombreEstudiante,setNombreEstudiante]=useState('');const[expandido,setExpandido]=useState({});const[fechaActual,setFechaActual]=useState(new Date().toISOString().split('T')[0]);const[nombreProfesor,setNombreProfesor]=useState('');const[institucion,setInstitucion]=useState('');const[gradoPlan,setGradoPlan]=useState('');const[materia,setMateria]=useState('');const[trimestre,setTrimestre]=useState('Primer Trimestre');const[planGenerado,setPlanGenerado]=useState(null);const[generandoPlan,setGenerandoPlan]=useState(false);// Estado para búsqueda de estudiantes - MANTENIDO\nconst[busquedaEstudiante,setBusquedaEstudiante]=useState('');// Efecto para manejar el estado de autenticación\nuseEffect(()=>{const unsubscribe=onAuthStateChanged(auth,user=>{if(user){setUsuario({email:user.email,nombre:user.displayName||user.email.split('@')[0],uid:user.uid});cargarClases(user.uid);}else{setUsuario(null);setClases([]);}});return()=>unsubscribe();},[]);// Cargar clases desde Firestore\nconst cargarClases=async userId=>{try{const q=query(collection(db,'clases'),where('userId','==',userId));const querySnapshot=await getDocs(q);const clasesData=[];querySnapshot.forEach(doc=>{clasesData.push(_objectSpread({id:doc.id},doc.data()));});setClases(clasesData);}catch(error){console.error('Error cargando clases:',error);}};const registrarUsuario=async()=>{setErrorAuth('');if(!email||!password||!nombreUsuario){setErrorAuth('Por favor completa todos los campos');return;}if(password!==confirmarPassword){setErrorAuth('Las contraseñas no coinciden');return;}if(password.length<6){setErrorAuth('La contraseña debe tener al menos 6 caracteres');return;}setCargandoAuth(true);try{const userCredential=await createUserWithEmailAndPassword(auth,email,password);setUsuario({email:userCredential.user.email,nombre:nombreUsuario,uid:userCredential.user.uid});setMostrarRegistro(false);limpiarFormulariosAuth();}catch(error){if(error.code==='auth/email-already-in-use'){setErrorAuth('Este correo ya está registrado');}else if(error.code==='auth/weak-password'){setErrorAuth('La contraseña es muy débil');}else{setErrorAuth('Error al registrar: '+error.message);}}finally{setCargandoAuth(false);}};const iniciarSesion=async()=>{setErrorAuth('');if(!email||!password){setErrorAuth('Por favor ingresa email y contraseña');return;}setCargandoAuth(true);try{const userCredential=await signInWithEmailAndPassword(auth,email,password);setUsuario({email:userCredential.user.email,nombre:userCredential.user.displayName||userCredential.user.email.split('@')[0],uid:userCredential.user.uid});setMostrarLogin(false);limpiarFormulariosAuth();}catch(error){if(error.code==='auth/user-not-found'){setErrorAuth('Usuario no encontrado');}else if(error.code==='auth/wrong-password'){setErrorAuth('Contraseña incorrecta');}else{setErrorAuth('Error al iniciar sesión: '+error.message);}}finally{setCargandoAuth(false);}};const cerrarSesion=async()=>{try{await signOut(auth);setUsuario(null);setView('home');setClaseSeleccionada(null);setClases([]);}catch(error){console.error('Error al cerrar sesión:',error);}};const limpiarFormulariosAuth=()=>{setEmail('');setPassword('');setNombreUsuario('');setConfirmarPassword('');setErrorAuth('');};// FUNCIÓN MEJORADA: Generar plan trimestral\nconst generarPlanConOpenAI=async()=>{if(!nombreProfesor.trim()||!institucion.trim()||!gradoPlan.trim()||!materia.trim()||!trimestre.trim()){alert('Por favor completa todos los campos');return;}setGenerandoPlan(true);try{const BACKEND_URL='https://bringo-edu-backend-2.onrender.com/api/generate-plan';const response=await fetch(BACKEND_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({nombreProfesor,institucion,gradoPlan,materia,trimestre,incluirDesarrolloClases:true})});if(!response.ok){const errorData=await response.json().catch(()=>({error:'Error desconocido'}));throw new Error(errorData.error||\"Error \".concat(response.status,\" del servidor\"));}const data=await response.json();if(!data.contenidos||!Array.isArray(data.contenidos)||data.contenidos.length===0){alert('El servicio de IA no generó contenido. Intenta nuevamente.');return;}setPlanGenerado(_objectSpread(_objectSpread({},data),{},{fecha:data.fecha||new Date().toLocaleDateString('es-PA'),generadoPorIA:true}));}catch(error){console.error('❌ Error al generar plan:',error);alert(\"Error al generar el plan: \".concat(error.message));}finally{setGenerandoPlan(false);}};// FUNCIÓN MEJORADA: Descargar plan trimestral con múltiples formatos\nconst descargarPlan=function(){let formato=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'txt';if(!planGenerado)return;let contenido=\"PLAN TRIMESTRAL - BRINGO EDU\\n\";contenido+=\"\".concat('='.repeat(80),\"\\n\\n\");contenido+=\"INFORMACI\\xD3N GENERAL\\n\";contenido+=\"-\".repeat(80)+\"\\n\";contenido+=\"Profesor: \".concat(planGenerado.docente||planGenerado.profesor||nombreProfesor,\"\\n\");contenido+=\"Instituci\\xF3n: \".concat(planGenerado.institucion,\"\\n\");contenido+=\"Grado: \".concat(planGenerado.grado||gradoPlan,\"\\n\");contenido+=\"Asignatura: \".concat(planGenerado.asignatura||planGenerado.materia||materia,\"\\n\");contenido+=\"Trimestre: \".concat(planGenerado.trimestre,\"\\n\");contenido+=\"A\\xF1o Escolar: \".concat(planGenerado.anioEscolar||new Date().getFullYear(),\"\\n\");contenido+=\"Duraci\\xF3n: \".concat(planGenerado.duracionSemanas||'10-12',\" semanas\\n\");contenido+=\"Fecha de generaci\\xF3n: \".concat(planGenerado.fecha||new Date().toLocaleDateString('es-PA'),\"\\n\\n\");if(planGenerado.contenidos&&planGenerado.contenidos.length>0){contenido+=\"CONTENIDOS DEL TRIMESTRE\\n\";contenido+=\"-\".repeat(80)+\"\\n\";planGenerado.contenidos.forEach((cont,i)=>{contenido+=\"\".concat(i+1,\". \").concat(cont,\"\\n\");});contenido+=\"\\n\";}// Desarrollo del Contenido para Clases\nif(planGenerado.desarrolloClases&&Object.keys(planGenerado.desarrolloClases).length>0){contenido+=\"DESARROLLO DEL CONTENIDO PARA CLASES\\n\";contenido+=\"-\".repeat(80)+\"\\n\";Object.entries(planGenerado.desarrolloClases).forEach(_ref12=>{let[contenidoKey,desarrollo]=_ref12;contenido+=\"\\n\\uD83D\\uDCDD \".concat(contenidoKey,\":\\n\");contenido+=\"Duraci\\xF3n: \".concat(desarrollo.duracion||'3 sesiones de 45 minutos',\"\\n\\n\");if(desarrollo.objetivos&&desarrollo.objetivos.length>0){contenido+=\"Objetivos de Aprendizaje:\\n\";desarrollo.objetivos.forEach(objetivo=>{contenido+=\"- \".concat(objetivo,\"\\n\");});contenido+=\"\\n\";}if(desarrollo.materiales&&desarrollo.materiales.length>0){contenido+=\"Materiales necesarios:\\n\";desarrollo.materiales.forEach(material=>{contenido+=\"- \".concat(material,\"\\n\");});contenido+=\"\\n\";}if(desarrollo.fases&&desarrollo.fases.length>0){contenido+=\"Fases de la actividad:\\n\";desarrollo.fases.forEach((fase,index)=>{contenido+=\"\\nSESI\\xD3N \".concat(index+1,\" - \").concat(fase.titulo||'Desarrollo',\"\\n\");if(fase.actividades){fase.actividades.forEach(actividad=>{contenido+=\"\".concat(actividad.tiempo,\": \").concat(actividad.descripcion,\"\\n\");});}});contenido+=\"\\n\";}contenido+=\"-\".repeat(40)+\"\\n\";});}if(planGenerado.competencias&&planGenerado.competencias.length>0){contenido+=\"COMPETENCIAS A DESARROLLAR\\n\";contenido+=\"-\".repeat(80)+\"\\n\";planGenerado.competencias.forEach((comp,i)=>{contenido+=\"\".concat(i+1,\". \").concat(comp,\"\\n\");});contenido+=\"\\n\";}if(planGenerado.indicadoresLogro&&planGenerado.indicadoresLogro.length>0){contenido+=\"INDICADORES DE LOGRO\\n\";contenido+=\"-\".repeat(80)+\"\\n\";planGenerado.indicadoresLogro.forEach((ind,i)=>{contenido+=\"\\u2022 \".concat(ind,\"\\n\");});contenido+=\"\\n\";}if(planGenerado.metodologia){contenido+=\"ESTRATEGIAS METODOL\\xD3GICAS\\n\";contenido+=\"-\".repeat(80)+\"\\n\";contenido+=\"\".concat(planGenerado.metodologia,\"\\n\\n\");}if(planGenerado.recursos&&planGenerado.recursos.length>0){contenido+=\"RECURSOS EDUCATIVOS\\n\";contenido+=\"-\".repeat(80)+\"\\n\";planGenerado.recursos.forEach((rec,i)=>{contenido+=\"\\u2022 \".concat(rec,\"\\n\");});contenido+=\"\\n\";}if(planGenerado.evaluacion&&Array.isArray(planGenerado.evaluacion)&&planGenerado.evaluacion.length>0){contenido+=\"INSTRUMENTOS DE EVALUACI\\xD3N\\n\";contenido+=\"-\".repeat(80)+\"\\n\";planGenerado.evaluacion.forEach((evalItem,i)=>{contenido+=\"\\u2022 \".concat(evalItem,\"\\n\");});contenido+=\"\\n\";}if(planGenerado.adaptaciones&&planGenerado.adaptaciones.length>0){contenido+=\"ADAPTACIONES CURRICULARES\\n\";contenido+=\"-\".repeat(80)+\"\\n\";planGenerado.adaptaciones.forEach((adap,i)=>{contenido+=\"\\u2022 \".concat(adap,\"\\n\");});contenido+=\"\\n\";}if(planGenerado.observaciones){contenido+=\"OBSERVACIONES\\n\";contenido+=\"-\".repeat(80)+\"\\n\";contenido+=\"\".concat(planGenerado.observaciones,\"\\n\\n\");}contenido+=\"\\n\".concat('='.repeat(80),\"\\n\");contenido+=\"Generado con Bringo Edu - Asistente Inteligente para Profesores\\n\";contenido+=\"Fecha: \".concat(new Date().toLocaleDateString('es-PA'),\"\\n\");const elemento=document.createElement('a');const archivo=new Blob([contenido],{type:'text/plain;charset=utf-8'});elemento.href=URL.createObjectURL(archivo);elemento.download=\"Plan_Trimestral_\".concat(planGenerado.asignatura||materia,\"_\").concat(planGenerado.trimestre.replace(/\\s+/g,'_'),\".txt\");document.body.appendChild(elemento);elemento.click();document.body.removeChild(elemento);};// FUNCIÓN MEJORADA: Agregar clase con nuevos campos\nconst agregarClase=async()=>{if(!usuario){alert('Debes iniciar sesión para crear clases');setMostrarLogin(true);return;}if(!nombreClase.trim()||!grado.trim()||!seccion.trim()||!nombreProfesorClase.trim()||!institucionClase.trim()){alert('Por favor completa todos los campos');return;}try{const nuevaClase={nombre:\"\".concat(nombreClase,\" \").concat(grado).concat(seccion),grado,seccion,materia:nombreClase,profesor:nombreProfesorClase,institucion:institucionClase,estudiantes:[],userId:usuario.uid,fechaCreacion:new Date().toISOString()};const docRef=await addDoc(collection(db,'clases'),nuevaClase);setClases([...clases,_objectSpread({id:docRef.id},nuevaClase)]);setNombreClase('');setGrado('');setSeccion('');setNombreProfesorClase('');setInstitucionClase('');}catch(error){console.error('❌ Error agregando clase:',error);alert(\"Error al crear la clase: \".concat(error.message));}};const eliminarClase=async id=>{if(window.confirm('¿Estás seguro de eliminar esta clase?')){try{await deleteDoc(doc(db,'clases',id));setClases(clases.filter(c=>c.id!==id));if((claseSeleccionada===null||claseSeleccionada===void 0?void 0:claseSeleccionada.id)===id){setClaseSeleccionada(null);setView('home');}}catch(error){console.error('Error eliminando clase:',error);alert('Error al eliminar la clase');}}};const seleccionarClase=clase=>{if(!usuario){alert('Debes iniciar sesión para acceder a las clases');setMostrarLogin(true);return;}setClaseSeleccionada(clase);setEstudiantes(clase.estudiantes||[]);setView('clase');};// FUNCIÓN MEJORADA: Agregar estudiante\nconst agregarEstudiante=async()=>{if(!nombreEstudiante.trim()){alert('Ingresa el nombre del estudiante');return;}try{const nuevoEstudiante={id:Date.now().toString(),nombre:nombreEstudiante,notasDiarias:[],apreciacion:[],examen:[],asistencia:{}};const nuevosEstudiantes=[...estudiantes,nuevoEstudiante];setEstudiantes(nuevosEstudiantes);// Actualizar en Firestore\nawait updateDoc(doc(db,'clases',claseSeleccionada.id),{estudiantes:nuevosEstudiantes});// Actualizar estado local\nconst clasesActualizadas=clases.map(c=>c.id===claseSeleccionada.id?_objectSpread(_objectSpread({},c),{},{estudiantes:nuevosEstudiantes}):c);setClases(clasesActualizadas);setNombreEstudiante('');}catch(error){console.error('Error agregando estudiante:',error);alert('Error al agregar estudiante');}};const marcarAsistencia=async(estudianteId,fecha,estado)=>{try{const nuevosEstudiantes=estudiantes.map(e=>{if(e.id===estudianteId){return _objectSpread(_objectSpread({},e),{},{asistencia:_objectSpread(_objectSpread({},e.asistencia),{},{[fecha]:estado})});}return e;});setEstudiantes(nuevosEstudiantes);// Actualizar en Firestore\nawait updateDoc(doc(db,'clases',claseSeleccionada.id),{estudiantes:nuevosEstudiantes});// Actualizar estado local\nconst clasesActualizadas=clases.map(c=>c.id===claseSeleccionada.id?_objectSpread(_objectSpread({},c),{},{estudiantes:nuevosEstudiantes}):c);setClases(clasesActualizadas);}catch(error){console.error('Error marcando asistencia:',error);}};// FUNCIÓN CORREGIDA: Agregar nota - AHORA FUNCIONA CORRECTAMENTE\nconst agregarNota=async function(estudianteId,seccion){let valor=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';let fecha=arguments.length>3&&arguments[3]!==undefined?arguments[3]:new Date().toISOString().split('T')[0];try{const nuevosEstudiantes=estudiantes.map(e=>{if(e.id===estudianteId){const nuevaNota={valor:valor?parseFloat(valor):'',fecha:fecha};return _objectSpread(_objectSpread({},e),{},{[seccion]:[...e[seccion],nuevaNota]});}return e;});setEstudiantes(nuevosEstudiantes);// Actualizar en Firestore\nawait updateDoc(doc(db,'clases',claseSeleccionada.id),{estudiantes:nuevosEstudiantes});// Actualizar estado local\nconst clasesActualizadas=clases.map(c=>c.id===claseSeleccionada.id?_objectSpread(_objectSpread({},c),{},{estudiantes:nuevosEstudiantes}):c);setClases(clasesActualizadas);}catch(error){console.error('Error agregando nota:',error);alert('Error al agregar nota');}};const actualizarNota=async(estudianteId,seccion,indice,campo,valor)=>{try{const nuevosEstudiantes=estudiantes.map(e=>{if(e.id===estudianteId){const nuevasNotas=[...e[seccion]];nuevasNotas[indice]=_objectSpread(_objectSpread({},nuevasNotas[indice]),{},{[campo]:valor});return _objectSpread(_objectSpread({},e),{},{[seccion]:nuevasNotas});}return e;});setEstudiantes(nuevosEstudiantes);// Actualizar en Firestore\nawait updateDoc(doc(db,'clases',claseSeleccionada.id),{estudiantes:nuevosEstudiantes});// Actualizar estado local\nconst clasesActualizadas=clases.map(c=>c.id===claseSeleccionada.id?_objectSpread(_objectSpread({},c),{},{estudiantes:nuevosEstudiantes}):c);setClases(clasesActualizadas);}catch(error){console.error('Error actualizando nota:',error);}};const eliminarNota=async(estudianteId,seccion,indice)=>{try{const nuevosEstudiantes=estudiantes.map(e=>{if(e.id===estudianteId){const nuevasNotas=e[seccion].filter((_,i)=>i!==indice);return _objectSpread(_objectSpread({},e),{},{[seccion]:nuevasNotas});}return e;});setEstudiantes(nuevosEstudiantes);// Actualizar en Firestore\nawait updateDoc(doc(db,'clases',claseSeleccionada.id),{estudiantes:nuevosEstudiantes});// Actualizar estado local\nconst clasesActualizadas=clases.map(c=>c.id===claseSeleccionada.id?_objectSpread(_objectSpread({},c),{},{estudiantes:nuevosEstudiantes}):c);setClases(clasesActualizadas);}catch(error){console.error('Error eliminando nota:',error);}};const eliminarEstudiante=async id=>{try{const nuevosEstudiantes=estudiantes.filter(e=>e.id!==id);setEstudiantes(nuevosEstudiantes);// Actualizar en Firestore\nawait updateDoc(doc(db,'clases',claseSeleccionada.id),{estudiantes:nuevosEstudiantes});// Actualizar estado local\nconst clasesActualizadas=clases.map(c=>c.id===claseSeleccionada.id?_objectSpread(_objectSpread({},c),{},{estudiantes:nuevosEstudiantes}):c);setClases(clasesActualizadas);}catch(error){console.error('Error eliminando estudiante:',error);alert('Error al eliminar estudiante');}};const contarAsistencias=estudiante=>{const registros=estudiante.asistencia||{};const presente=Object.values(registros).filter(v=>v==='presente').length;const ausente=Object.values(registros).filter(v=>v==='ausente').length;const tardanza=Object.values(registros).filter(v=>v==='tardanza').length;return{presente,ausente,tardanza};};const calcularTotalSeccion=notas=>{if(!notas||notas.length===0)return 0;const numeros=notas.map(n=>{const valor=typeof n==='object'?parseFloat(n.valor):parseFloat(n);return isNaN(valor)?0:valor;}).filter(v=>v>0);if(numeros.length===0)return 0;return(numeros.reduce((a,b)=>a+b,0)/numeros.length).toFixed(2);};const calcularPromedioFinal=estudiante=>{const totalDiarias=parseFloat(calcularTotalSeccion(estudiante.notasDiarias));const totalApreciacion=parseFloat(calcularTotalSeccion(estudiante.apreciacion));const totalExamen=parseFloat(calcularTotalSeccion(estudiante.examen));const totales=[totalDiarias,totalApreciacion,totalExamen].filter(t=>t>0);if(totales.length===0)return 0;return((totalDiarias+totalApreciacion+totalExamen)/3).toFixed(2);};const toggleExpansion=estudianteId=>{setExpandido(prev=>_objectSpread(_objectSpread({},prev),{},{[estudianteId]:!prev[estudianteId]}));};// FUNCIÓN CORREGIDA: Buscar y redirigir estudiante - AHORA EN HOME\nconst buscarYRedirigirEstudiante=estudiante=>{// Si estamos en home, vamos a notas\nif(view==='home'){setView('notas');}// Expandir la sección del estudiante\nsetExpandido(prev=>_objectSpread(_objectSpread({},prev),{},{[estudiante.id]:true}));// Scroll a la sección del estudiante\nsetTimeout(()=>{const elemento=document.getElementById(\"estudiante-\".concat(estudiante.id));if(elemento){elemento.scrollIntoView({behavior:'smooth',block:'center'});// Resaltar temporalmente\nelemento.classList.add('bg-yellow-100');setTimeout(()=>{elemento.classList.remove('bg-yellow-100');},2000);}},500);setBusquedaEstudiante('');};const estudiantesEnRiesgo=estudiantes.filter(e=>parseFloat(calcularPromedioFinal(e))<3.0&&parseFloat(calcularPromedioFinal(e))>0);const promedioGeneral=()=>{const promedios=estudiantes.map(e=>parseFloat(calcularPromedioFinal(e))).filter(p=>p>0);if(promedios.length===0)return 0;return(promedios.reduce((a,b)=>a+b,0)/promedios.length).toFixed(1);};// FUNCIONES PARA LA VISTA DE PROGRESO\nconst obtenerRankingEstudiantes=()=>{return estudiantes.map(estudiante=>_objectSpread(_objectSpread({},estudiante),{},{promedio:parseFloat(calcularPromedioFinal(estudiante))})).filter(e=>e.promedio>0).sort((a,b)=>b.promedio-a.promedio).slice(0,5);// Top 5\n};// FUNCIÓN MEJORADA: Exportar datos de progreso\nconst exportarProgreso=formato=>{const datosProgreso={clase:claseSeleccionada===null||claseSeleccionada===void 0?void 0:claseSeleccionada.nombre,profesor:(claseSeleccionada===null||claseSeleccionada===void 0?void 0:claseSeleccionada.profesor)||nombreProfesorClase,institucion:(claseSeleccionada===null||claseSeleccionada===void 0?void 0:claseSeleccionada.institucion)||institucionClase,fecha:new Date().toLocaleDateString('es-PA'),promedioGeneral:promedioGeneral(),totalEstudiantes:estudiantes.length,estudiantesEnRiesgo:estudiantesEnRiesgo.length,ranking:obtenerRankingEstudiantes(),distribucion:calcularDistribucionNotas()};const nombreArchivo=\"Tablero_Progreso_\".concat(claseSeleccionada===null||claseSeleccionada===void 0?void 0:claseSeleccionada.nombre.replace(/\\s+/g,'_'));switch(formato){case'excel':exportarAExcel(JSON.stringify(datosProgreso),nombreArchivo);break;case'pdf':exportarAPDF(JSON.stringify(datosProgreso),nombreArchivo);break;case'word':exportarAWord(JSON.stringify(datosProgreso),nombreArchivo);break;case'drive':subirAGoogleDrive(JSON.stringify(datosProgreso),nombreArchivo);break;default:break;}};const calcularDistribucionNotas=()=>{const distribucion={excelente:0,// 4.5 - 5.0\nbueno:0,// 3.5 - 4.4\nregular:0,// 3.0 - 3.4\nriesgo:0// 0 - 2.9\n};estudiantes.forEach(estudiante=>{const promedio=parseFloat(calcularPromedioFinal(estudiante));if(promedio>=4.5)distribucion.excelente++;else if(promedio>=3.5)distribucion.bueno++;else if(promedio>=3.0)distribucion.regular++;else if(promedio>0)distribucion.riesgo++;});return distribucion;};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50\",children:[/*#__PURE__*/_jsx(ModalLogin,{mostrarLogin:mostrarLogin,setMostrarLogin:setMostrarLogin,email:email,setEmail:setEmail,password:password,setPassword:setPassword,errorAuth:errorAuth,cargandoAuth:cargandoAuth,iniciarSesion:iniciarSesion,limpiarFormulariosAuth:limpiarFormulariosAuth,setMostrarRegistro:setMostrarRegistro}),/*#__PURE__*/_jsx(ModalRegistro,{mostrarRegistro:mostrarRegistro,setMostrarRegistro:setMostrarRegistro,email:email,setEmail:setEmail,password:password,setPassword:setPassword,nombreUsuario:nombreUsuario,setNombreUsuario:setNombreUsuario,confirmarPassword:confirmarPassword,setConfirmarPassword:setConfirmarPassword,errorAuth:errorAuth,cargandoAuth:cargandoAuth,registrarUsuario:registrarUsuario,limpiarFormulariosAuth:limpiarFormulariosAuth,setMostrarLogin:setMostrarLogin}),/*#__PURE__*/_jsx(\"header\",{className:\"bg-gradient-to-r from-purple-600 to-blue-600 text-white shadow-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-4 flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-4xl\",children:\"\\uD83D\\uDCDA\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold\",children:\"Bringo Edu\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-purple-100\",children:\"Asistente Inteligente para Profesores\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center gap-4\",children:usuario?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-right mr-4 hidden md:block\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold text-sm\",children:[\"\\uD83D\\uDC4B Hola, \",usuario.nombre]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-purple-200\",children:usuario.email})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:cerrarSesion,className:\"flex items-center gap-2 bg-red-500 hover:bg-red-600 px-4 py-2 rounded-lg transition font-semibold\",children:[/*#__PURE__*/_jsx(LogOut,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline\",children:\"Salir\"})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setMostrarLogin(true),className:\"flex items-center gap-2 bg-white text-purple-600 hover:bg-purple-50 px-4 py-2 rounded-lg transition font-semibold\",children:[/*#__PURE__*/_jsx(LogIn,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline\",children:\"Iniciar Sesi\\xF3n\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setMostrarRegistro(true),className:\"flex items-center gap-2 bg-green-500 hover:bg-green-600 px-4 py-2 rounded-lg transition font-semibold\",children:[/*#__PURE__*/_jsx(User,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden sm:inline\",children:\"Registrarse\"})]})]})})]})}),/*#__PURE__*/_jsx(\"nav\",{className:\"bg-white shadow-md sticky top-0 z-40\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto px-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-1 overflow-x-auto py-2\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setView('home'),className:\"flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap \".concat(view==='home'?'bg-purple-600 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(Home,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm md:text-base\",children:\"Inicio\"})]}),usuario&&claseSeleccionada&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setView('clase'),className:\"flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap \".concat(view==='clase'?'bg-purple-600 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(Users,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm md:text-base\",children:\"Estudiantes\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setView('asistencia'),className:\"flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap \".concat(view==='asistencia'?'bg-purple-600 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm md:text-base\",children:\"Asistencia\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setView('notas'),className:\"flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap \".concat(view==='notas'?'bg-purple-600 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(ClipboardList,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm md:text-base\",children:\"Notas\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setView('porcentajes'),className:\"flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap \".concat(view==='porcentajes'?'bg-purple-600 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(PieChart,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm md:text-base\",children:\"Cuadro de %\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setView('progreso'),className:\"flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap \".concat(view==='progreso'?'bg-purple-600 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm md:text-base\",children:\"Progreso\"})]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setView('planificacion'),className:\"flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap \".concat(view==='planificacion'?'bg-purple-600 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:[/*#__PURE__*/_jsx(Sparkles,{className:\"w-5 h-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm md:text-base\",children:\"Plan IA\"})]})]})})}),/*#__PURE__*/_jsxs(\"main\",{className:\"container mx-auto px-4 py-8\",children:[view==='home'&&/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg p-6 md:p-8\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl md:text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-4xl\",children:\"\\uD83C\\uDFEB\"}),\"Mis Clases\"]}),usuario&&claseSeleccionada&&estudiantes.length>0&&/*#__PURE__*/_jsx(BarraBusquedaEstudiantes,{estudiantes:estudiantes,onBuscarEstudiante:buscarYRedirigirEstudiante,busquedaEstudiante:busquedaEstudiante,setBusquedaEstudiante:setBusquedaEstudiante}),!usuario&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-6 mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-4\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-6 h-6 text-yellow-600 flex-shrink-0 mt-1\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-yellow-900 mb-2\",children:\"Inicia sesi\\xF3n para acceder\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-yellow-800 mb-4\",children:\"Crea una cuenta o inicia sesi\\xF3n para gestionar tus clases, estudiantes y generar planes de estudio con IA.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 flex-wrap\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setMostrarLogin(true),className:\"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition font-semibold\",children:\"Iniciar Sesi\\xF3n\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setMostrarRegistro(true),className:\"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition font-semibold\",children:\"Registrarse\"})]})]})]})}),usuario&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-purple-100 to-blue-100 rounded-xl p-6 mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Crear Nueva Clase\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Materia (ej: Matem\\xE1ticas)\",value:nombreClase,onChange:e=>setNombreClase(e.target.value),className:\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Grado (ej: 5to)\",value:grado,onChange:e=>setGrado(e.target.value),className:\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Secci\\xF3n (ej: A)\",value:seccion,onChange:e=>setSeccion(e.target.value),className:\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Nombre del Profesor\",value:nombreProfesorClase,onChange:e=>setNombreProfesorClase(e.target.value),className:\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Instituci\\xF3n Educativa\",value:institucionClase,onChange:e=>setInstitucionClase(e.target.value),className:\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:agregarClase,className:\"bg-gradient-to-r from-purple-600 to-blue-600 text-white px-6 py-3 rounded-lg hover:from-purple-700 hover:to-blue-700 transition font-bold flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-5 h-5\"}),\"Crear Clase\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\",children:[clases.length===0&&usuario&&/*#__PURE__*/_jsxs(\"div\",{className:\"col-span-full text-center py-12 text-gray-500\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg\",children:\"No tienes clases creadas a\\xFAn\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mt-2\",children:\"Crea tu primera clase usando el formulario arriba\"})]}),clases.map(clase=>{var _clase$estudiantes;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-br from-purple-500 to-blue-600 rounded-xl shadow-lg p-6 text-white hover:shadow-2xl transition-all transform hover:scale-105 cursor-pointer\",onClick:()=>seleccionarClase(clase),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold mb-2\",children:clase.nombre}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-purple-100\",children:[((_clase$estudiantes=clase.estudiantes)===null||_clase$estudiantes===void 0?void 0:_clase$estudiantes.length)||0,\" estudiantes\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-purple-100 text-sm mt-1\",children:[\"Prof: \",clase.profesor]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-purple-100 text-sm\",children:[\"Inst: \",clase.institucion]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();eliminarClase(clase.id);},className:\"bg-red-500 hover:bg-red-600 p-2 rounded-lg transition\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-5 h-5\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 pt-4 border-t border-purple-400\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-purple-100\",children:\"Click para gestionar\"})})]},clase.id);})]})]})}),view==='clase'&&claseSeleccionada&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg p-6 md:p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Users,{className:\"w-8 h-8 text-purple-600\"}),claseSeleccionada.nombre]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setClaseSeleccionada(null);setView('home');},className:\"bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg transition font-semibold\",children:\"Volver\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-green-100 to-teal-100 rounded-xl p-6 mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Agregar Estudiante\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row gap-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Nombre completo del estudiante\",value:nombreEstudiante,onChange:e=>setNombreEstudiante(e.target.value),onKeyPress:e=>e.key==='Enter'&&agregarEstudiante(),className:\"flex-1 px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:agregarEstudiante,className:\"bg-gradient-to-r from-green-600 to-teal-600 text-white px-6 py-3 rounded-lg hover:from-green-700 hover:to-teal-700 transition font-bold flex items-center justify-center gap-2\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-5 h-5\"}),\"Agregar\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[estudiantes.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12 text-gray-500\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg\",children:\"No hay estudiantes en esta clase\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mt-2\",children:\"Agrega tu primer estudiante usando el formulario arriba\"})]}),estudiantes.map(estudiante=>/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-xl p-6 hover:bg-gray-100 transition\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-purple-600 text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg\",children:estudiante.nombre.charAt(0).toUpperCase()}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-bold text-gray-800\",children:estudiante.nombre}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"Promedio: \",calcularPromedioFinal(estudiante),\"/5\"]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(window.confirm(\"\\xBFEliminar a \".concat(estudiante.nombre,\"?\"))){eliminarEstudiante(estudiante.id);}},className:\"bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg transition mt-4 md:mt-0\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-5 h-5\"})})]})},estudiante.id))]})]}),view==='asistencia'&&claseSeleccionada&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg p-6 md:p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"w-8 h-8 text-purple-600\"}),\"Asistencia - \",claseSeleccionada.nombre]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:fechaActual,onChange:e=>setFechaActual(e.target.value),className:\"px-4 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsx(OpcionesExportacion,{datos:JSON.stringify({clase:claseSeleccionada.nombre,profesor:claseSeleccionada.profesor,institucion:claseSeleccionada.institucion,fecha:fechaActual,estudiantes:estudiantes.map(e=>{var _e$asistencia;return{nombre:e.nombre,asistencia:((_e$asistencia=e.asistencia)===null||_e$asistencia===void 0?void 0:_e$asistencia[fechaActual])||'No registrada',historial:contarAsistencias(e)};})}),nombreArchivo:\"Asistencia_\".concat(claseSeleccionada.nombre.replace(/\\s+/g,'_'),\"_\").concat(fechaActual)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[estudiantes.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12 text-gray-500\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-lg\",children:\"No hay estudiantes en esta clase\"})}),estudiantes.map(estudiante=>{var _estudiante$asistenci;const asist=contarAsistencias(estudiante);const estadoHoy=(_estudiante$asistenci=estudiante.asistencia)===null||_estudiante$asistenci===void 0?void 0:_estudiante$asistenci[fechaActual];return/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 rounded-xl p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-bold text-gray-800 mb-2\",children:estudiante.nombre}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-green-600 font-semibold\",children:[\"\\u2713 \",asist.presente,\"P\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-yellow-600 font-semibold\",children:[\"\\u23F0 \",asist.tardanza,\"T\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-red-600 font-semibold\",children:[\"\\u2717 \",asist.ausente,\"A\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 flex-wrap mt-4 md:mt-0\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>marcarAsistencia(estudiante.id,fechaActual,'presente'),className:\"px-4 md:px-6 py-3 rounded-lg font-semibold transition text-sm md:text-base \".concat(estadoHoy==='presente'?'bg-green-600 text-white':'bg-green-100 text-green-700 hover:bg-green-200'),children:\"Presente\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>marcarAsistencia(estudiante.id,fechaActual,'tardanza'),className:\"px-4 md:px-6 py-3 rounded-lg font-semibold transition text-sm md:text-base \".concat(estadoHoy==='tardanza'?'bg-yellow-600 text-white':'bg-yellow-100 text-yellow-700 hover:bg-yellow-200'),children:\"Tardanza\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>marcarAsistencia(estudiante.id,fechaActual,'ausente'),className:\"px-4 md:px-6 py-3 rounded-lg font-semibold transition text-sm md:text-base \".concat(estadoHoy==='ausente'?'bg-red-600 text-white':'bg-red-100 text-red-700 hover:bg-red-200'),children:\"Ausente\"})]})]})},estudiante.id);})]})]}),view==='notas'&&claseSeleccionada&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg p-6 md:p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-3\",children:[/*#__PURE__*/_jsx(ClipboardList,{className:\"w-8 h-8 text-purple-600\"}),\"Notas - \",claseSeleccionada.nombre]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-4 flex-wrap\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-purple-100 px-4 md:px-6 py-3 rounded-lg\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs md:text-sm text-purple-600 font-semibold\",children:\"Promedio:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2 text-xl md:text-2xl font-bold text-purple-800\",children:[promedioGeneral(),\"/5\"]})]}),(()=>{const funcionesForzadas=[exportarAExcel,exportarAPDF,exportarAWord,generarBlobPorFormato,subirAGoogleDrive,OpcionesExportacion];console.log('Funciones incluidas en build:',funcionesForzadas.length);return null;})(),/*#__PURE__*/_jsx(OpcionesExportacion,{datos:JSON.stringify({clase:claseSeleccionada.nombre,profesor:claseSeleccionada.profesor,institucion:claseSeleccionada.institucion,fecha:new Date().toLocaleDateString('es-PA'),promedioGeneral:promedioGeneral(),estudiantes:estudiantes.map(e=>({nombre:e.nombre,notasDiarias:e.notasDiarias,apreciacion:e.apreciacion,examen:e.examen,promedioFinal:calcularPromedioFinal(e)}))}),nombreArchivo:\"Notas_\".concat(claseSeleccionada.nombre.replace(/\\s+/g,'_'))})]})]}),estudiantesEnRiesgo.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 border-2 border-red-200 rounded-xl p-6 mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-4\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"w-6 h-6 text-red-600 flex-shrink-0 mt-1\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-bold text-red-900 mb-2\",children:[\"\\u26A0\\uFE0F Estudiantes en Riesgo (\",estudiantesEnRiesgo.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:estudiantesEnRiesgo.map(e=>/*#__PURE__*/_jsxs(\"span\",{className:\"bg-red-200 text-red-800 px-3 py-1 rounded-lg text-sm font-semibold\",children:[e.nombre,\": \",calcularPromedioFinal(e),\"/5\"]},e.id))})]})]})}),estudiantes.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-xl shadow-lg p-6 mb-6 border-2 border-purple-200\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2\",children:[\"\\uD83D\\uDCCA Registro R\\xE1pido de Notas - \",new Date().toLocaleDateString('es-PA')]}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full min-w-full\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-purple-600 text-white\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left font-semibold\",children:\"Estudiante\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-center font-semibold\",children:\"Notas Diarias\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-center font-semibold\",children:\"Apreciaci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-center font-semibold\",children:\"Examen\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-center font-semibold\",children:\"Promedio\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-center font-semibold\",children:\"Compartir\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:estudiantes.map(estudiante=>/*#__PURE__*/_jsx(FilaNotasRapidas,{estudiante:estudiante,onAgregarNota:agregarNota,calcularPromedioFinal:calcularPromedioFinal,claseSeleccionada:claseSeleccionada,usuario:usuario,actualizarNota:actualizarNota},estudiante.id))})]})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-3 text-center\",children:\"\\uD83D\\uDCA1 Ingresa las notas (0-5) y presiona \\\"+\\\" para agregar. Las notas se guardan autom\\xE1ticamente.\"})]}),estudiantes.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-12 text-gray-500\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-lg\",children:\"No hay estudiantes en esta clase\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:estudiantes.map(estudiante=>/*#__PURE__*/_jsxs(\"div\",{id:\"estudiante-\".concat(estudiante.id),className:\"border-2 border-gray-200 rounded-xl overflow-hidden transition-all duration-300\",children:[/*#__PURE__*/_jsx(\"div\",{onClick:()=>toggleExpansion(estudiante.id),className:\"bg-gradient-to-r from-purple-100 to-blue-100 p-6 cursor-pointer hover:from-purple-200 hover:to-blue-200 transition\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-purple-600 text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg flex-shrink-0\",children:estudiante.nombre.charAt(0).toUpperCase()}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-bold text-gray-800\",children:estudiante.nombre}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 md:gap-4 mt-1 text-xs md:text-sm\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Diarias: \",calcularTotalSeccion(estudiante.notasDiarias)]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Apreciaci\\xF3n: \",calcularTotalSeccion(estudiante.apreciacion)]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Examen: \",calcularTotalSeccion(estudiante.examen)]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-4 mt-4 md:mt-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-right\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs md:text-sm text-gray-600\",children:\"Promedio\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-2xl md:text-3xl font-bold \".concat(parseFloat(calcularPromedioFinal(estudiante))>=3.5?'text-green-600':parseFloat(calcularPromedioFinal(estudiante))>=3.0?'text-yellow-600':'text-red-600'),children:[calcularPromedioFinal(estudiante),\"/5\"]})]}),expandido[estudiante.id]?/*#__PURE__*/_jsx(ChevronUp,{className:\"w-6 h-6 text-gray-600\"}):/*#__PURE__*/_jsx(ChevronDown,{className:\"w-6 h-6 text-gray-600\"})]})]})}),expandido[estudiante.id]&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"font-bold text-lg text-gray-800\",children:\"\\uD83D\\uDCDD Notas Diarias\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>agregarNota(estudiante.id,'notasDiarias'),className:\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition text-sm font-semibold flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"}),\"Agregar\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:estudiante.notasDiarias.map((nota,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg flex gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.1\",min:\"0\",max:\"5\",placeholder:\"Nota\",value:nota.valor||'',onChange:e=>actualizarNota(estudiante.id,'notasDiarias',idx,'valor',e.target.value),className:\"flex-1 px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:nota.fecha||'',onChange:e=>actualizarNota(estudiante.id,'notasDiarias',idx,'fecha',e.target.value),className:\"px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>eliminarNota(estudiante.id,'notasDiarias',idx),className:\"bg-red-500 text-white p-2 rounded-lg hover:bg-red-600 transition\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]},idx))}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 text-right\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Promedio: \"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-lg text-blue-600\",children:[calcularTotalSeccion(estudiante.notasDiarias),\"/5\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"font-bold text-lg text-gray-800\",children:\"\\u2B50 Apreciaci\\xF3n\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>agregarNota(estudiante.id,'apreciacion'),className:\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition text-sm font-semibold flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"}),\"Agregar\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:estudiante.apreciacion.map((nota,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg flex gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.1\",min:\"0\",max:\"5\",placeholder:\"Nota\",value:nota.valor||'',onChange:e=>actualizarNota(estudiante.id,'apreciacion',idx,'valor',e.target.value),className:\"flex-1 px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:nota.fecha||'',onChange:e=>actualizarNota(estudiante.id,'apreciacion',idx,'fecha',e.target.value),className:\"px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>eliminarNota(estudiante.id,'apreciacion',idx),className:\"bg-red-500 text-white p-2 rounded-lg hover:bg-red-600 transition\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]},idx))}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 text-right\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Promedio: \"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-lg text-green-600\",children:[calcularTotalSeccion(estudiante.apreciacion),\"/5\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"font-bold text-lg text-gray-800\",children:\"\\uD83D\\uDCCB Examen\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>agregarNota(estudiante.id,'examen'),className:\"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition text-sm font-semibold flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"}),\"Agregar\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:estudiante.examen.map((nota,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 p-4 rounded-lg flex gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",step:\"0.1\",min:\"0\",max:\"5\",placeholder:\"Nota\",value:nota.valor||'',onChange:e=>actualizarNota(estudiante.id,'examen',idx,'valor',e.target.value),className:\"flex-1 px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:nota.fecha||'',onChange:e=>actualizarNota(estudiante.id,'examen',idx,'fecha',e.target.value),className:\"px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>eliminarNota(estudiante.id,'examen',idx),className:\"bg-red-500 text-white p-2 rounded-lg hover:bg-red-600 transition\",children:/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4\"})})]},idx))}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 text-right\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Promedio: \"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-lg text-purple-600\",children:[calcularTotalSeccion(estudiante.examen),\"/5\"]})]})]})]})]},estudiante.id))})]}),view==='porcentajes'&&claseSeleccionada&&/*#__PURE__*/_jsx(CuadroPorcentajes,{}),view==='progreso'&&claseSeleccionada&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg p-6 md:p-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-3\",children:[/*#__PURE__*/_jsx(TrendingUp,{className:\"w-8 h-8 text-purple-600\"}),\"Tablero de Progreso - \",claseSeleccionada.nombre]}),/*#__PURE__*/_jsx(OpcionesExportacion,{datos:JSON.stringify({clase:claseSeleccionada.nombre,profesor:claseSeleccionada.profesor,institucion:claseSeleccionada.institucion,fecha:new Date().toLocaleDateString('es-PA'),promedioGeneral:promedioGeneral(),totalEstudiantes:estudiantes.length,estudiantesEnRiesgo:estudiantesEnRiesgo.length,ranking:obtenerRankingEstudiantes(),distribucion:calcularDistribucionNotas()}),nombreArchivo:\"Tablero_Progreso_\".concat(claseSeleccionada.nombre.replace(/\\s+/g,'_')),onExportar:exportarProgreso})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl p-6 text-center\",children:[/*#__PURE__*/_jsx(BarChart3,{className:\"w-8 h-8 mx-auto mb-2\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm opacity-90\",children:\"Promedio General\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold\",children:[promedioGeneral(),\"/5\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl p-6 text-center\",children:[/*#__PURE__*/_jsx(Target,{className:\"w-8 h-8 mx-auto mb-2\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm opacity-90\",children:\"Total Estudiantes\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold\",children:estudiantes.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-yellow-500 to-yellow-600 text-white rounded-xl p-6 text-center\",children:[/*#__PURE__*/_jsx(AlertTriangle,{className:\"w-8 h-8 mx-auto mb-2\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm opacity-90\",children:\"En Riesgo\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-3xl font-bold\",children:estudiantesEnRiesgo.length})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl p-6 text-center\",children:[/*#__PURE__*/_jsx(Award,{className:\"w-8 h-8 mx-auto mb-2\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm opacity-90\",children:\"Mejor Promedio\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-3xl font-bold\",children:[estudiantes.length>0?Math.max(...estudiantes.map(e=>parseFloat(calcularPromedioFinal(e)))).toFixed(1):0,\"/5\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-xl p-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(BarChart3,{className:\"w-6 h-6 text-purple-600\"}),\"Distribuci\\xF3n de Rendimiento\"]}),/*#__PURE__*/_jsx(DistribucionNotas,{estudiantes:estudiantes,calcularPromedioFinal:calcularPromedioFinal})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-xl p-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Award,{className:\"w-6 h-6 text-purple-600\"}),\"Ranking de Estudiantes\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[obtenerRankingEstudiantes().map((estudiante,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between bg-white p-4 rounded-lg border-2 border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 rounded-full flex items-center justify-center font-bold text-white \".concat(index===0?'bg-yellow-500':index===1?'bg-gray-400':index===2?'bg-orange-500':'bg-purple-500'),children:index+1}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold text-gray-800\",children:estudiante.nombre}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[estudiante.notasDiarias.length+estudiante.apreciacion.length+estudiante.examen.length,\" notas\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-right\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-xl font-bold \".concat(estudiante.promedio>=4.5?'text-green-600':estudiante.promedio>=3.5?'text-blue-600':estudiante.promedio>=3.0?'text-yellow-600':'text-red-600'),children:[estudiante.promedio.toFixed(1),\"/5\"]})})]},estudiante.id)),obtenerRankingEstudiantes().length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8 text-gray-500\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No hay datos suficientes para ranking\"})})]})]})]}),estudiantesEnRiesgo.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 border-2 border-red-200 rounded-xl p-6 mb-8\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-bold text-red-900 mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(AlertTriangle,{className:\"w-6 h-6 text-red-600\"}),\"Alertas de Bajo Rendimiento (\",estudiantesEnRiesgo.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\",children:estudiantesEnRiesgo.map(estudiante=>{const asistencia=contarAsistencias(estudiante);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-4 border-2 border-red-300\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-600 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold\",children:estudiante.nombre.charAt(0).toUpperCase()}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-bold text-red-800\",children:estudiante.nombre}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-red-600\",children:[\"Promedio: \",calcularPromedioFinal(estudiante),\"/5\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-600\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Asistencia: \",asistencia.presente,\"P \",asistencia.tardanza,\"T \",asistencia.ausente,\"A\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Total notas: \",estudiante.notasDiarias.length+estudiante.apreciacion.length+estudiante.examen.length]})]})]},estudiante.id);})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-xl p-6\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2\",children:[/*#__PURE__*/_jsx(Users,{className:\"w-6 h-6 text-purple-600\"}),\"M\\xE9tricas por Estudiante\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full bg-white rounded-lg overflow-hidden\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"bg-purple-600 text-white\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-left\",children:\"Estudiante\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-center\",children:\"Promedio\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-center\",children:\"Notas Diarias\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-center\",children:\"Apreciaci\\xF3n\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-center\",children:\"Examen\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-4 py-3 text-center\",children:\"Asistencia\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:estudiantes.map(estudiante=>{const asistencia=contarAsistencias(estudiante);const totalAsistencias=asistencia.presente+asistencia.tardanza+asistencia.ausente;const porcentajeAsistencia=totalAsistencias>0?Math.round(asistencia.presente/totalAsistencias*100):0;return/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b border-gray-200 hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 font-semibold\",children:estudiante.nombre}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-center\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold \".concat(parseFloat(calcularPromedioFinal(estudiante))>=4.5?'text-green-600':parseFloat(calcularPromedioFinal(estudiante))>=3.5?'text-blue-600':parseFloat(calcularPromedioFinal(estudiante))>=3.0?'text-yellow-600':'text-red-600'),children:[calcularPromedioFinal(estudiante),\"/5\"]})}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-3 text-center text-sm\",children:[calcularTotalSeccion(estudiante.notasDiarias),\" (\",estudiante.notasDiarias.length,\")\"]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-3 text-center text-sm\",children:[calcularTotalSeccion(estudiante.apreciacion),\" (\",estudiante.apreciacion.length,\")\"]}),/*#__PURE__*/_jsxs(\"td\",{className:\"px-4 py-3 text-center text-sm\",children:[calcularTotalSeccion(estudiante.examen),\" (\",estudiante.examen.length,\")\"]}),/*#__PURE__*/_jsx(\"td\",{className:\"px-4 py-3 text-center\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"font-semibold \".concat(porcentajeAsistencia>=90?'text-green-600':porcentajeAsistencia>=80?'text-yellow-600':'text-red-600'),children:[porcentajeAsistencia,\"%\"]})})]},estudiante.id);})})]})}),estudiantes.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8 text-gray-500\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No hay estudiantes en esta clase\"})})]})]}),view==='planificacion'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-2xl shadow-lg p-6 md:p-8\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-2xl md:text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3\",children:[/*#__PURE__*/_jsx(Sparkles,{className:\"w-8 h-8 text-purple-600\"}),\"Generador de Planes Trimestrales con IA\"]}),!planGenerado?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start gap-4\",children:[/*#__PURE__*/_jsx(Sparkles,{className:\"w-8 h-8 text-purple-600 flex-shrink-0 mt-1\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-bold text-purple-900 text-lg mb-2\",children:\"\\u2728 Planes Trimestrales con IA\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-purple-800 text-sm\",children:\"Genera planes trimestrales completos alineados con el curr\\xEDculo del MEDUCA de Panam\\xE1. Nuestra IA crea contenido detallado con contenidos, competencias, metodolog\\xEDas y evaluaciones espec\\xEDficas para cada trimestre.\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Informaci\\xF3n del Plan Trimestral\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Nombre del Profesor\",value:nombreProfesor,onChange:e=>setNombreProfesor(e.target.value),className:\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Instituci\\xF3n Educativa\",value:institucion,onChange:e=>setInstitucion(e.target.value),className:\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Grado (ej: 5to)\",value:gradoPlan,onChange:e=>setGradoPlan(e.target.value),className:\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Materia (ej: Matem\\xE1ticas)\",value:materia,onChange:e=>setMateria(e.target.value),className:\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"}),/*#__PURE__*/_jsxs(\"select\",{value:trimestre,onChange:e=>setTrimestre(e.target.value),className:\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Primer Trimestre\",children:\"Primer Trimestre\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Segundo Trimestre\",children:\"Segundo Trimestre\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Tercer Trimestre\",children:\"Tercer Trimestre\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"md:col-span-2\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mb-2\",children:\"\\uD83D\\uDCA1 Selecciona el trimestre para el cual deseas generar el plan de estudios completo.\"})})]}),/*#__PURE__*/_jsx(\"button\",{onClick:generarPlanConOpenAI,disabled:generandoPlan||!nombreProfesor||!institucion||!gradoPlan||!materia||!trimestre,className:\"w-full mt-6 py-4 rounded-lg font-bold text-lg flex items-center justify-center gap-3 transition \".concat(generandoPlan||!nombreProfesor||!institucion||!gradoPlan||!materia||!trimestre?'bg-gray-400 cursor-not-allowed':'bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white shadow-lg hover:shadow-xl'),children:generandoPlan?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-6 w-6 border-b-2 border-white\"}),\"Generando Plan Trimestral...\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Sparkles,{className:\"w-6 h-6\"}),\"Generar Plan Trimestral con IA\"]})})]})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col md:flex-row justify-between items-start gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-2xl font-bold text-gray-800\",children:[\"Plan \",planGenerado.trimestre]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mt-1\",children:[planGenerado.asignatura||planGenerado.materia||materia,\" - \",planGenerado.grado||gradoPlan,\" | \",planGenerado.institucion||institucion]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mt-1\",children:[\"Profesor: \",planGenerado.docente||planGenerado.profesor||nombreProfesor]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"Trimestre: \",planGenerado.trimestre,\" | Fecha: \",planGenerado.fecha]}),planGenerado.duracionSemanas&&/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"Duraci\\xF3n: \",planGenerado.duracionSemanas,\" semanas\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3 flex-wrap\",children:[/*#__PURE__*/_jsx(OpcionesExportacion,{datos:JSON.stringify(planGenerado),nombreArchivo:\"Plan_Trimestral_\".concat(planGenerado.asignatura||materia,\"_\").concat(planGenerado.trimestre.replace(/\\s+/g,'_'))}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setPlanGenerado(null),className:\"bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition font-bold\",children:\"Nuevo Plan\"})]})]}),planGenerado.contenidos&&Array.isArray(planGenerado.contenidos)&&planGenerado.contenidos.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 rounded-xl p-6\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-xl font-bold text-blue-900 mb-4 flex items-center gap-2\",children:[\"\\uD83D\\uDCDA Contenidos del \",planGenerado.trimestre]}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-2\",children:planGenerado.contenidos.map((cont,i)=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-600 font-bold\",children:[i+1,\".\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-800\",children:cont})]},i))})]}),planGenerado.desarrolloClases&&Object.keys(planGenerado.desarrolloClases).length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl p-6 border-2 border-teal-200\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-bold text-teal-900 mb-4 flex items-center gap-2\",children:\"\\uD83C\\uDFAF Desarrollo del Contenido para Clases\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:Object.entries(planGenerado.desarrolloClases).map(_ref13=>{let[contenidoKey,desarrollo]=_ref13;return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg p-4 border border-teal-100\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"font-bold text-lg text-teal-800 mb-3\",children:[\"\\uD83D\\uDCDD \",contenidoKey]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-700\",children:\"Duraci\\xF3n:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-teal-600\",children:desarrollo.duracion||'3 sesiones de 45 minutos'})]})}),desarrollo.objetivos&&desarrollo.objetivos.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"font-semibold text-gray-700 mb-2\",children:\"Objetivos de Aprendizaje:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-1\",children:desarrollo.objetivos.map((objetivo,idx)=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-teal-500\",children:\"\\u2022\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-700\",children:objetivo})]},idx))})]}),desarrollo.materiales&&desarrollo.materiales.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"h6\",{className:\"font-semibold text-gray-700 mb-2\",children:\"Materiales necesarios:\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-1\",children:desarrollo.materiales.map((material,idx)=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex gap-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-teal-500\",children:\"\\u2022\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-700\",children:material})]},idx))})]}),desarrollo.fases&&desarrollo.fases.length>0&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h6\",{className:\"font-semibold text-gray-700 mb-2\",children:\"Fases de la actividad:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:desarrollo.fases.map((fase,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-lg p-3\",children:[/*#__PURE__*/_jsxs(\"h7\",{className:\"font-semibold text-gray-800 mb-2\",children:[\"SESI\\xD3N \",index+1,\" - \",fase.titulo||'Desarrollo']}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:fase.actividades&&fase.actividades.map((actividad,actIdx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 text-sm\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium text-teal-600 whitespace-nowrap\",children:[actividad.tiempo,\":\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-700\",children:actividad.descripcion})]},actIdx))})]},index))})]})]},contenidoKey);})})]}),planGenerado.competencias&&Array.isArray(planGenerado.competencias)&&planGenerado.competencias.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-purple-50 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-bold text-purple-900 mb-4 flex items-center gap-2\",children:\"\\uD83D\\uDCAA Competencias a Desarrollar\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-2\",children:planGenerado.competencias.map((comp,i)=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-purple-600\",children:[i+1,\".\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-800\",children:comp})]},i))})]}),planGenerado.indicadoresLogro&&Array.isArray(planGenerado.indicadoresLogro)&&planGenerado.indicadoresLogro.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-teal-50 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-bold text-teal-900 mb-4 flex items-center gap-2\",children:\"\\u2705 Indicadores de Logro\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-2\",children:planGenerado.indicadoresLogro.map((ind,i)=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-teal-600\",children:\"\\u2022\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-800\",children:ind})]},i))})]}),planGenerado.metodologia&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-50 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-bold text-green-900 mb-4 flex items-center gap-2\",children:\"\\uD83D\\uDCD6 Estrategias Metodol\\xF3gicas\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-800\",children:planGenerado.metodologia})]}),planGenerado.recursos&&Array.isArray(planGenerado.recursos)&&planGenerado.recursos.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-indigo-50 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-bold text-indigo-900 mb-4 flex items-center gap-2\",children:\"\\uD83D\\uDEE0\\uFE0F Recursos Educativos\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"grid grid-cols-1 md:grid-cols-2 gap-2\",children:planGenerado.recursos.forEach((rec,i)=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex gap-2 items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-indigo-600\",children:\"\\u2022\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-800\",children:rec})]},i))})]}),planGenerado.evaluacion&&Array.isArray(planGenerado.evaluacion)&&planGenerado.evaluacion.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-red-50 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-bold text-red-900 mb-4 flex items-center gap-2\",children:\"\\uD83D\\uDCCA Instrumentos de Evaluaci\\xF3n\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-2\",children:planGenerado.evaluacion.map((evalItem,i)=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-red-600\",children:\"\\u2022\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-800\",children:evalItem})]},i))})]}),planGenerado.adaptaciones&&Array.isArray(planGenerado.adaptaciones)&&planGenerado.adaptaciones.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-orange-50 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-bold text-orange-900 mb-4 flex items-center gap-2\",children:\"\\u267F Adaptaciones Curriculares\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-2\",children:planGenerado.adaptaciones.map((adap,i)=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex gap-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-orange-600\",children:\"\\u2022\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-800\",children:adap})]},i))})]}),planGenerado.observaciones&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-100 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2\",children:\"\\uD83D\\uDCDD Observaciones\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-800\",children:planGenerado.observaciones})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl p-6 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-purple-800 font-semibold\",children:\"\\u2705 Plan trimestral generado exitosamente con IA\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-purple-600 mt-1\",children:\"Puedes descargar este plan en formato de texto para guardarlo o imprimirlo.\"})]})]})]})]}),/*#__PURE__*/_jsx(\"footer\",{className:\"bg-gray-800 text-white py-6 mt-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"\\xA9 2025 Bringo Edu - Asistente Inteligente para Profesores\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-gray-400 mt-2\",children:\"Desarrollado por GermanApp | Potenciado por IA\"})]})})]});window._forceExportFunctions={exportarAExcel,exportarAPDF,exportarAWord,generarBlobPorFormato,subirAGoogleDrive,OpcionesExportacion};}","map":{"version":3,"names":["React","useState","useEffect","Plus","Trash2","Download","AlertCircle","Users","Home","ChevronDown","ChevronUp","ClipboardList","Calendar","Sparkles","User","LogOut","LogIn","TrendingUp","BarChart3","Target","Award","AlertTriangle","Search","Share","Eye","EyeOff","PieChart","initializeApp","getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","onAuthStateChanged","getFirestore","collection","addDoc","getDocs","updateDoc","deleteDoc","doc","query","where","XLSX","jsPDF","Document","Packer","Paragraph","TextRun","Table","TableCell","TableRow","HeadingLevel","AlignmentType","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","app","auth","db","DistribucionNotas","_ref","estudiantes","calcularPromedioFinal","calcularDistribucion","distribucion","excelente","bueno","regular","riesgo","forEach","estudiante","promedio","parseFloat","total","length","className","children","Math","round","style","width","concat","FilaNotasRapidas","_ref2","onAgregarNota","claseSeleccionada","usuario","actualizarNota","notaDiaria","setNotaDiaria","notaApreciacion","setNotaApreciacion","notaExamen","setNotaExamen","fecha","setFecha","Date","toISOString","split","handleAgregarNota","tipo","valor","id","error","console","alert","compartirPorWhatsApp","formatoNotas","notas","filter","n","map","join","mensaje","nombre","institucion","toLocaleDateString","notasDiarias","apreciacion","examen","url","encodeURIComponent","window","open","charAt","toUpperCase","type","step","min","max","placeholder","value","onChange","e","target","onClick","ModalLogin","_ref3","mostrarLogin","setMostrarLogin","email","setEmail","password","setPassword","errorAuth","cargandoAuth","iniciarSesion","limpiarFormulariosAuth","setMostrarRegistro","mostrarPassword","setMostrarPassword","handleSubmit","preventDefault","onSubmit","required","disabled","ModalRegistro","_ref4","mostrarRegistro","nombreUsuario","setNombreUsuario","confirmarPassword","setConfirmarPassword","registrarUsuario","mostrarConfirmarPassword","setMostrarConfirmarPassword","minLength","BarraBusquedaEstudiantes","_ref5","onBuscarEstudiante","busquedaEstudiante","setBusquedaEstudiante","sugerencias","setSugerencias","mostrarSugerencias","setMostrarSugerencias","normalizarTexto","texto","toLowerCase","normalize","replace","textoBusqueda","sugerenciasFiltradas","includes","buscarYRedirigirEstudiante","trim","estudianteEncontrado","find","seleccionarSugerencia","onKeyPress","key","CuadroPorcentajes","normalizarDatos","datosIn","JSON","parse","_unused","objetoATabla","obj","Object","entries","_ref6","Campo","Valor","stringify","String","descargarBlob","blob","nombreArchivo","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","exportarAExcel","datos","workbook","utils","book_new","worksheet","Array","isArray","json_to_sheet","book_append_sheet","writeFile","log","exportarAPDF","setFontSize","setTextColor","text","yPosition","agregarTabla","titulo","datosTabla","addPage","headers","keys","fila","header","undefined","autoTable","startY","head","styles","fontSize","cellPadding","overflow","headStyles","fillColor","textColor","fontStyle","margin","left","right","tableWidth","lastAutoTable","finalY","datosArray","_ref7","clave","_ref8","arraySimple","v","i","save","message","exportarAWord","push","bold","size","alignment","CENTER","spacing","after","italics","tableRows","shading","fill","row","_row$key","rows","_ref9","sections","properties","toBlob","generarBlobPDF","Promise","resolve","reject","_ref0","_ref1","output","ext","mime","generarBlobPorFormato","formato","arrayBuffer","write","bookType","Blob","k","_row$k","_ref10","docx","Error","subirAGoogleDrive","nombreArchivoBase","arguments","formData","FormData","append","currentUser","token","getIdToken","tokenError","warn","DRIVE_UPLOAD_URL","controller","AbortController","timeoutId","setTimeout","abort","response","fetch","method","signal","clearTimeout","status","ok","errorText","result","json","mensajeUsuario","name","OpcionesExportacion","_ref11","onExportar","mostrarOpciones","setMostrarOpciones","mostrarDrive","setMostrarDrive","exportando","setExportando","handleExportar","destino","operacion","getBotonTexto","formatos","excel","pdf","word","destinos","descarga","drive","AsistenteProfesor","setUsuario","setErrorAuth","setCargandoAuth","view","setView","clases","setClases","setClaseSeleccionada","nombreClase","setNombreClase","grado","setGrado","seccion","setSeccion","nombreProfesorClase","setNombreProfesorClase","institucionClase","setInstitucionClase","setEstudiantes","nombreEstudiante","setNombreEstudiante","expandido","setExpandido","fechaActual","setFechaActual","nombreProfesor","setNombreProfesor","setInstitucion","gradoPlan","setGradoPlan","materia","setMateria","trimestre","setTrimestre","planGenerado","setPlanGenerado","generandoPlan","setGenerandoPlan","unsubscribe","user","displayName","uid","cargarClases","userId","q","querySnapshot","clasesData","_objectSpread","data","userCredential","code","cerrarSesion","generarPlanConOpenAI","BACKEND_URL","incluirDesarrolloClases","errorData","catch","contenidos","generadoPorIA","descargarPlan","contenido","repeat","docente","profesor","asignatura","anioEscolar","getFullYear","duracionSemanas","cont","desarrolloClases","_ref12","contenidoKey","desarrollo","duracion","objetivos","objetivo","materiales","material","fases","fase","index","actividades","actividad","tiempo","descripcion","competencias","comp","indicadoresLogro","ind","metodologia","recursos","rec","evaluacion","evalItem","adaptaciones","adap","observaciones","elemento","archivo","agregarClase","nuevaClase","fechaCreacion","docRef","eliminarClase","confirm","c","seleccionarClase","clase","agregarEstudiante","nuevoEstudiante","now","toString","asistencia","nuevosEstudiantes","clasesActualizadas","marcarAsistencia","estudianteId","estado","agregarNota","nuevaNota","indice","campo","nuevasNotas","eliminarNota","_","eliminarEstudiante","contarAsistencias","registros","presente","values","ausente","tardanza","calcularTotalSeccion","numeros","isNaN","reduce","a","b","toFixed","totalDiarias","totalApreciacion","totalExamen","totales","t","toggleExpansion","prev","getElementById","scrollIntoView","behavior","block","classList","add","remove","estudiantesEnRiesgo","promedioGeneral","promedios","p","obtenerRankingEstudiantes","sort","slice","exportarProgreso","datosProgreso","totalEstudiantes","ranking","calcularDistribucionNotas","_clase$estudiantes","stopPropagation","_e$asistencia","historial","_estudiante$asistenci","asist","estadoHoy","funcionesForzadas","promedioFinal","nota","idx","totalAsistencias","porcentajeAsistencia","_ref13","actIdx","_forceExportFunctions"],"sources":["C:/bringo-edu/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Plus, Trash2, Download, AlertCircle, Users, Home, ChevronDown, ChevronUp, ClipboardList, Calendar, Sparkles, User, LogOut, LogIn, TrendingUp, BarChart3, Target, Award, AlertTriangle, Search, Share, Eye, EyeOff, PieChart } from 'lucide-react';\r\nimport { initializeApp } from 'firebase/app';\r\nimport { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'firebase/auth';\r\nimport { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc, query, where } from 'firebase/firestore';\r\n\r\n// Importar librerías REALES de exportación\r\nimport * as XLSX from 'xlsx';\r\nimport jsPDF from 'jspdf';\r\nimport 'jspdf-autotable';\r\nimport { Document, Packer, Paragraph, TextRun, Table, TableCell, TableRow, HeadingLevel, AlignmentType } from 'docx';\r\n\r\n// Configuración de Firebase\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyCdRpj7y3L4PIwWiJgzYRHDU3XxcIVfmW4\",\r\n  authDomain: \"bringoedu.firebaseapp.com\",\r\n  projectId: \"bringoedu\",\r\n  storageBucket: \"bringoedu.firebasestorage.app\", \r\n  messagingSenderId: \"667720262345\",\r\n  appId: \"1:667720262345:web:ad55dd71c19ffcb73fa318\"\r\n};\r\n\r\n// Inicializar Firebase\r\nconst app = initializeApp(firebaseConfig);\r\nconst auth = getAuth(app);\r\nconst db = getFirestore(app);\r\n\r\n// Componente para gráfico de distribución\r\nconst DistribucionNotas = ({ estudiantes, calcularPromedioFinal }) => {\r\n  const calcularDistribucion = () => {\r\n    const distribucion = {\r\n      excelente: 0, // 4.5 - 5.0\r\n      bueno: 0,     // 3.5 - 4.4\r\n      regular: 0,   // 3.0 - 3.4\r\n      riesgo: 0     // 0 - 2.9\r\n    };\r\n\r\n    estudiantes.forEach(estudiante => {\r\n      const promedio = parseFloat(calcularPromedioFinal(estudiante));\r\n      if (promedio >= 4.5) distribucion.excelente++;\r\n      else if (promedio >= 3.5) distribucion.bueno++;\r\n      else if (promedio >= 3.0) distribucion.regular++;\r\n      else if (promedio > 0) distribucion.riesgo++;\r\n    });\r\n\r\n    return distribucion;\r\n  };\r\n\r\n  const distribucion = calcularDistribucion();\r\n  const total = estudiantes.length;\r\n  \r\n  if (total === 0) {\r\n    return (\r\n      <div className=\"text-center py-8 text-gray-500\">\r\n        <p>No hay datos suficientes</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <span className=\"text-sm font-semibold text-green-600\">Excelente (4.5-5.0)</span>\r\n        <span className=\"text-sm font-bold\">{distribucion.excelente} ({Math.round((distribucion.excelente/total)*100)}%)</span>\r\n      </div>\r\n      <div className=\"w-full bg-gray-200 rounded-full h-3\">\r\n        <div \r\n          className=\"bg-green-500 h-3 rounded-full transition-all duration-500\"\r\n          style={{ width: `${(distribucion.excelente/total)*100}%` }}\r\n        ></div>\r\n      </div>\r\n\r\n      <div className=\"flex items-center justify-between\">\r\n        <span className=\"text-sm font-semibold text-blue-600\">Bueno (3.5-4.4)</span>\r\n        <span className=\"text-sm font-bold\">{distribucion.bueno} ({Math.round((distribucion.bueno/total)*100)}%)</span>\r\n      </div>\r\n      <div className=\"w-full bg-gray-200 rounded-full h-3\">\r\n        <div \r\n          className=\"bg-blue-500 h-3 rounded-full transition-all duration-500\"\r\n          style={{ width: `${(distribucion.bueno/total)*100}%` }}\r\n        ></div>\r\n      </div>\r\n\r\n      <div className=\"flex items-center justify-between\">\r\n        <span className=\"text-sm font-semibold text-yellow-600\">Regular (3.0-3.4)</span>\r\n        <span className=\"text-sm font-bold\">{distribucion.regular} ({Math.round((distribucion.regular/total)*100)}%)</span>\r\n      </div>\r\n      <div className=\"w-full bg-gray-200 rounded-full h-3\">\r\n        <div \r\n          className=\"bg-yellow-500 h-3 rounded-full transition-all duration-500\"\r\n          style={{ width: `${(distribucion.regular/total)*100}%` }}\r\n        ></div>\r\n      </div>\r\n\r\n      <div className=\"flex items-center justify-between\">\r\n        <span className=\"text-sm font-semibold text-red-600\">En Riesgo (0-2.9)</span>\r\n        <span className=\"text-sm font-bold\">{distribucion.riesgo} ({Math.round((distribucion.riesgo/total)*100)}%)</span>\r\n      </div>\r\n      <div className=\"w-full bg-gray-200 rounded-full h-3\">\r\n        <div \r\n          className=\"bg-red-500 h-3 rounded-full transition-all duration-500\"\r\n          style={{ width: `${(distribucion.riesgo/total)*100}%` }}\r\n        ></div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Componente para Fila de Notas Rápidas\r\nconst FilaNotasRapidas = ({ estudiante, onAgregarNota, calcularPromedioFinal, claseSeleccionada, usuario, actualizarNota }) => {\r\n  const [notaDiaria, setNotaDiaria] = useState('');\r\n  const [notaApreciacion, setNotaApreciacion] = useState('');\r\n  const [notaExamen, setNotaExamen] = useState('');\r\n  const [fecha, setFecha] = useState(new Date().toISOString().split('T')[0]);\r\n\r\n  const handleAgregarNota = async (tipo, valor) => {\r\n    if (valor && parseFloat(valor) >= 0 && parseFloat(valor) <= 5) {\r\n      try {\r\n        await onAgregarNota(estudiante.id, tipo, parseFloat(valor), fecha);\r\n        \r\n        // Limpiar el campo\r\n        if (tipo === 'notasDiarias') setNotaDiaria('');\r\n        if (tipo === 'apreciacion') setNotaApreciacion('');\r\n        if (tipo === 'examen') setNotaExamen('');\r\n\r\n      } catch (error) {\r\n        console.error('Error agregando nota:', error);\r\n        alert('Error al agregar la nota');\r\n      }\r\n    } else {\r\n      alert('Por favor ingresa una nota válida entre 0 y 5');\r\n    }\r\n  };\r\n\r\n  const compartirPorWhatsApp = () => {\r\n    const formatoNotas = (notas) => {\r\n      return notas\r\n        .filter(n => n.valor && parseFloat(n.valor) > 0)\r\n        .map(n => `📅 ${n.fecha}: ${n.valor}/5.0`)\r\n        .join('\\n') || '📭 Sin notas registradas';\r\n    };\r\n\r\n    const mensaje = `📊 *REPORTE DE NOTAS - ${claseSeleccionada?.nombre}*\r\n\r\n*Estudiante:* ${estudiante.nombre}\r\n*Profesor:* ${usuario?.nombre}\r\n*Institución:* ${claseSeleccionada?.institucion || 'Bringo Edu'}\r\n*Fecha de reporte:* ${new Date().toLocaleDateString('es-PA')}\r\n\r\n*📝 NOTAS DIARIAS:*\r\n${formatoNotas(estudiante.notasDiarias)}\r\n\r\n*⭐ APRECIACIÓN:*\r\n${formatoNotas(estudiante.apreciacion)}\r\n\r\n*📋 EXAMEN:*\r\n${formatoNotas(estudiante.examen)}\r\n\r\n*🏆 PROMEDIO FINAL:* ${calcularPromedioFinal(estudiante)}/5.0\r\n\r\n---\r\nGenerado con Bringo Edu 📚 | Transparente y Confiable`;\r\n\r\n    const url = `https://wa.me/?text=${encodeURIComponent(mensaje)}`;\r\n    window.open(url, '_blank');\r\n  };\r\n\r\n  return (\r\n    <tr className=\"border-b border-gray-200 hover:bg-gray-50\">\r\n      <td className=\"px-4 py-3 font-semibold\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"bg-purple-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm\">\r\n            {estudiante.nombre.charAt(0).toUpperCase()}\r\n          </div>\r\n          <span>{estudiante.nombre}</span>\r\n        </div>\r\n      </td>\r\n      \r\n      <td className=\"px-4 py-3\">\r\n        <div className=\"flex gap-2\">\r\n          <input\r\n            type=\"number\"\r\n            step=\"0.1\"\r\n            min=\"0\"\r\n            max=\"5\"\r\n            placeholder=\"0-5\"\r\n            value={notaDiaria}\r\n            onChange={(e) => setNotaDiaria(e.target.value)}\r\n            className=\"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 text-center\"\r\n          />\r\n          <button\r\n            onClick={() => handleAgregarNota('notasDiarias', notaDiaria)}\r\n            className=\"bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 transition text-sm font-semibold\"\r\n          >\r\n            +\r\n          </button>\r\n        </div>\r\n      </td>\r\n      \r\n      <td className=\"px-4 py-3\">\r\n        <div className=\"flex gap-2\">\r\n          <input\r\n            type=\"number\"\r\n            step=\"0.1\"\r\n            min=\"0\"\r\n            max=\"5\"\r\n            placeholder=\"0-5\"\r\n            value={notaApreciacion}\r\n            onChange={(e) => setNotaApreciacion(e.target.value)}\r\n            className=\"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-green-500 text-center\"\r\n          />\r\n          <button\r\n            onClick={() => handleAgregarNota('apreciacion', notaApreciacion)}\r\n            className=\"bg-green-600 text-white px-3 py-2 rounded-lg hover:bg-green-700 transition text-sm font-semibold\"\r\n          >\r\n            +\r\n          </button>\r\n        </div>\r\n      </td>\r\n      \r\n      <td className=\"px-4 py-3\">\r\n        <div className=\"flex gap-2\">\r\n          <input\r\n            type=\"number\"\r\n            step=\"0.1\"\r\n            min=\"0\"\r\n            max=\"5\"\r\n            placeholder=\"0-5\"\r\n            value={notaExamen}\r\n            onChange={(e) => setNotaExamen(e.target.value)}\r\n            className=\"w-20 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 text-center\"\r\n          />\r\n          <button\r\n            onClick={() => handleAgregarNota('examen', notaExamen)}\r\n            className=\"bg-purple-600 text-white px-3 py-2 rounded-lg hover:bg-purple-700 transition text-sm font-semibold\"\r\n          >\r\n            +\r\n          </button>\r\n        </div>\r\n      </td>\r\n      \r\n      <td className=\"px-4 py-3 text-center\">\r\n        <span className={`text-xl font-bold ${\r\n          parseFloat(calcularPromedioFinal(estudiante)) >= 4.5 ? 'text-green-600' :\r\n          parseFloat(calcularPromedioFinal(estudiante)) >= 3.5 ? 'text-blue-600' :\r\n          parseFloat(calcularPromedioFinal(estudiante)) >= 3.0 ? 'text-yellow-600' : 'text-red-600'\r\n        }`}>\r\n          {calcularPromedioFinal(estudiante)}\r\n        </span>\r\n      </td>\r\n      \r\n      <td className=\"px-4 py-3 text-center\">\r\n        <button\r\n          onClick={compartirPorWhatsApp}\r\n          className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition font-semibold flex items-center gap-2 text-sm\"\r\n        >\r\n          <Share className=\"w-4 h-4\" />\r\n          WhatsApp\r\n        </button>\r\n      </td>\r\n    </tr>\r\n  );\r\n};\r\n\r\n// Componente de Modal Login\r\nconst ModalLogin = ({ \r\n  mostrarLogin, \r\n  setMostrarLogin, \r\n  email, \r\n  setEmail, \r\n  password, \r\n  setPassword, \r\n  errorAuth, \r\n  cargandoAuth, \r\n  iniciarSesion, \r\n  limpiarFormulariosAuth,\r\n  setMostrarRegistro \r\n}) => {\r\n  const [mostrarPassword, setMostrarPassword] = useState(false);\r\n\r\n  if (!mostrarLogin) return null;\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    iniciarSesion();\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-gradient-to-br from-purple-900/95 via-blue-900/95 to-indigo-900/95 backdrop-blur-sm flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-3xl shadow-2xl max-w-md w-full overflow-hidden transform transition-all\">\r\n        <div className=\"bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 p-8 text-center\">\r\n          <div className=\"inline-block bg-white rounded-full p-4 mb-4 shadow-lg\">\r\n            <LogIn className=\"w-8 h-8 text-purple-600\" />\r\n          </div>\r\n          <h3 className=\"text-3xl font-bold text-white mb-2\">¡Bienvenido de nuevo!</h3>\r\n          <p className=\"text-purple-100 text-sm\">Ingresa a tu cuenta de Bringo Edu</p>\r\n        </div>\r\n        \r\n        <form onSubmit={handleSubmit} className=\"p-8\">\r\n          {errorAuth && (\r\n            <div className=\"bg-red-50 border-2 border-red-200 rounded-lg p-3 mb-4\">\r\n              <p className=\"text-red-800 text-sm font-semibold\">{errorAuth}</p>\r\n            </div>\r\n          )}\r\n          \r\n          <div className=\"space-y-5\">\r\n            <div>\r\n              <label className=\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\">\r\n                <span className=\"text-purple-600\">📧</span> Email\r\n              </label>\r\n              <input\r\n                type=\"email\"\r\n                placeholder=\"profesor@ejemplo.com\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n                className=\"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all\"\r\n                required\r\n              />\r\n            </div>\r\n            \r\n            <div>\r\n              <label className=\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\">\r\n                <span className=\"text-purple-600\">🔒</span> Contraseña\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  type={mostrarPassword ? \"text\" : \"password\"}\r\n                  placeholder=\"••••••••\"\r\n                  value={password}\r\n                  onChange={(e) => setPassword(e.target.value)}\r\n                  className=\"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all pr-12\"\r\n                  required\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setMostrarPassword(!mostrarPassword)}\r\n                  className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition\"\r\n                >\r\n                  {mostrarPassword ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <button\r\n            type=\"submit\"\r\n            disabled={cargandoAuth}\r\n            className={`w-full mt-8 py-4 rounded-xl font-bold text-lg shadow-lg transition-all ${\r\n              cargandoAuth\r\n                ? 'bg-gray-400 cursor-not-allowed'\r\n                : 'bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 hover:shadow-xl transform hover:scale-[1.02]'\r\n            } text-white`}\r\n          >\r\n            {cargandoAuth ? 'Iniciando sesión...' : 'Iniciar Sesión'}\r\n          </button>\r\n          \r\n          <button\r\n            type=\"button\"\r\n            onClick={() => {\r\n              setMostrarLogin(false);\r\n              limpiarFormulariosAuth();\r\n            }}\r\n            className=\"w-full mt-3 bg-gray-100 text-gray-700 py-3 rounded-xl hover:bg-gray-200 transition font-semibold\"\r\n          >\r\n            Cancelar\r\n          </button>\r\n          \r\n          <div className=\"mt-6 text-center\">\r\n            <p className=\"text-gray-600 text-sm mb-2\">¿No tienes cuenta?</p>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => {\r\n                setMostrarLogin(false);\r\n                setMostrarRegistro(true);\r\n              }}\r\n              className=\"text-purple-600 hover:text-purple-800 font-bold text-lg hover:underline\"\r\n            >\r\n              Regístrate aquí\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Componente de Modal Registro\r\nconst ModalRegistro = ({ \r\n  mostrarRegistro, \r\n  setMostrarRegistro, \r\n  email, \r\n  setEmail, \r\n  password, \r\n  setPassword, \r\n  nombreUsuario, \r\n  setNombreUsuario, \r\n  confirmarPassword, \r\n  setConfirmarPassword, \r\n  errorAuth, \r\n  cargandoAuth, \r\n  registrarUsuario, \r\n  limpiarFormulariosAuth,\r\n  setMostrarLogin \r\n}) => {\r\n  const [mostrarPassword, setMostrarPassword] = useState(false);\r\n  const [mostrarConfirmarPassword, setMostrarConfirmarPassword] = useState(false);\r\n\r\n  if (!mostrarRegistro) return null;\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    registrarUsuario();\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-gradient-to-br from-green-900/95 via-teal-900/95 to-blue-900/95 backdrop-blur-sm flex items-center justify-center z-50 p-4\">\r\n      <div className=\"bg-white rounded-3xl shadow-2xl max-w-md w-full overflow-hidden transform transition-all\">\r\n        <div className=\"bg-gradient-to-r from-green-600 via-teal-600 to-blue-600 p-8 text-center\">\r\n          <div className=\"inline-block bg-white rounded-full p-4 mb-4 shadow-lg\">\r\n            <User className=\"w-8 h-8 text-green-600\" />\r\n          </div>\r\n          <h3 className=\"text-3xl font-bold text-white mb-2\">¡Únete a Bringo Edu!</h3>\r\n          <p className=\"text-green-100 text-sm\">Crea tu cuenta y comienza a gestionar tus clases</p>\r\n        </div>\r\n        \r\n        <form onSubmit={handleSubmit} className=\"p-8\">\r\n          {errorAuth && (\r\n            <div className=\"bg-red-50 border-2 border-red-200 rounded-lg p-3 mb-4\">\r\n              <p className=\"text-red-800 text-sm font-semibold\">{errorAuth}</p>\r\n            </div>\r\n          )}\r\n          \r\n          <div className=\"space-y-5\">\r\n            <div>\r\n              <label className=\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\">\r\n                <span className=\"text-green-600\">👤</span> Nombre Completo\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                placeholder=\"Prof. Juan Pérez\"\r\n                value={nombreUsuario}\r\n                onChange={(e) => setNombreUsuario(e.target.value)}\r\n                className=\"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 transition-all\"\r\n                required\r\n              />\r\n            </div>\r\n            \r\n            <div>\r\n              <label className=\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\">\r\n                <span className=\"text-green-600\">📧</span> Email\r\n              </label>\r\n              <input\r\n                type=\"email\"\r\n                placeholder=\"profesor@escuela.edu\"\r\n                value={email}\r\n                onChange={(e) => setEmail(e.target.value)}\r\n                className=\"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 transition-all\"\r\n                required\r\n              />\r\n            </div>\r\n            \r\n            <div>\r\n              <label className=\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\">\r\n                <span className=\"text-green-600\">🔒</span> Contraseña\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  type={mostrarPassword ? \"text\" : \"password\"}\r\n                  placeholder=\"Mínimo 6 caracteres\"\r\n                  value={password}\r\n                  onChange={(e) => setPassword(e.target.value)}\r\n                  className=\"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 transition-all pr-12\"\r\n                  required\r\n                  minLength={6}\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setMostrarPassword(!mostrarPassword)}\r\n                  className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition\"\r\n                >\r\n                  {mostrarPassword ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\r\n                </button>\r\n              </div>\r\n              <p className=\"text-xs text-gray-500 mt-1 ml-1\">Usa letras, números y símbolos</p>\r\n            </div>\r\n            \r\n            <div>\r\n              <label className=\"flex items-center gap-2 text-sm font-bold text-gray-700 mb-2\">\r\n                <span className=\"text-green-600\">✅</span> Confirmar Contraseña\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  type={mostrarConfirmarPassword ? \"text\" : \"password\"}\r\n                  placeholder=\"Repite tu contraseña\"\r\n                  value={confirmarPassword}\r\n                  onChange={(e) => setConfirmarPassword(e.target.value)}\r\n                  className=\"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-200 transition-all pr-12\"\r\n                  required\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setMostrarConfirmarPassword(!mostrarConfirmarPassword)}\r\n                  className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition\"\r\n                >\r\n                  {mostrarConfirmarPassword ? <EyeOff className=\"w-5 h-5\" /> : <Eye className=\"w-5 h-5\" />}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <button\r\n            type=\"submit\"\r\n            disabled={cargandoAuth}\r\n            className={`w-full mt-8 py-4 rounded-xl font-bold text-lg shadow-lg transition-all ${\r\n              cargandoAuth\r\n                ? 'bg-gray-400 cursor-not-allowed'\r\n                : 'bg-gradient-to-r from-green-600 to-teal-600 hover:from-green-700 hover:to-teal-700 hover:shadow-xl transform hover:scale-[1.02]'\r\n            } text-white`}\r\n          >\r\n            {cargandoAuth ? 'Creando cuenta...' : 'Crear Cuenta'}\r\n          </button>\r\n          \r\n          <button\r\n            type=\"button\"\r\n            onClick={() => {\r\n              setMostrarRegistro(false);\r\n              limpiarFormulariosAuth();\r\n            }}\r\n            className=\"w-full mt-3 bg-gray-100 text-gray-700 py-3 rounded-xl hover:bg-gray-200 transition font-semibold\"\r\n          >\r\n            Cancelar\r\n          </button>\r\n          \r\n          <div className=\"mt-6 text-center\">\r\n            <p className=\"text-gray-600 text-sm mb-2\">¿Ya tienes cuenta?</p>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => {\r\n                setMostrarRegistro(false);\r\n                setMostrarLogin(true);\r\n              }}\r\n              className=\"text-green-600 hover:text-green-800 font-bold text-lg hover:underline\"\r\n            >\r\n              Inicia sesión aquí\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Componente de Barra de Búsqueda de ESTUDIANTES MEJORADO con sugerencias\r\nconst BarraBusquedaEstudiantes = ({ estudiantes, onBuscarEstudiante, busquedaEstudiante, setBusquedaEstudiante }) => {\r\n  const [sugerencias, setSugerencias] = useState([]);\r\n  const [mostrarSugerencias, setMostrarSugerencias] = useState(false);\r\n\r\n  // Normalizar texto para búsqueda (minúsculas, sin tildes, sin comas)\r\n  const normalizarTexto = (texto) => {\r\n    return texto\r\n      .toLowerCase()\r\n      .normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\") // eliminar tildes\r\n      .replace(/[.,]/g, \"\"); // eliminar comas y puntos\r\n  };\r\n\r\n  // Filtrar sugerencias en tiempo real\r\n  useEffect(() => {\r\n    if (busquedaEstudiante.length >= 2) {\r\n      const textoBusqueda = normalizarTexto(busquedaEstudiante);\r\n      const sugerenciasFiltradas = estudiantes.filter(estudiante => \r\n        normalizarTexto(estudiante.nombre).includes(textoBusqueda)\r\n      );\r\n      setSugerencias(sugerenciasFiltradas);\r\n      setMostrarSugerencias(true);\r\n    } else {\r\n      setSugerencias([]);\r\n      setMostrarSugerencias(false);\r\n    }\r\n  }, [busquedaEstudiante, estudiantes]);\r\n\r\n  const buscarYRedirigirEstudiante = (nombre) => {\r\n    if (!nombre.trim()) return;\r\n    \r\n    const estudianteEncontrado = estudiantes.find(e => \r\n      normalizarTexto(e.nombre).includes(normalizarTexto(nombre))\r\n    );\r\n    \r\n    if (estudianteEncontrado) {\r\n      onBuscarEstudiante(estudianteEncontrado);\r\n      setBusquedaEstudiante('');\r\n      setMostrarSugerencias(false);\r\n    } else {\r\n      alert('Estudiante no encontrado');\r\n    }\r\n  };\r\n\r\n  const seleccionarSugerencia = (estudiante) => {\r\n    onBuscarEstudiante(estudiante);\r\n    setBusquedaEstudiante('');\r\n    setMostrarSugerencias(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-gradient-to-r from-blue-100 to-purple-100 rounded-xl p-4 mb-6\">\r\n      <div className=\"flex flex-col md:flex-row gap-4 items-center\">\r\n        <div className=\"flex-1 w-full relative\">\r\n          <label className=\"block text-sm font-bold text-gray-700 mb-2\">\r\n            🔍 Buscar Estudiante\r\n          </label>\r\n          <div className=\"relative\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Escribe el nombre del estudiante...\"\r\n              value={busquedaEstudiante}\r\n              onChange={(e) => setBusquedaEstudiante(e.target.value)}\r\n              onKeyPress={(e) => e.key === 'Enter' && buscarYRedirigirEstudiante(busquedaEstudiante)}\r\n              className=\"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500 text-sm md:text-base\"\r\n            />\r\n            \r\n            {/* Lista de sugerencias */}\r\n            {mostrarSugerencias && sugerencias.length > 0 && (\r\n              <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto\">\r\n                {sugerencias.map((estudiante) => (\r\n                  <div\r\n                    key={estudiante.id}\r\n                    onClick={() => seleccionarSugerencia(estudiante)}\r\n                    className=\"px-4 py-3 hover:bg-purple-50 cursor-pointer border-b border-gray-100 last:border-b-0\"\r\n                  >\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"bg-purple-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm\">\r\n                        {estudiante.nombre.charAt(0).toUpperCase()}\r\n                      </div>\r\n                      <span className=\"font-medium\">{estudiante.nombre}</span>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n          <p className=\"text-xs text-gray-600 mt-2\">\r\n            💡 Comienza a escribir para ver sugerencias. Ignora mayúsculas, tildes y comas.\r\n          </p>\r\n        </div>\r\n        \r\n        <div className=\"mt-4 md:mt-6\">\r\n          <button\r\n            onClick={() => buscarYRedirigirEstudiante(busquedaEstudiante)}\r\n            className=\"bg-purple-600 text-white px-4 md:px-6 py-3 rounded-lg hover:bg-purple-700 transition font-bold flex items-center gap-2 text-sm md:text-base\"\r\n          >\r\n            <Search className=\"w-4 h-4 md:w-5 md:h-5\" />\r\n            <span className=\"hidden sm:inline\">Buscar</span>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Componente para Cuadro de Porcentajes (En construcción)\r\nconst CuadroPorcentajes = () => {\r\n  return (\r\n    <div className=\"bg-white rounded-2xl shadow-lg p-8 text-center\">\r\n      <div className=\"max-w-md mx-auto\">\r\n        <div className=\"bg-yellow-100 border-2 border-yellow-300 rounded-xl p-6 mb-6\">\r\n          <PieChart className=\"w-16 h-16 text-yellow-600 mx-auto mb-4\" />\r\n          <h3 className=\"text-2xl font-bold text-yellow-800 mb-2\">En Construcción</h3>\r\n          <p className=\"text-yellow-700\">\r\n            Estamos trabajando en el Cuadro de Porcentajes. Pronto tendrás acceso a estadísticas \r\n            detalladas y análisis avanzados de rendimiento.\r\n          </p>\r\n        </div>\r\n        <div className=\"bg-gray-100 rounded-lg p-4\">\r\n          <p className=\"text-sm text-gray-600\">\r\n            📊 <strong>Próximamente:</strong> Gráficos de porcentajes, análisis comparativos, \r\n            tendencias de rendimiento y más herramientas de análisis educativo.\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n// Utilidades comunes\r\nconst normalizarDatos = (datosIn) => {\r\n  try {\r\n    if (typeof datosIn === 'string') return JSON.parse(datosIn);\r\n    return datosIn ?? {};\r\n  } catch {\r\n    return datosIn;\r\n  }\r\n};\r\n\r\nconst objetoATabla = (obj) => {\r\n  return Object.entries(obj).map(([key, value]) => ({\r\n    Campo: key,\r\n    Valor: typeof value === 'object' ? JSON.stringify(value) : String(value),\r\n  }));\r\n};\r\n\r\nconst descargarBlob = (blob, nombreArchivo) => {\r\n  const url = URL.createObjectURL(blob);\r\n  const link = document.createElement('a');\r\n  link.href = url;\r\n  link.download = nombreArchivo;\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n  URL.revokeObjectURL(url);\r\n};\r\n\r\n// Exportar a Excel (arreglado)\r\nconst exportarAExcel = (datosIn, nombreArchivo) => {\r\n  try {\r\n    const datos = normalizarDatos(datosIn);\r\n    const workbook = XLSX.utils.book_new();\r\n\r\n    let worksheet;\r\n    if (Array.isArray(datos)) {\r\n      worksheet = XLSX.utils.json_to_sheet(datos);\r\n    } else if (typeof datos === 'object' && datos) {\r\n      worksheet = XLSX.utils.json_to_sheet(objetoATabla(datos));\r\n    } else {\r\n      worksheet = XLSX.utils.json_to_sheet([{ Valor: String(datos) }]);\r\n    }\r\n\r\n    XLSX.utils.book_append_sheet(workbook, worksheet, 'Datos');\r\n    XLSX.writeFile(workbook, `${nombreArchivo}.xlsx`);\r\n    console.log('✅ Archivo Excel generado exitosamente');\r\n  } catch (error) {\r\n    console.error('❌ Error al exportar a Excel:', error);\r\n    alert('Error al generar archivo Excel');\r\n  }\r\n};\r\n\r\n// Exportar a PDF (arreglado)\r\n// FUNCIONES DE EXPORTACIÓN CORREGIDAS - BACKEND FUNCIONA\r\nconst exportarAPDF = (datosIn, nombreArchivo) => {\r\n  try {\r\n    const datos = normalizarDatos(datosIn);\r\n    \r\n    // Crear instancia de jsPDF\r\n    const doc = new jsPDF();\r\n    \r\n    // Configuración inicial\r\n    doc.setFontSize(16);\r\n    doc.setTextColor(40);\r\n    doc.text('Reporte Bringo Edu', 20, 20);\r\n    \r\n    doc.setFontSize(10);\r\n    doc.setTextColor(100);\r\n    doc.text(`Generado: ${new Date().toLocaleDateString('es-PA')}`, 20, 30);\r\n    \r\n    let yPosition = 45;\r\n\r\n    // Función auxiliar para agregar tabla\r\n    const agregarTabla = (titulo, datosTabla) => {\r\n      if (!Array.isArray(datosTabla) || datosTabla.length === 0) return;\r\n      \r\n      // Verificar si necesitamos nueva página\r\n      if (yPosition > 260) {\r\n        doc.addPage();\r\n        yPosition = 20;\r\n      }\r\n      \r\n      // Agregar título\r\n      doc.setFontSize(12);\r\n      doc.setTextColor(40);\r\n      doc.text(titulo, 20, yPosition);\r\n      yPosition += 8;\r\n\r\n      // Preparar datos para la tabla\r\n      const headers = Object.keys(datosTabla[0] || {});\r\n      const body = datosTabla.map((fila) => \r\n        headers.map(header => {\r\n          const valor = fila[header];\r\n          // Manejar diferentes tipos de datos\r\n          if (valor === null || valor === undefined) return '';\r\n          if (typeof valor === 'object') return JSON.stringify(valor);\r\n          return String(valor);\r\n        })\r\n      );\r\n\r\n      // Usar autoTable correctamente - FORMA SIMPLIFICADA Y SEGURA\r\n      doc.autoTable({\r\n        startY: yPosition,\r\n        head: [headers],\r\n        body: body,\r\n        styles: { \r\n          fontSize: 8, \r\n          cellPadding: 2,\r\n          overflow: 'linebreak'\r\n        },\r\n        headStyles: { \r\n          fillColor: [128, 100, 255],\r\n          textColor: 255,\r\n          fontStyle: 'bold'\r\n        },\r\n        margin: { left: 15, right: 15 },\r\n        tableWidth: 'auto'\r\n      });\r\n\r\n      // Actualizar posición Y\r\n      yPosition = doc.lastAutoTable.finalY + 10;\r\n    };\r\n\r\n    // Procesar datos según el tipo\r\n    if (Array.isArray(datos)) {\r\n      agregarTabla('Datos del Reporte', datos);\r\n    } else if (typeof datos === 'object' && datos !== null) {\r\n      // Convertir objeto a array para tabla\r\n      const datosArray = Object.entries(datos).map(([clave, valor]) => ({\r\n        Campo: clave,\r\n        Valor: typeof valor === 'object' ? JSON.stringify(valor, null, 2) : String(valor)\r\n      }));\r\n      agregarTabla('Resumen del Reporte', datosArray);\r\n      \r\n      // Procesar arrays dentro del objeto\r\n      Object.entries(datos).forEach(([clave, valor]) => {\r\n        if (Array.isArray(valor) && valor.length > 0) {\r\n          if (typeof valor[0] === 'object') {\r\n            agregarTabla(clave, valor);\r\n          } else {\r\n            // Si es array de valores simples\r\n            const arraySimple = valor.map((v, i) => ({ '#': i + 1, 'Valor': v }));\r\n            agregarTabla(clave, arraySimple);\r\n          }\r\n        }\r\n      });\r\n    } else {\r\n      agregarTabla('Datos', [{ Valor: String(datos) }]);\r\n    }\r\n\r\n    // Guardar el PDF\r\n    doc.save(`${nombreArchivo}.pdf`);\r\n    console.log('✅ Archivo PDF generado exitosamente');\r\n  } catch (error) {\r\n    console.error('❌ Error al exportar a PDF:', error);\r\n    alert('Error al generar archivo PDF: ' + error.message);\r\n  }\r\n};\r\n\r\n// Exportar a Word (CORREGIDO para navegador)\r\nconst exportarAWord = async (datosIn, nombreArchivo) => {\r\n  try {\r\n    const datos = normalizarDatos(datosIn);\r\n    const children = [];\r\n\r\n    children.push(\r\n      new Paragraph({\r\n        children: [new TextRun({ text: 'Reporte Bringo Edu', bold: true, size: 32 })],\r\n        alignment: AlignmentType.CENTER,\r\n        spacing: { after: 400 },\r\n      }),\r\n      new Paragraph({\r\n        children: [new TextRun({ text: `Generado: ${new Date().toLocaleDateString('es-PA')}`, italics: true, size: 20 })],\r\n        alignment: AlignmentType.CENTER,\r\n        spacing: { after: 400 },\r\n      })\r\n    );\r\n\r\n    if (Array.isArray(datos) && datos.length > 0) {\r\n      const headers = Object.keys(datos[0]);\r\n      const tableRows = [\r\n        new TableRow({\r\n          children: headers.map((key) =>\r\n            new TableCell({\r\n              children: [new Paragraph({ children: [new TextRun({ text: key, bold: true })] })],\r\n              shading: { fill: 'D0C9FF' },\r\n            })\r\n          ),\r\n        }),\r\n        ...datos.map(\r\n          (row) =>\r\n            new TableRow({\r\n              children: headers.map((key) =>\r\n                new TableCell({\r\n                  children: [\r\n                    new Paragraph({\r\n                      children: [\r\n                        new TextRun({\r\n                          text: typeof row[key] === 'object' ? JSON.stringify(row[key]) : String(row[key] ?? ''),\r\n                        }),\r\n                      ],\r\n                    }),\r\n                  ],\r\n                })\r\n              ),\r\n            })\r\n        ),\r\n      ];\r\n\r\n      children.push(\r\n        new Paragraph({\r\n          children: [new TextRun({ text: 'Datos del Reporte', bold: true, size: 24 })],\r\n          spacing: { after: 200 },\r\n        }),\r\n        new Table({ width: { size: 100, type: 'pct' }, rows: tableRows })\r\n      );\r\n    } else if (typeof datos === 'object' && datos) {\r\n      Object.entries(datos).forEach(([key, value]) => {\r\n        children.push(\r\n          new Paragraph({\r\n            children: [\r\n              new TextRun({ text: `${key}: `, bold: true, size: 20 }),\r\n              new TextRun({ text: typeof value === 'object' ? JSON.stringify(value, null, 2) : String(value ?? ''), size: 20 }),\r\n            ],\r\n            spacing: { after: 200 },\r\n          })\r\n        );\r\n      });\r\n    } else {\r\n      children.push(new Paragraph({ children: [new TextRun({ text: String(datos ?? ''), size: 20 })] }));\r\n    }\r\n\r\n    const doc = new Document({ sections: [{ properties: {}, children }] });\r\n    \r\n    // CAMBIO PRINCIPAL: Usar toBlob() en lugar de toBuffer()\r\n    const blob = await Packer.toBlob(doc);\r\n    \r\n    // Descargar directamente el blob\r\n    const url = URL.createObjectURL(blob);\r\n    const link = document.createElement('a');\r\n    link.href = url;\r\n    link.download = `${nombreArchivo}.docx`;\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n    URL.revokeObjectURL(url);\r\n    \r\n    console.log('✅ Archivo Word generado exitosamente');\r\n  } catch (error) {\r\n    console.error('❌ Error al exportar a Word:', error);\r\n    alert('Error al generar archivo Word: ' + error.message);\r\n  }\r\n};\r\n\r\n// Función optimizada para generar blob de PDF (para Google Drive)\r\nconst generarBlobPDF = (datosIn) => {\r\n  return new Promise((resolve, reject) => {\r\n    try {\r\n      const datos = normalizarDatos(datosIn);\r\n      const doc = new jsPDF();\r\n      \r\n      // Configuración del documento\r\n      doc.setFontSize(16);\r\n      doc.setTextColor(40);\r\n      doc.text('Reporte Bringo Edu', 20, 20);\r\n      \r\n      doc.setFontSize(10);\r\n      doc.setTextColor(100);\r\n      doc.text(`Generado: ${new Date().toLocaleDateString('es-PA')}`, 20, 30);\r\n      \r\n      let yPosition = 45;\r\n\r\n      const agregarTabla = (titulo, datosTabla) => {\r\n        if (!Array.isArray(datosTabla) || datosTabla.length === 0) return;\r\n        \r\n        if (yPosition > 260) {\r\n          doc.addPage();\r\n          yPosition = 20;\r\n        }\r\n        \r\n        doc.setFontSize(12);\r\n        doc.setTextColor(40);\r\n        doc.text(titulo, 20, yPosition);\r\n        yPosition += 8;\r\n\r\n        const headers = Object.keys(datosTabla[0] || {});\r\n        const body = datosTabla.map((fila) => \r\n          headers.map(header => {\r\n            const valor = fila[header];\r\n            if (valor === null || valor === undefined) return '';\r\n            if (typeof valor === 'object') return JSON.stringify(valor);\r\n            return String(valor);\r\n          })\r\n        );\r\n\r\n        // AutoTable seguro\r\n        doc.autoTable({\r\n          startY: yPosition,\r\n          head: [headers],\r\n          body: body,\r\n          styles: { \r\n            fontSize: 8, \r\n            cellPadding: 2,\r\n            overflow: 'linebreak'\r\n          },\r\n          headStyles: { \r\n            fillColor: [128, 100, 255],\r\n            textColor: 255,\r\n            fontStyle: 'bold'\r\n          },\r\n          margin: { left: 15, right: 15 }\r\n        });\r\n\r\n        yPosition = doc.lastAutoTable.finalY + 10;\r\n      };\r\n\r\n      // Lógica de procesamiento de datos\r\n      if (Array.isArray(datos)) {\r\n        agregarTabla('Datos del Reporte', datos);\r\n      } else if (typeof datos === 'object' && datos !== null) {\r\n        const datosArray = Object.entries(datos).map(([clave, valor]) => ({\r\n          Campo: clave,\r\n          Valor: typeof valor === 'object' ? JSON.stringify(valor, null, 2) : String(valor)\r\n        }));\r\n        agregarTabla('Resumen del Reporte', datosArray);\r\n        \r\n        Object.entries(datos).forEach(([clave, valor]) => {\r\n          if (Array.isArray(valor) && valor.length > 0) {\r\n            if (typeof valor[0] === 'object') {\r\n              agregarTabla(clave, valor);\r\n            } else {\r\n              const arraySimple = valor.map((v, i) => ({ '#': i + 1, 'Valor': v }));\r\n              agregarTabla(clave, arraySimple);\r\n            }\r\n          }\r\n        });\r\n      } else {\r\n        agregarTabla('Datos', [{ Valor: String(datos) }]);\r\n      }\r\n\r\n      // Generar blob\r\n      const blob = doc.output('blob');\r\n      resolve({\r\n        blob,\r\n        ext: 'pdf',\r\n        mime: 'application/pdf'\r\n      });\r\n    } catch (error) {\r\n      reject(error);\r\n    }\r\n  });\r\n};\r\n\r\n// Generar Blob por formato (útil también para Google Drive) - CORREGIDO\r\nconst generarBlobPorFormato = async (datosIn, formato) => {\r\n  const datos = normalizarDatos(datosIn);\r\n  console.log(`📊 Generando blob para formato: ${formato}`, datos);\r\n\r\n  if (formato === 'excel') {\r\n    const workbook = XLSX.utils.book_new();\r\n    let worksheet;\r\n    \r\n    if (Array.isArray(datos)) {\r\n      worksheet = XLSX.utils.json_to_sheet(datos);\r\n    } else if (typeof datos === 'object' && datos !== null) {\r\n      worksheet = XLSX.utils.json_to_sheet(objetoATabla(datos));\r\n    } else {\r\n      worksheet = XLSX.utils.json_to_sheet([{ Valor: String(datos) }]);\r\n    }\r\n    \r\n    XLSX.utils.book_append_sheet(workbook, worksheet, 'Datos');\r\n    const arrayBuffer = XLSX.write(workbook, { \r\n      bookType: 'xlsx', \r\n      type: 'array' \r\n    });\r\n    \r\n    return {\r\n      blob: new Blob([arrayBuffer], { \r\n        type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' \r\n      }),\r\n      ext: 'xlsx',\r\n      mime: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n    };\r\n  }\r\n\r\n  if (formato === 'pdf') {\r\n    return await generarBlobPDF(datos);\r\n  }\r\n\r\n  if (formato === 'word') {\r\n    const children = [\r\n      new Paragraph({\r\n        children: [new TextRun({ text: 'Reporte Bringo Edu', bold: true, size: 32 })],\r\n        alignment: AlignmentType.CENTER,\r\n        spacing: { after: 400 },\r\n      }),\r\n      new Paragraph({\r\n        children: [new TextRun({ text: `Generado: ${new Date().toLocaleDateString('es-PA')}`, italics: true, size: 20 })],\r\n        alignment: AlignmentType.CENTER,\r\n        spacing: { after: 400 },\r\n      }),\r\n    ];\r\n\r\n    if (Array.isArray(datos) && datos.length > 0) {\r\n      const headers = Object.keys(datos[0]);\r\n      const rows = [\r\n        new TableRow({\r\n          children: headers.map((k) =>\r\n            new TableCell({\r\n              children: [new Paragraph({ children: [new TextRun({ text: k, bold: true })] })],\r\n              shading: { fill: 'D0C9FF' },\r\n            })\r\n          ),\r\n        }),\r\n        ...datos.map(\r\n          (row) =>\r\n            new TableRow({\r\n              children: headers.map((k) =>\r\n                new TableCell({\r\n                  children: [new Paragraph({ children: [new TextRun({ text: typeof row[k] === 'object' ? JSON.stringify(row[k]) : String(row[k] ?? '') })] })],\r\n                })\r\n              ),\r\n            })\r\n        ),\r\n      ];\r\n      children.push(\r\n        new Paragraph({ children: [new TextRun({ text: 'Datos del Reporte', bold: true, size: 24 })], spacing: { after: 200 } }),\r\n        new Table({ width: { size: 100, type: 'pct' }, rows })\r\n      );\r\n    } else if (typeof datos === 'object' && datos) {\r\n      Object.entries(datos).forEach(([key, value]) => {\r\n        children.push(\r\n          new Paragraph({\r\n            children: [\r\n              new TextRun({ text: `${key}: `, bold: true, size: 20 }),\r\n              new TextRun({ text: typeof value === 'object' ? JSON.stringify(value, null, 2) : String(value ?? ''), size: 20 }),\r\n            ],\r\n            spacing: { after: 200 },\r\n          })\r\n        );\r\n      });\r\n    } else {\r\n      children.push(new Paragraph({ children: [new TextRun({ text: String(datos ?? ''), size: 20 })] }));\r\n    }\r\n\r\n    const docx = new Document({ sections: [{ properties: {}, children }] });\r\n    const blob = await Packer.toBlob(docx);\r\n    return { \r\n      blob, \r\n      ext: 'docx', \r\n      mime: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' \r\n    };\r\n  }\r\n\r\n  throw new Error(`Formato no soportado: ${formato}`);\r\n};\r\n\r\n// Subir a Google Drive (REAL con backend) - MEJORADO\r\nconst subirAGoogleDrive = async (datosIn, nombreArchivoBase, formato = 'pdf') => {\r\n  try {\r\n    console.log('🔄 Iniciando subida a Google Drive...', { nombreArchivoBase, formato });\r\n    \r\n    const { blob, ext, mime } = await generarBlobPorFormato(datosIn, formato);\r\n    const nombreArchivo = `${nombreArchivoBase}.${ext}`;\r\n\r\n    console.log('📦 Preparando FormData...', { nombreArchivo, tipo: mime });\r\n    \r\n    const formData = new FormData();\r\n    formData.append('file', blob, nombreArchivo);\r\n    formData.append('filename', nombreArchivo);\r\n    formData.append('mimeType', mime);\r\n\r\n    // Configurar headers de autenticación\r\n    let headers = {\r\n      'Accept': 'application/json',\r\n    };\r\n\r\n    // Agregar token de autenticación si está disponible\r\n    if (auth?.currentUser) {\r\n      try {\r\n        const token = await auth.currentUser.getIdToken();\r\n        headers['Authorization'] = `Bearer ${token}`;\r\n        console.log('🔐 Token de autenticación incluido');\r\n      } catch (tokenError) {\r\n        console.warn('⚠️ No se pudo obtener token, intentando sin autenticación');\r\n      }\r\n    }\r\n\r\n    const DRIVE_UPLOAD_URL = 'https://bringo-edu-backend-2.onrender.com/api/drive/upload';\r\n    \r\n    console.log('🚀 Enviando a:', DRIVE_UPLOAD_URL);\r\n    \r\n    // Timeout de 25 segundos\r\n    const controller = new AbortController();\r\n    const timeoutId = setTimeout(() => controller.abort(), 25000);\r\n\r\n    const response = await fetch(DRIVE_UPLOAD_URL, {\r\n      method: 'POST',\r\n      headers: headers,\r\n      body: formData,\r\n      signal: controller.signal\r\n    });\r\n\r\n    clearTimeout(timeoutId);\r\n\r\n    console.log('📨 Respuesta del servidor:', response.status);\r\n    \r\n    if (!response.ok) {\r\n      const errorText = await response.text();\r\n      console.error('❌ Error response:', errorText);\r\n      throw new Error(`Error ${response.status}: ${errorText || 'Error del servidor'}`);\r\n    }\r\n\r\n    const result = await response.json();\r\n    console.log('✅ Subida a Drive exitosa:', result);\r\n    \r\n    // Mostrar mensaje de éxito\r\n    alert(`🎉 ¡Archivo subido exitosamente a Google Drive!\\n\\n📁 Nombre: ${nombreArchivo}\\n📊 Tipo: ${formato.toUpperCase()}`);\r\n    \r\n    return result;\r\n\r\n  } catch (error) {\r\n    console.error('❌ Error completo en subida a Drive:', error);\r\n    \r\n    let mensajeUsuario = 'Error al subir a Google Drive';\r\n    \r\n    if (error.name === 'AbortError') {\r\n      mensajeUsuario = '⏰ El servidor tardó demasiado en responder. Intenta nuevamente.';\r\n    } else if (error.message.includes('Failed to fetch')) {\r\n      mensajeUsuario = '🌐 Error de conexión. Verifica tu internet e intenta nuevamente.';\r\n    } else if (error.message.includes('404')) {\r\n      mensajeUsuario = '🔍 Servicio no encontrado. El backend podría estar en mantenimiento.';\r\n    } else {\r\n      mensajeUsuario = `❌ ${error.message}`;\r\n    }\r\n    \r\n    alert(mensajeUsuario);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Componente OpcionesExportacion mejorado\r\nfunction OpcionesExportacion({ datos, nombreArchivo, onExportar }) {\r\n  const [mostrarOpciones, setMostrarOpciones] = useState(false);\r\n  const [mostrarDrive, setMostrarDrive] = useState(false);\r\n  const [exportando, setExportando] = useState('');\r\n\r\n  const handleExportar = async (formato, destino = 'descarga') => {\r\n    const operacion = `${destino}-${formato}`;\r\n    setExportando(operacion);\r\n    \r\n    try {\r\n      console.log(`🚀 Iniciando exportación: ${destino} - ${formato}`);\r\n      \r\n      if (destino === 'descarga') {\r\n        switch (formato) {\r\n          case 'excel':\r\n            exportarAExcel(datos, nombreArchivo);\r\n            break;\r\n          case 'pdf':\r\n            exportarAPDF(datos, nombreArchivo);\r\n            break;\r\n          case 'word':\r\n            await exportarAWord(datos, nombreArchivo);\r\n            break;\r\n        }\r\n        alert(`✅ Descarga completada: ${formato.toUpperCase()}`);\r\n      } else if (destino === 'drive') {\r\n        await subirAGoogleDrive(datos, nombreArchivo, formato);\r\n        // El alert ya se muestra en subirAGoogleDrive\r\n      }\r\n      \r\n      setMostrarOpciones(false);\r\n      setMostrarDrive(false);\r\n      if (onExportar) onExportar(formato, destino);\r\n      \r\n    } catch (error) {\r\n      console.error(`Error en exportación ${formato} a ${destino}:`, error);\r\n      // El error ya se muestra en las funciones individuales\r\n    } finally {\r\n      setExportando('');\r\n    }\r\n  };\r\n\r\n  const getBotonTexto = (formato, destino) => {\r\n    if (exportando === `${destino}-${formato}`) {\r\n      return '⏳ Procesando...';\r\n    }\r\n    \r\n    const formatos = {\r\n      excel: '📊 Excel',\r\n      pdf: '📄 PDF', \r\n      word: '📝 Word'\r\n    };\r\n    \r\n    const destinos = {\r\n      descarga: 'Descargar',\r\n      drive: 'Subir a Drive'\r\n    };\r\n    \r\n    return `${destinos[destino]} ${formatos[formato]}`;\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <button\r\n        onClick={() => {\r\n          setMostrarOpciones((v) => !v);\r\n          setMostrarDrive(false);\r\n        }}\r\n        disabled={!!exportando}\r\n        className={`bg-gradient-to-r from-purple-600 to-blue-600 text-white px-4 py-2 rounded-lg hover:from-purple-700 hover:to-blue-700 transition font-bold flex items-center gap-2 ${\r\n          exportando ? 'opacity-50 cursor-not-allowed' : ''\r\n        }`}\r\n      >\r\n        {exportando ? (\r\n          <>\r\n            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\r\n            Exportando...\r\n          </>\r\n        ) : (\r\n          <>\r\n            <Download className=\"w-5 h-5\" />\r\n            Exportar\r\n          </>\r\n        )}\r\n      </button>\r\n\r\n      {mostrarOpciones && !exportando && (\r\n        <div className=\"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-xl border border-gray-200 z-50\">\r\n          {/* Descargas locales */}\r\n          <div className=\"p-2\">\r\n            <h4 className=\"text-sm font-bold text-gray-700 mb-2 px-2\">📥 Descargar Localmente</h4>\r\n            <button\r\n              onClick={() => handleExportar('excel', 'descarga')}\r\n              className=\"w-full px-4 py-3 text-left hover:bg-green-50 flex items-center gap-2 rounded-lg border-b border-gray-100 text-sm\"\r\n            >\r\n              <span className=\"text-green-600\">📊</span>\r\n              <span>{getBotonTexto('excel', 'descarga')}</span>\r\n            </button>\r\n            <button\r\n              onClick={() => handleExportar('pdf', 'descarga')}\r\n              className=\"w-full px-4 py-3 text-left hover:bg-red-50 flex items-center gap-2 rounded-lg border-b border-gray-100 text-sm\"\r\n            >\r\n              <span className=\"text-red-600\">📄</span>\r\n              <span>{getBotonTexto('pdf', 'descarga')}</span>\r\n            </button>\r\n            <button\r\n              onClick={() => handleExportar('word', 'descarga')}\r\n              className=\"w-full px-4 py-3 text-left hover:bg-blue-50 flex items-center gap-2 rounded-lg text-sm\"\r\n            >\r\n              <span className=\"text-blue-600\">📝</span>\r\n              <span>{getBotonTexto('word', 'descarga')}</span>\r\n            </button>\r\n          </div>\r\n\r\n          {/* Google Drive */}\r\n          <div className=\"border-t border-gray-200\">\r\n            {!mostrarDrive ? (\r\n              <button\r\n                onClick={() => setMostrarDrive(true)}\r\n                className=\"w-full px-4 py-3 text-left hover:bg-yellow-50 flex items-center gap-2 text-sm\"\r\n              >\r\n                <span className=\"text-yellow-600\">☁️</span>\r\n                <span>Google Drive</span>\r\n                <span className=\"ml-auto\">▶</span>\r\n              </button>\r\n            ) : (\r\n              <div className=\"p-2 bg-yellow-50\">\r\n                <div className=\"flex items-center gap-2 mb-2 px-2\">\r\n                  <button\r\n                    onClick={() => setMostrarDrive(false)}\r\n                    className=\"text-gray-500 hover:text-gray-700\"\r\n                  >\r\n                    ◀\r\n                  </button>\r\n                  <h4 className=\"text-sm font-bold text-gray-700\">☁️ Subir a Google Drive</h4>\r\n                </div>\r\n                <button\r\n                  onClick={() => handleExportar('excel', 'drive')}\r\n                  className=\"w-full px-4 py-3 text-left hover:bg-white flex items-center gap-2 rounded-lg border-b border-yellow-100 text-sm\"\r\n                >\r\n                  <span className=\"text-green-600\">📊</span>\r\n                  <span>{getBotonTexto('excel', 'drive')}</span>\r\n                </button>\r\n                <button\r\n                  onClick={() => handleExportar('pdf', 'drive')}\r\n                  className=\"w-full px-4 py-3 text-left hover:bg-white flex items-center gap-2 rounded-lg border-b border-yellow-100 text-sm\"\r\n                >\r\n                  <span className=\"text-red-600\">📄</span>\r\n                  <span>{getBotonTexto('pdf', 'drive')}</span>\r\n                </button>\r\n                <button\r\n                  onClick={() => handleExportar('word', 'drive')}\r\n                  className=\"w-full px-4 py-3 text-left hover:bg-white flex items-center gap-2 rounded-lg text-sm\"\r\n                >\r\n                  <span className=\"text-blue-600\">📝</span>\r\n                  <span>{getBotonTexto('word', 'drive')}</span>\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n// [El resto del código se mantiene igual hasta el final...]\r\n\r\nexport default function AsistenteProfesor() {\r\n  const [usuario, setUsuario] = useState(null);\r\n  const [mostrarLogin, setMostrarLogin] = useState(false);\r\n  const [mostrarRegistro, setMostrarRegistro] = useState(false);\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [nombreUsuario, setNombreUsuario] = useState('');\r\n  const [confirmarPassword, setConfirmarPassword] = useState('');\r\n  const [errorAuth, setErrorAuth] = useState('');\r\n  const [cargandoAuth, setCargandoAuth] = useState(false);\r\n  \r\n  const [view, setView] = useState('home');\r\n  const [clases, setClases] = useState([]);\r\n  const [claseSeleccionada, setClaseSeleccionada] = useState(null);\r\n  const [nombreClase, setNombreClase] = useState('');\r\n  const [grado, setGrado] = useState('');\r\n  const [seccion, setSeccion] = useState('');\r\n  const [nombreProfesorClase, setNombreProfesorClase] = useState('');\r\n  const [institucionClase, setInstitucionClase] = useState('');\r\n  const [estudiantes, setEstudiantes] = useState([]);\r\n  const [nombreEstudiante, setNombreEstudiante] = useState('');\r\n  const [expandido, setExpandido] = useState({});\r\n  const [fechaActual, setFechaActual] = useState(new Date().toISOString().split('T')[0]);\r\n  \r\n  const [nombreProfesor, setNombreProfesor] = useState('');\r\n  const [institucion, setInstitucion] = useState('');\r\n  const [gradoPlan, setGradoPlan] = useState('');\r\n  const [materia, setMateria] = useState('');\r\n  const [trimestre, setTrimestre] = useState('Primer Trimestre');\r\n  const [planGenerado, setPlanGenerado] = useState(null);\r\n  const [generandoPlan, setGenerandoPlan] = useState(false);\r\n\r\n  // Estado para búsqueda de estudiantes - MANTENIDO\r\n  const [busquedaEstudiante, setBusquedaEstudiante] = useState('');\r\n\r\n  // Efecto para manejar el estado de autenticación\r\n  useEffect(() => {\r\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\r\n      if (user) {\r\n        setUsuario({ \r\n          email: user.email, \r\n          nombre: user.displayName || user.email.split('@')[0],\r\n          uid: user.uid \r\n        });\r\n        cargarClases(user.uid);\r\n      } else {\r\n        setUsuario(null);\r\n        setClases([]);\r\n      }\r\n    });\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  // Cargar clases desde Firestore\r\n  const cargarClases = async (userId) => {\r\n    try {\r\n      const q = query(collection(db, 'clases'), where('userId', '==', userId));\r\n      const querySnapshot = await getDocs(q);\r\n      const clasesData = [];\r\n      querySnapshot.forEach((doc) => {\r\n        clasesData.push({ id: doc.id, ...doc.data() });\r\n      });\r\n      setClases(clasesData);\r\n    } catch (error) {\r\n      console.error('Error cargando clases:', error);\r\n    }\r\n  };\r\n\r\n  const registrarUsuario = async () => {\r\n    setErrorAuth('');\r\n    \r\n    if (!email || !password || !nombreUsuario) {\r\n      setErrorAuth('Por favor completa todos los campos');\r\n      return;\r\n    }\r\n    \r\n    if (password !== confirmarPassword) {\r\n      setErrorAuth('Las contraseñas no coinciden');\r\n      return;\r\n    }\r\n    \r\n    if (password.length < 6) {\r\n      setErrorAuth('La contraseña debe tener al menos 6 caracteres');\r\n      return;\r\n    }\r\n\r\n    setCargandoAuth(true);\r\n    \r\n    try {\r\n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\r\n      setUsuario({ \r\n        email: userCredential.user.email, \r\n        nombre: nombreUsuario,\r\n        uid: userCredential.user.uid \r\n      });\r\n      setMostrarRegistro(false);\r\n      limpiarFormulariosAuth();\r\n    } catch (error) {\r\n      if (error.code === 'auth/email-already-in-use') {\r\n        setErrorAuth('Este correo ya está registrado');\r\n      } else if (error.code === 'auth/weak-password') {\r\n        setErrorAuth('La contraseña es muy débil');\r\n      } else {\r\n        setErrorAuth('Error al registrar: ' + error.message);\r\n      }\r\n    } finally {\r\n      setCargandoAuth(false);\r\n    }\r\n  };\r\n\r\n  const iniciarSesion = async () => {\r\n    setErrorAuth('');\r\n    \r\n    if (!email || !password) {\r\n      setErrorAuth('Por favor ingresa email y contraseña');\r\n      return;\r\n    }\r\n\r\n    setCargandoAuth(true);\r\n\r\n    try {\r\n      const userCredential = await signInWithEmailAndPassword(auth, email, password);\r\n      setUsuario({ \r\n        email: userCredential.user.email, \r\n        nombre: userCredential.user.displayName || userCredential.user.email.split('@')[0],\r\n        uid: userCredential.user.uid \r\n      });\r\n      setMostrarLogin(false);\r\n      limpiarFormulariosAuth();\r\n    } catch (error) {\r\n      if (error.code === 'auth/user-not-found') {\r\n        setErrorAuth('Usuario no encontrado');\r\n      } else if (error.code === 'auth/wrong-password') {\r\n        setErrorAuth('Contraseña incorrecta');\r\n      } else {\r\n        setErrorAuth('Error al iniciar sesión: ' + error.message);\r\n      }\r\n    } finally {\r\n      setCargandoAuth(false);\r\n    }\r\n  };\r\n\r\n  const cerrarSesion = async () => {\r\n    try {\r\n      await signOut(auth);\r\n      setUsuario(null);\r\n      setView('home');\r\n      setClaseSeleccionada(null);\r\n      setClases([]);\r\n    } catch (error) {\r\n      console.error('Error al cerrar sesión:', error);\r\n    }\r\n  };\r\n\r\n  const limpiarFormulariosAuth = () => {\r\n    setEmail('');\r\n    setPassword('');\r\n    setNombreUsuario('');\r\n    setConfirmarPassword('');\r\n    setErrorAuth('');\r\n  };\r\n\r\n  // FUNCIÓN MEJORADA: Generar plan trimestral\r\n  const generarPlanConOpenAI = async () => {\r\n    if (!nombreProfesor.trim() || !institucion.trim() || !gradoPlan.trim() || !materia.trim() || !trimestre.trim()) {\r\n      alert('Por favor completa todos los campos');\r\n      return;\r\n    }\r\n\r\n    setGenerandoPlan(true);\r\n\r\n    try {\r\n      const BACKEND_URL = 'https://bringo-edu-backend-2.onrender.com/api/generate-plan';\r\n\r\n      const response = await fetch(BACKEND_URL, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          nombreProfesor,\r\n          institucion,\r\n          gradoPlan,\r\n          materia,\r\n          trimestre,\r\n          incluirDesarrolloClases: true\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json().catch(() => ({ error: 'Error desconocido' }));\r\n        throw new Error(errorData.error || `Error ${response.status} del servidor`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      \r\n      if (!data.contenidos || !Array.isArray(data.contenidos) || data.contenidos.length === 0) {\r\n        alert('El servicio de IA no generó contenido. Intenta nuevamente.');\r\n        return;\r\n      }\r\n      \r\n      setPlanGenerado({\r\n        ...data,\r\n        fecha: data.fecha || new Date().toLocaleDateString('es-PA'),\r\n        generadoPorIA: true\r\n      });\r\n\r\n    } catch (error) {\r\n      console.error('❌ Error al generar plan:', error);\r\n      alert(`Error al generar el plan: ${error.message}`);\r\n    } finally {\r\n      setGenerandoPlan(false);\r\n    }\r\n  };\r\n\r\n  // FUNCIÓN MEJORADA: Descargar plan trimestral con múltiples formatos\r\n  const descargarPlan = (formato = 'txt') => {\r\n    if (!planGenerado) return;\r\n\r\n    let contenido = `PLAN TRIMESTRAL - BRINGO EDU\\n`;\r\n    contenido += `${'='.repeat(80)}\\n\\n`;\r\n    \r\n    contenido += `INFORMACIÓN GENERAL\\n`;\r\n    contenido += `-`.repeat(80) + `\\n`;\r\n    contenido += `Profesor: ${planGenerado.docente || planGenerado.profesor || nombreProfesor}\\n`;\r\n    contenido += `Institución: ${planGenerado.institucion}\\n`;\r\n    contenido += `Grado: ${planGenerado.grado || gradoPlan}\\n`;\r\n    contenido += `Asignatura: ${planGenerado.asignatura || planGenerado.materia || materia}\\n`;\r\n    contenido += `Trimestre: ${planGenerado.trimestre}\\n`;\r\n    contenido += `Año Escolar: ${planGenerado.anioEscolar || new Date().getFullYear()}\\n`;\r\n    contenido += `Duración: ${planGenerado.duracionSemanas || '10-12'} semanas\\n`;\r\n    contenido += `Fecha de generación: ${planGenerado.fecha || new Date().toLocaleDateString('es-PA')}\\n\\n`;\r\n\r\n    if (planGenerado.contenidos && planGenerado.contenidos.length > 0) {\r\n      contenido += `CONTENIDOS DEL TRIMESTRE\\n`;\r\n      contenido += `-`.repeat(80) + `\\n`;\r\n      planGenerado.contenidos.forEach((cont, i) => {\r\n        contenido += `${i + 1}. ${cont}\\n`;\r\n      });\r\n      contenido += `\\n`;\r\n    }\r\n\r\n    // Desarrollo del Contenido para Clases\r\n    if (planGenerado.desarrolloClases && Object.keys(planGenerado.desarrolloClases).length > 0) {\r\n      contenido += `DESARROLLO DEL CONTENIDO PARA CLASES\\n`;\r\n      contenido += `-`.repeat(80) + `\\n`;\r\n      Object.entries(planGenerado.desarrolloClases).forEach(([contenidoKey, desarrollo]) => {\r\n        contenido += `\\n📝 ${contenidoKey}:\\n`;\r\n        contenido += `Duración: ${desarrollo.duracion || '3 sesiones de 45 minutos'}\\n\\n`;\r\n        \r\n        if (desarrollo.objetivos && desarrollo.objetivos.length > 0) {\r\n          contenido += `Objetivos de Aprendizaje:\\n`;\r\n          desarrollo.objetivos.forEach(objetivo => {\r\n            contenido += `- ${objetivo}\\n`;\r\n          });\r\n          contenido += `\\n`;\r\n        }\r\n\r\n        if (desarrollo.materiales && desarrollo.materiales.length > 0) {\r\n          contenido += `Materiales necesarios:\\n`;\r\n          desarrollo.materiales.forEach(material => {\r\n            contenido += `- ${material}\\n`;\r\n          });\r\n          contenido += `\\n`;\r\n        }\r\n\r\n        if (desarrollo.fases && desarrollo.fases.length > 0) {\r\n          contenido += `Fases de la actividad:\\n`;\r\n          desarrollo.fases.forEach((fase, index) => {\r\n            contenido += `\\nSESIÓN ${index + 1} - ${fase.titulo || 'Desarrollo'}\\n`;\r\n            if (fase.actividades) {\r\n              fase.actividades.forEach(actividad => {\r\n                contenido += `${actividad.tiempo}: ${actividad.descripcion}\\n`;\r\n              });\r\n            }\r\n          });\r\n          contenido += `\\n`;\r\n        }\r\n        contenido += `-`.repeat(40) + `\\n`;\r\n      });\r\n    }\r\n\r\n    if (planGenerado.competencias && planGenerado.competencias.length > 0) {\r\n      contenido += `COMPETENCIAS A DESARROLLAR\\n`;\r\n      contenido += `-`.repeat(80) + `\\n`;\r\n      planGenerado.competencias.forEach((comp, i) => {\r\n        contenido += `${i + 1}. ${comp}\\n`;\r\n      });\r\n      contenido += `\\n`;\r\n    }\r\n\r\n    if (planGenerado.indicadoresLogro && planGenerado.indicadoresLogro.length > 0) {\r\n      contenido += `INDICADORES DE LOGRO\\n`;\r\n      contenido += `-`.repeat(80) + `\\n`;\r\n      planGenerado.indicadoresLogro.forEach((ind, i) => {\r\n        contenido += `• ${ind}\\n`;\r\n      });\r\n      contenido += `\\n`;\r\n    }\r\n\r\n    if (planGenerado.metodologia) {\r\n      contenido += `ESTRATEGIAS METODOLÓGICAS\\n`;\r\n      contenido += `-`.repeat(80) + `\\n`;\r\n      contenido += `${planGenerado.metodologia}\\n\\n`;\r\n    }\r\n\r\n    if (planGenerado.recursos && planGenerado.recursos.length > 0) {\r\n      contenido += `RECURSOS EDUCATIVOS\\n`;\r\n      contenido += `-`.repeat(80) + `\\n`;\r\n      planGenerado.recursos.forEach((rec, i) => {\r\n        contenido += `• ${rec}\\n`;\r\n      });\r\n      contenido += `\\n`;\r\n    }\r\n\r\n    if (planGenerado.evaluacion && Array.isArray(planGenerado.evaluacion) && planGenerado.evaluacion.length > 0) {\r\n      contenido += `INSTRUMENTOS DE EVALUACIÓN\\n`;\r\n      contenido += `-`.repeat(80) + `\\n`;\r\n      planGenerado.evaluacion.forEach((evalItem, i) => {\r\n        contenido += `• ${evalItem}\\n`;\r\n      });\r\n      contenido += `\\n`;\r\n    }\r\n   \r\n    if (planGenerado.adaptaciones && planGenerado.adaptaciones.length > 0) {\r\n      contenido += `ADAPTACIONES CURRICULARES\\n`;\r\n      contenido += `-`.repeat(80) + `\\n`;\r\n      planGenerado.adaptaciones.forEach((adap, i) => {\r\n        contenido += `• ${adap}\\n`;\r\n      });\r\n      contenido += `\\n`;\r\n    }\r\n\r\n    if (planGenerado.observaciones) {\r\n      contenido += `OBSERVACIONES\\n`;\r\n      contenido += `-`.repeat(80) + `\\n`;\r\n      contenido += `${planGenerado.observaciones}\\n\\n`;\r\n    }\r\n\r\n    contenido += `\\n${'='.repeat(80)}\\n`;\r\n    contenido += `Generado con Bringo Edu - Asistente Inteligente para Profesores\\n`;\r\n    contenido += `Fecha: ${new Date().toLocaleDateString('es-PA')}\\n`;\r\n\r\n    const elemento = document.createElement('a');\r\n    const archivo = new Blob([contenido], { type: 'text/plain;charset=utf-8' });\r\n    elemento.href = URL.createObjectURL(archivo);\r\n    elemento.download = `Plan_Trimestral_${planGenerado.asignatura || materia}_${planGenerado.trimestre.replace(/\\s+/g, '_')}.txt`;\r\n    document.body.appendChild(elemento);\r\n    elemento.click();\r\n    document.body.removeChild(elemento);\r\n  };\r\n\r\n  // FUNCIÓN MEJORADA: Agregar clase con nuevos campos\r\n  const agregarClase = async () => {\r\n    if (!usuario) {\r\n      alert('Debes iniciar sesión para crear clases');\r\n      setMostrarLogin(true);\r\n      return;\r\n    }\r\n\r\n    if (!nombreClase.trim() || !grado.trim() || !seccion.trim() || !nombreProfesorClase.trim() || !institucionClase.trim()) {\r\n      alert('Por favor completa todos los campos');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      const nuevaClase = {\r\n        nombre: `${nombreClase} ${grado}${seccion}`,\r\n        grado,\r\n        seccion,\r\n        materia: nombreClase,\r\n        profesor: nombreProfesorClase,\r\n        institucion: institucionClase,\r\n        estudiantes: [],\r\n        userId: usuario.uid,\r\n        fechaCreacion: new Date().toISOString()\r\n      };\r\n      \r\n      const docRef = await addDoc(collection(db, 'clases'), nuevaClase);\r\n      setClases([...clases, { id: docRef.id, ...nuevaClase }]);\r\n      setNombreClase('');\r\n      setGrado('');\r\n      setSeccion('');\r\n      setNombreProfesorClase('');\r\n      setInstitucionClase('');\r\n      \r\n    } catch (error) {\r\n      console.error('❌ Error agregando clase:', error);\r\n      alert(`Error al crear la clase: ${error.message}`);\r\n    }\r\n  };\r\n\r\n  const eliminarClase = async (id) => {\r\n    if (window.confirm('¿Estás seguro de eliminar esta clase?')) {\r\n      try {\r\n        await deleteDoc(doc(db, 'clases', id));\r\n        setClases(clases.filter(c => c.id !== id));\r\n        if (claseSeleccionada?.id === id) {\r\n          setClaseSeleccionada(null);\r\n          setView('home');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error eliminando clase:', error);\r\n        alert('Error al eliminar la clase');\r\n      }\r\n    }\r\n  };\r\n\r\n  const seleccionarClase = (clase) => {\r\n    if (!usuario) {\r\n      alert('Debes iniciar sesión para acceder a las clases');\r\n      setMostrarLogin(true);\r\n      return;\r\n    }\r\n    \r\n    setClaseSeleccionada(clase);\r\n    setEstudiantes(clase.estudiantes || []);\r\n    setView('clase');\r\n  };\r\n\r\n  // FUNCIÓN MEJORADA: Agregar estudiante\r\n  const agregarEstudiante = async () => {\r\n    if (!nombreEstudiante.trim()) {\r\n      alert('Ingresa el nombre del estudiante');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      const nuevoEstudiante = {\r\n        id: Date.now().toString(),\r\n        nombre: nombreEstudiante,\r\n        notasDiarias: [],\r\n        apreciacion: [],\r\n        examen: [],\r\n        asistencia: {}\r\n      };\r\n      \r\n      const nuevosEstudiantes = [...estudiantes, nuevoEstudiante];\r\n      setEstudiantes(nuevosEstudiantes);\r\n      \r\n      // Actualizar en Firestore\r\n      await updateDoc(doc(db, 'clases', claseSeleccionada.id), {\r\n        estudiantes: nuevosEstudiantes\r\n      });\r\n      \r\n      // Actualizar estado local\r\n      const clasesActualizadas = clases.map(c => \r\n        c.id === claseSeleccionada.id \r\n          ? { ...c, estudiantes: nuevosEstudiantes }\r\n          : c\r\n      );\r\n      setClases(clasesActualizadas);\r\n      setNombreEstudiante('');\r\n    } catch (error) {\r\n      console.error('Error agregando estudiante:', error);\r\n      alert('Error al agregar estudiante');\r\n    }\r\n  };\r\n\r\n  const marcarAsistencia = async (estudianteId, fecha, estado) => {\r\n    try {\r\n      const nuevosEstudiantes = estudiantes.map(e => {\r\n        if (e.id === estudianteId) {\r\n          return {\r\n            ...e,\r\n            asistencia: {\r\n              ...e.asistencia,\r\n              [fecha]: estado\r\n            }\r\n          };\r\n        }\r\n        return e;\r\n      });\r\n      setEstudiantes(nuevosEstudiantes);\r\n      \r\n      // Actualizar en Firestore\r\n      await updateDoc(doc(db, 'clases', claseSeleccionada.id), {\r\n        estudiantes: nuevosEstudiantes\r\n      });\r\n      \r\n      // Actualizar estado local\r\n      const clasesActualizadas = clases.map(c => \r\n        c.id === claseSeleccionada.id \r\n          ? { ...c, estudiantes: nuevosEstudiantes }\r\n          : c\r\n      );\r\n      setClases(clasesActualizadas);\r\n    } catch (error) {\r\n      console.error('Error marcando asistencia:', error);\r\n    }\r\n  };\r\n\r\n  // FUNCIÓN CORREGIDA: Agregar nota - AHORA FUNCIONA CORRECTAMENTE\r\n  const agregarNota = async (estudianteId, seccion, valor = '', fecha = new Date().toISOString().split('T')[0]) => {\r\n    try {\r\n      const nuevosEstudiantes = estudiantes.map(e => {\r\n        if (e.id === estudianteId) {\r\n          const nuevaNota = {\r\n            valor: valor ? parseFloat(valor) : '',\r\n            fecha: fecha\r\n          };\r\n          return {\r\n            ...e,\r\n            [seccion]: [...e[seccion], nuevaNota]\r\n          };\r\n        }\r\n        return e;\r\n      });\r\n      setEstudiantes(nuevosEstudiantes);\r\n      \r\n      // Actualizar en Firestore\r\n      await updateDoc(doc(db, 'clases', claseSeleccionada.id), {\r\n        estudiantes: nuevosEstudiantes\r\n      });\r\n      \r\n      // Actualizar estado local\r\n      const clasesActualizadas = clases.map(c => \r\n        c.id === claseSeleccionada.id \r\n          ? { ...c, estudiantes: nuevosEstudiantes }\r\n          : c\r\n      );\r\n      setClases(clasesActualizadas);\r\n    } catch (error) {\r\n      console.error('Error agregando nota:', error);\r\n      alert('Error al agregar nota');\r\n    }\r\n  };\r\n\r\n  const actualizarNota = async (estudianteId, seccion, indice, campo, valor) => {\r\n    try {\r\n      const nuevosEstudiantes = estudiantes.map(e => {\r\n        if (e.id === estudianteId) {\r\n          const nuevasNotas = [...e[seccion]];\r\n          nuevasNotas[indice] = { ...nuevasNotas[indice], [campo]: valor };\r\n          return {\r\n            ...e,\r\n            [seccion]: nuevasNotas\r\n          };\r\n        }\r\n        return e;\r\n      });\r\n      setEstudiantes(nuevosEstudiantes);\r\n      \r\n      // Actualizar en Firestore\r\n      await updateDoc(doc(db, 'clases', claseSeleccionada.id), {\r\n        estudiantes: nuevosEstudiantes\r\n      });\r\n      \r\n      // Actualizar estado local\r\n      const clasesActualizadas = clases.map(c => \r\n        c.id === claseSeleccionada.id \r\n          ? { ...c, estudiantes: nuevosEstudiantes }\r\n          : c\r\n      );\r\n      setClases(clasesActualizadas);\r\n    } catch (error) {\r\n      console.error('Error actualizando nota:', error);\r\n    }\r\n  };\r\n\r\n  const eliminarNota = async (estudianteId, seccion, indice) => {\r\n    try {\r\n      const nuevosEstudiantes = estudiantes.map(e => {\r\n        if (e.id === estudianteId) {\r\n          const nuevasNotas = e[seccion].filter((_, i) => i !== indice);\r\n          return {\r\n            ...e,\r\n            [seccion]: nuevasNotas\r\n          };\r\n        }\r\n        return e;\r\n      });\r\n      setEstudiantes(nuevosEstudiantes);\r\n      \r\n      // Actualizar en Firestore\r\n      await updateDoc(doc(db, 'clases', claseSeleccionada.id), {\r\n        estudiantes: nuevosEstudiantes\r\n      });\r\n      \r\n      // Actualizar estado local\r\n      const clasesActualizadas = clases.map(c => \r\n        c.id === claseSeleccionada.id \r\n          ? { ...c, estudiantes: nuevosEstudiantes }\r\n          : c\r\n      );\r\n      setClases(clasesActualizadas);\r\n    } catch (error) {\r\n      console.error('Error eliminando nota:', error);\r\n    }\r\n  };\r\n\r\n  const eliminarEstudiante = async (id) => {\r\n    try {\r\n      const nuevosEstudiantes = estudiantes.filter(e => e.id !== id);\r\n      setEstudiantes(nuevosEstudiantes);\r\n      \r\n      // Actualizar en Firestore\r\n      await updateDoc(doc(db, 'clases', claseSeleccionada.id), {\r\n        estudiantes: nuevosEstudiantes\r\n      });\r\n      \r\n      // Actualizar estado local\r\n      const clasesActualizadas = clases.map(c => \r\n        c.id === claseSeleccionada.id \r\n          ? { ...c, estudiantes: nuevosEstudiantes }\r\n          : c\r\n      );\r\n      setClases(clasesActualizadas);\r\n    } catch (error) {\r\n      console.error('Error eliminando estudiante:', error);\r\n      alert('Error al eliminar estudiante');\r\n    }\r\n  };\r\n\r\n  const contarAsistencias = (estudiante) => {\r\n    const registros = estudiante.asistencia || {};\r\n    const presente = Object.values(registros).filter(v => v === 'presente').length;\r\n    const ausente = Object.values(registros).filter(v => v === 'ausente').length;\r\n    const tardanza = Object.values(registros).filter(v => v === 'tardanza').length;\r\n    return { presente, ausente, tardanza };\r\n  };\r\n\r\n  const calcularTotalSeccion = (notas) => {\r\n    if (!notas || notas.length === 0) return 0;\r\n    const numeros = notas.map(n => {\r\n      const valor = typeof n === 'object' ? parseFloat(n.valor) : parseFloat(n);\r\n      return isNaN(valor) ? 0 : valor;\r\n    }).filter(v => v > 0);\r\n    if (numeros.length === 0) return 0;\r\n    return (numeros.reduce((a, b) => a + b, 0) / numeros.length).toFixed(2);\r\n  };\r\n\r\n  const calcularPromedioFinal = (estudiante) => {\r\n    const totalDiarias = parseFloat(calcularTotalSeccion(estudiante.notasDiarias));\r\n    const totalApreciacion = parseFloat(calcularTotalSeccion(estudiante.apreciacion));\r\n    const totalExamen = parseFloat(calcularTotalSeccion(estudiante.examen));\r\n    \r\n    const totales = [totalDiarias, totalApreciacion, totalExamen].filter(t => t > 0);\r\n    if (totales.length === 0) return 0;\r\n    \r\n    return ((totalDiarias + totalApreciacion + totalExamen) / 3).toFixed(2);\r\n  };\r\n\r\n  const toggleExpansion = (estudianteId) => {\r\n    setExpandido(prev => ({\r\n      ...prev,\r\n      [estudianteId]: !prev[estudianteId]\r\n    }));\r\n  };\r\n\r\n  // FUNCIÓN CORREGIDA: Buscar y redirigir estudiante - AHORA EN HOME\r\n  const buscarYRedirigirEstudiante = (estudiante) => {\r\n    // Si estamos en home, vamos a notas\r\n    if (view === 'home') {\r\n      setView('notas');\r\n    }\r\n    \r\n    // Expandir la sección del estudiante\r\n    setExpandido(prev => ({\r\n      ...prev,\r\n      [estudiante.id]: true\r\n    }));\r\n    \r\n    // Scroll a la sección del estudiante\r\n    setTimeout(() => {\r\n      const elemento = document.getElementById(`estudiante-${estudiante.id}`);\r\n      if (elemento) {\r\n        elemento.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n        // Resaltar temporalmente\r\n        elemento.classList.add('bg-yellow-100');\r\n        setTimeout(() => {\r\n          elemento.classList.remove('bg-yellow-100');\r\n        }, 2000);\r\n      }\r\n    }, 500);\r\n    \r\n    setBusquedaEstudiante('');\r\n  };\r\n\r\n  const estudiantesEnRiesgo = estudiantes.filter(e => parseFloat(calcularPromedioFinal(e)) < 3.0 && parseFloat(calcularPromedioFinal(e)) > 0);\r\n\r\n  const promedioGeneral = () => {\r\n    const promedios = estudiantes.map(e => parseFloat(calcularPromedioFinal(e))).filter(p => p > 0);\r\n    if (promedios.length === 0) return 0;\r\n    return (promedios.reduce((a, b) => a + b, 0) / promedios.length).toFixed(1);\r\n  };\r\n\r\n  // FUNCIONES PARA LA VISTA DE PROGRESO\r\n  const obtenerRankingEstudiantes = () => {\r\n    return estudiantes\r\n      .map(estudiante => ({\r\n        ...estudiante,\r\n        promedio: parseFloat(calcularPromedioFinal(estudiante))\r\n      }))\r\n      .filter(e => e.promedio > 0)\r\n      .sort((a, b) => b.promedio - a.promedio)\r\n      .slice(0, 5); // Top 5\r\n  };\r\n\r\n  // FUNCIÓN MEJORADA: Exportar datos de progreso\r\n  const exportarProgreso = (formato) => {\r\n    const datosProgreso = {\r\n      clase: claseSeleccionada?.nombre,\r\n      profesor: claseSeleccionada?.profesor || nombreProfesorClase,\r\n      institucion: claseSeleccionada?.institucion || institucionClase,\r\n      fecha: new Date().toLocaleDateString('es-PA'),\r\n      promedioGeneral: promedioGeneral(),\r\n      totalEstudiantes: estudiantes.length,\r\n      estudiantesEnRiesgo: estudiantesEnRiesgo.length,\r\n      ranking: obtenerRankingEstudiantes(),\r\n      distribucion: calcularDistribucionNotas()\r\n    };\r\n\r\n    const nombreArchivo = `Tablero_Progreso_${claseSeleccionada?.nombre.replace(/\\s+/g, '_')}`;\r\n\r\n    switch (formato) {\r\n      case 'excel':\r\n        exportarAExcel(JSON.stringify(datosProgreso), nombreArchivo);\r\n        break;\r\n      case 'pdf':\r\n        exportarAPDF(JSON.stringify(datosProgreso), nombreArchivo);\r\n        break;\r\n      case 'word':\r\n        exportarAWord(JSON.stringify(datosProgreso), nombreArchivo);\r\n        break;\r\n      case 'drive':\r\n        subirAGoogleDrive(JSON.stringify(datosProgreso), nombreArchivo);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n\r\n  const calcularDistribucionNotas = () => {\r\n    const distribucion = {\r\n      excelente: 0, // 4.5 - 5.0\r\n      bueno: 0,     // 3.5 - 4.4\r\n      regular: 0,   // 3.0 - 3.4\r\n      riesgo: 0     // 0 - 2.9\r\n    };\r\n\r\n    estudiantes.forEach(estudiante => {\r\n      const promedio = parseFloat(calcularPromedioFinal(estudiante));\r\n      if (promedio >= 4.5) distribucion.excelente++;\r\n      else if (promedio >= 3.5) distribucion.bueno++;\r\n      else if (promedio >= 3.0) distribucion.regular++;\r\n      else if (promedio > 0) distribucion.riesgo++;\r\n    });\r\n\r\n    return distribucion;\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50\">\r\n      <ModalLogin\r\n        mostrarLogin={mostrarLogin}\r\n        setMostrarLogin={setMostrarLogin}\r\n        email={email}\r\n        setEmail={setEmail}\r\n        password={password}\r\n        setPassword={setPassword}\r\n        errorAuth={errorAuth}\r\n        cargandoAuth={cargandoAuth}\r\n        iniciarSesion={iniciarSesion}\r\n        limpiarFormulariosAuth={limpiarFormulariosAuth}\r\n        setMostrarRegistro={setMostrarRegistro}\r\n      />\r\n\r\n      <ModalRegistro\r\n        mostrarRegistro={mostrarRegistro}\r\n        setMostrarRegistro={setMostrarRegistro}\r\n        email={email}\r\n        setEmail={setEmail}\r\n        password={password}\r\n        setPassword={setPassword}\r\n        nombreUsuario={nombreUsuario}\r\n        setNombreUsuario={setNombreUsuario}\r\n        confirmarPassword={confirmarPassword}\r\n        setConfirmarPassword={setConfirmarPassword}\r\n        errorAuth={errorAuth}\r\n        cargandoAuth={cargandoAuth}\r\n        registrarUsuario={registrarUsuario}\r\n        limpiarFormulariosAuth={limpiarFormulariosAuth}\r\n        setMostrarLogin={setMostrarLogin}\r\n      />\r\n\r\n      {/* HEADER MEJORADO */}\r\n      <header className=\"bg-gradient-to-r from-purple-600 to-blue-600 text-white shadow-lg\">\r\n        <div className=\"container mx-auto px-4 py-4 flex justify-between items-center\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <span className=\"text-4xl\">📚</span>\r\n            <div>\r\n              <h1 className=\"text-2xl font-bold\">Bringo Edu</h1>\r\n              <p className=\"text-sm text-purple-100\">Asistente Inteligente para Profesores</p>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex items-center gap-4\">\r\n            {usuario ? (\r\n              <>\r\n                <div className=\"text-right mr-4 hidden md:block\">\r\n                  <p className=\"font-semibold text-sm\">👋 Hola, {usuario.nombre}</p>\r\n                  <p className=\"text-xs text-purple-200\">{usuario.email}</p>\r\n                </div>\r\n                <button\r\n                  onClick={cerrarSesion}\r\n                  className=\"flex items-center gap-2 bg-red-500 hover:bg-red-600 px-4 py-2 rounded-lg transition font-semibold\"\r\n                >\r\n                  <LogOut className=\"w-4 h-4\" />\r\n                  <span className=\"hidden sm:inline\">Salir</span>\r\n                </button>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <button\r\n                  onClick={() => setMostrarLogin(true)}\r\n                  className=\"flex items-center gap-2 bg-white text-purple-600 hover:bg-purple-50 px-4 py-2 rounded-lg transition font-semibold\"\r\n                >\r\n                  <LogIn className=\"w-4 h-4\" />\r\n                  <span className=\"hidden sm:inline\">Iniciar Sesión</span>\r\n                </button>\r\n                <button\r\n                  onClick={() => setMostrarRegistro(true)}\r\n                  className=\"flex items-center gap-2 bg-green-500 hover:bg-green-600 px-4 py-2 rounded-lg transition font-semibold\"\r\n                >\r\n                  <User className=\"w-4 h-4\" />\r\n                  <span className=\"hidden sm:inline\">Registrarse</span>\r\n                </button>\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </header>\r\n\r\n      {/* NAVEGACIÓN MEJORADA CON NUEVA PESTAÑA */}\r\n      <nav className=\"bg-white shadow-md sticky top-0 z-40\">\r\n        <div className=\"container mx-auto px-4\">\r\n          <div className=\"flex gap-1 overflow-x-auto py-2\">\r\n            <button\r\n              onClick={() => setView('home')}\r\n              className={`flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap ${\r\n                view === 'home' ? 'bg-purple-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n              }`}\r\n            >\r\n              <Home className=\"w-5 h-5\" />\r\n              <span className=\"text-sm md:text-base\">Inicio</span>\r\n            </button>\r\n            \r\n            {usuario && claseSeleccionada && (\r\n              <>\r\n                <button\r\n                  onClick={() => setView('clase')}\r\n                  className={`flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap ${\r\n                    view === 'clase' ? 'bg-purple-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                  }`}\r\n                >\r\n                  <Users className=\"w-5 h-5\" />\r\n                  <span className=\"text-sm md:text-base\">Estudiantes</span>\r\n                </button>\r\n                <button\r\n                  onClick={() => setView('asistencia')}\r\n                  className={`flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap ${\r\n                    view === 'asistencia' ? 'bg-purple-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                  }`}\r\n                >\r\n                  <Calendar className=\"w-5 h-5\" />\r\n                  <span className=\"text-sm md:text-base\">Asistencia</span>\r\n                </button>\r\n                <button\r\n                  onClick={() => setView('notas')}\r\n                  className={`flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap ${\r\n                    view === 'notas' ? 'bg-purple-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                  }`}\r\n                >\r\n                  <ClipboardList className=\"w-5 h-5\" />\r\n                  <span className=\"text-sm md:text-base\">Notas</span>\r\n                </button>\r\n                <button\r\n                  onClick={() => setView('porcentajes')}\r\n                  className={`flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap ${\r\n                    view === 'porcentajes' ? 'bg-purple-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                  }`}\r\n                >\r\n                  <PieChart className=\"w-5 h-5\" />\r\n                  <span className=\"text-sm md:text-base\">Cuadro de %</span>\r\n                </button>\r\n                <button\r\n                  onClick={() => setView('progreso')}\r\n                  className={`flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap ${\r\n                    view === 'progreso' ? 'bg-purple-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n                  }`}\r\n                >\r\n                  <TrendingUp className=\"w-5 h-5\" />\r\n                  <span className=\"text-sm md:text-base\">Progreso</span>\r\n                </button>\r\n              </>\r\n            )}\r\n            \r\n            <button\r\n              onClick={() => setView('planificacion')}\r\n              className={`flex items-center gap-2 px-4 md:px-6 py-3 rounded-lg font-semibold transition whitespace-nowrap ${\r\n                view === 'planificacion' ? 'bg-purple-600 text-white' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n              }`}\r\n            >\r\n              <Sparkles className=\"w-5 h-5\" />\r\n              <span className=\"text-sm md:text-base\">Plan IA</span>\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      <main className=\"container mx-auto px-4 py-8\">\r\n        {view === 'home' && (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"bg-white rounded-2xl shadow-lg p-6 md:p-8\">\r\n              <h2 className=\"text-2xl md:text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3\">\r\n                <span className=\"text-4xl\">🏫</span>\r\n                Mis Clases\r\n              </h2>\r\n              \r\n              {/* ✅ BARRA DE BÚSQUEDA DE ESTUDIANTES EN HOME - MEJORADA */}\r\n              {usuario && claseSeleccionada && estudiantes.length > 0 && (\r\n                <BarraBusquedaEstudiantes\r\n                  estudiantes={estudiantes}\r\n                  onBuscarEstudiante={buscarYRedirigirEstudiante}\r\n                  busquedaEstudiante={busquedaEstudiante}\r\n                  setBusquedaEstudiante={setBusquedaEstudiante}\r\n                />\r\n              )}\r\n              \r\n              {!usuario && (\r\n                <div className=\"bg-yellow-50 border-2 border-yellow-200 rounded-xl p-6 mb-6\">\r\n                  <div className=\"flex items-start gap-4\">\r\n                    <AlertCircle className=\"w-6 h-6 text-yellow-600 flex-shrink-0 mt-1\" />\r\n                    <div>\r\n                      <h3 className=\"font-bold text-yellow-900 mb-2\">Inicia sesión para acceder</h3>\r\n                      <p className=\"text-yellow-800 mb-4\">\r\n                        Crea una cuenta o inicia sesión para gestionar tus clases, estudiantes y generar planes de estudio con IA.\r\n                      </p>\r\n                      <div className=\"flex gap-3 flex-wrap\">\r\n                        <button\r\n                          onClick={() => setMostrarLogin(true)}\r\n                          className=\"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition font-semibold\"\r\n                        >\r\n                          Iniciar Sesión\r\n                        </button>\r\n                        <button\r\n                          onClick={() => setMostrarRegistro(true)}\r\n                          className=\"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition font-semibold\"\r\n                        >\r\n                          Registrarse\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {usuario && (\r\n                <div className=\"bg-gradient-to-r from-purple-100 to-blue-100 rounded-xl p-6 mb-6\">\r\n                  <h3 className=\"text-xl font-bold text-gray-800 mb-4\">Crear Nueva Clase</h3>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Materia (ej: Matemáticas)\"\r\n                      value={nombreClase}\r\n                      onChange={(e) => setNombreClase(e.target.value)}\r\n                      className=\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                    />\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Grado (ej: 5to)\"\r\n                      value={grado}\r\n                      onChange={(e) => setGrado(e.target.value)}\r\n                      className=\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                    />\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Sección (ej: A)\"\r\n                      value={seccion}\r\n                      onChange={(e) => setSeccion(e.target.value)}\r\n                      className=\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                    />\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Nombre del Profesor\"\r\n                      value={nombreProfesorClase}\r\n                      onChange={(e) => setNombreProfesorClase(e.target.value)}\r\n                      className=\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                    />\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Institución Educativa\"\r\n                      value={institucionClase}\r\n                      onChange={(e) => setInstitucionClase(e.target.value)}\r\n                      className=\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                    />\r\n                    <button\r\n                      onClick={agregarClase}\r\n                      className=\"bg-gradient-to-r from-purple-600 to-blue-600 text-white px-6 py-3 rounded-lg hover:from-purple-700 hover:to-blue-700 transition font-bold flex items-center justify-center gap-2\"\r\n                    >\r\n                      <Plus className=\"w-5 h-5\" />\r\n                      Crear Clase\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                {clases.length === 0 && usuario && (\r\n                  <div className=\"col-span-full text-center py-12 text-gray-500\">\r\n                    <p className=\"text-lg\">No tienes clases creadas aún</p>\r\n                    <p className=\"text-sm mt-2\">Crea tu primera clase usando el formulario arriba</p>\r\n                  </div>\r\n                )}\r\n                \r\n                {clases.map(clase => (\r\n                  <div\r\n                    key={clase.id}\r\n                    className=\"bg-gradient-to-br from-purple-500 to-blue-600 rounded-xl shadow-lg p-6 text-white hover:shadow-2xl transition-all transform hover:scale-105 cursor-pointer\"\r\n                    onClick={() => seleccionarClase(clase)}\r\n                  >\r\n                    <div className=\"flex justify-between items-start mb-4\">\r\n                      <div>\r\n                        <h3 className=\"text-2xl font-bold mb-2\">{clase.nombre}</h3>\r\n                        <p className=\"text-purple-100\">{clase.estudiantes?.length || 0} estudiantes</p>\r\n                        <p className=\"text-purple-100 text-sm mt-1\">Prof: {clase.profesor}</p>\r\n                        <p className=\"text-purple-100 text-sm\">Inst: {clase.institucion}</p>\r\n                      </div>\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          eliminarClase(clase.id);\r\n                        }}\r\n                        className=\"bg-red-500 hover:bg-red-600 p-2 rounded-lg transition\"\r\n                      >\r\n                        <Trash2 className=\"w-5 h-5\" />\r\n                      </button>\r\n                    </div>\r\n                    <div className=\"mt-4 pt-4 border-t border-purple-400\">\r\n                      <p className=\"text-sm text-purple-100\">Click para gestionar</p>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {view === 'clase' && claseSeleccionada && (\r\n          <div className=\"bg-white rounded-2xl shadow-lg p-6 md:p-8\">\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6\">\r\n              <h2 className=\"text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-3\">\r\n                <Users className=\"w-8 h-8 text-purple-600\" />\r\n                {claseSeleccionada.nombre}\r\n              </h2>\r\n              <button\r\n                onClick={() => {\r\n                  setClaseSeleccionada(null);\r\n                  setView('home');\r\n                }}\r\n                className=\"bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg transition font-semibold\"\r\n              >\r\n                Volver\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"bg-gradient-to-r from-green-100 to-teal-100 rounded-xl p-6 mb-6\">\r\n              <h3 className=\"text-xl font-bold text-gray-800 mb-4\">Agregar Estudiante</h3>\r\n              <div className=\"flex flex-col md:flex-row gap-4\">\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Nombre completo del estudiante\"\r\n                  value={nombreEstudiante}\r\n                  onChange={(e) => setNombreEstudiante(e.target.value)}\r\n                  onKeyPress={(e) => e.key === 'Enter' && agregarEstudiante()}\r\n                  className=\"flex-1 px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500\"\r\n                />\r\n                <button\r\n                  onClick={agregarEstudiante}\r\n                  className=\"bg-gradient-to-r from-green-600 to-teal-600 text-white px-6 py-3 rounded-lg hover:from-green-700 hover:to-teal-700 transition font-bold flex items-center justify-center gap-2\"\r\n                >\r\n                  <Plus className=\"w-5 h-5\" />\r\n                  Agregar\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"space-y-4\">\r\n              {estudiantes.length === 0 && (\r\n                <div className=\"text-center py-12 text-gray-500\">\r\n                  <p className=\"text-lg\">No hay estudiantes en esta clase</p>\r\n                  <p className=\"text-sm mt-2\">Agrega tu primer estudiante usando el formulario arriba</p>\r\n                </div>\r\n              )}\r\n              \r\n              {estudiantes.map(estudiante => (\r\n                <div key={estudiante.id} className=\"bg-gray-50 rounded-xl p-6 hover:bg-gray-100 transition\">\r\n                  <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                      <div className=\"bg-purple-600 text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg\">\r\n                        {estudiante.nombre.charAt(0).toUpperCase()}\r\n                      </div>\r\n                      <div>\r\n                        <h4 className=\"text-xl font-bold text-gray-800\">{estudiante.nombre}</h4>\r\n                        <p className=\"text-sm text-gray-600\">\r\n                          Promedio: {calcularPromedioFinal(estudiante)}/5\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <button\r\n                      onClick={() => {\r\n                        if (window.confirm(`¿Eliminar a ${estudiante.nombre}?`)) {\r\n                          eliminarEstudiante(estudiante.id);\r\n                        }\r\n                      }}\r\n                      className=\"bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg transition mt-4 md:mt-0\"\r\n                    >\r\n                      <Trash2 className=\"w-5 h-5\" />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {view === 'asistencia' && claseSeleccionada && (\r\n          <div className=\"bg-white rounded-2xl shadow-lg p-6 md:p-8\">\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6\">\r\n              <h2 className=\"text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-3\">\r\n                <Calendar className=\"w-8 h-8 text-purple-600\" />\r\n                Asistencia - {claseSeleccionada.nombre}\r\n              </h2>\r\n              <div className=\"flex gap-4\">\r\n                <input\r\n                  type=\"date\"\r\n                  value={fechaActual}\r\n                  onChange={(e) => setFechaActual(e.target.value)}\r\n                  className=\"px-4 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                />\r\n                <OpcionesExportacion\r\n                  datos={JSON.stringify({\r\n                    clase: claseSeleccionada.nombre,\r\n                    profesor: claseSeleccionada.profesor,\r\n                    institucion: claseSeleccionada.institucion,\r\n                    fecha: fechaActual,\r\n                    estudiantes: estudiantes.map(e => ({\r\n                      nombre: e.nombre,\r\n                      asistencia: e.asistencia?.[fechaActual] || 'No registrada',\r\n                      historial: contarAsistencias(e)\r\n                    }))\r\n                  })}\r\n                  nombreArchivo={`Asistencia_${claseSeleccionada.nombre.replace(/\\s+/g, '_')}_${fechaActual}`}\r\n                />\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"space-y-4\">\r\n              {estudiantes.length === 0 && (\r\n                <div className=\"text-center py-12 text-gray-500\">\r\n                  <p className=\"text-lg\">No hay estudiantes en esta clase</p>\r\n                </div>\r\n              )}\r\n              \r\n              {estudiantes.map(estudiante => {\r\n                const asist = contarAsistencias(estudiante);\r\n                const estadoHoy = estudiante.asistencia?.[fechaActual];\r\n                \r\n                return (\r\n                  <div key={estudiante.id} className=\"bg-gray-50 rounded-xl p-6\">\r\n                    <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                      <div className=\"flex-1\">\r\n                        <h4 className=\"text-xl font-bold text-gray-800 mb-2\">{estudiante.nombre}</h4>\r\n                        <div className=\"flex gap-4 text-sm\">\r\n                          <span className=\"text-green-600 font-semibold\">✓ {asist.presente}P</span>\r\n                          <span className=\"text-yellow-600 font-semibold\">⏰ {asist.tardanza}T</span>\r\n                          <span className=\"text-red-600 font-semibold\">✗ {asist.ausente}A</span>\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      <div className=\"flex gap-2 flex-wrap mt-4 md:mt-0\">\r\n                        <button\r\n                          onClick={() => marcarAsistencia(estudiante.id, fechaActual, 'presente')}\r\n                          className={`px-4 md:px-6 py-3 rounded-lg font-semibold transition text-sm md:text-base ${\r\n                            estadoHoy === 'presente'\r\n                              ? 'bg-green-600 text-white'\r\n                              : 'bg-green-100 text-green-700 hover:bg-green-200'\r\n                          }`}\r\n                        >\r\n                          Presente\r\n                        </button>\r\n                        <button\r\n                          onClick={() => marcarAsistencia(estudiante.id, fechaActual, 'tardanza')}\r\n                          className={`px-4 md:px-6 py-3 rounded-lg font-semibold transition text-sm md:text-base ${\r\n                            estadoHoy === 'tardanza'\r\n                              ? 'bg-yellow-600 text-white'\r\n                              : 'bg-yellow-100 text-yellow-700 hover:bg-yellow-200'\r\n                          }`}\r\n                        >\r\n                          Tardanza\r\n                        </button>\r\n                        <button\r\n                          onClick={() => marcarAsistencia(estudiante.id, fechaActual, 'ausente')}\r\n                          className={`px-4 md:px-6 py-3 rounded-lg font-semibold transition text-sm md:text-base ${\r\n                            estadoHoy === 'ausente'\r\n                              ? 'bg-red-600 text-white'\r\n                              : 'bg-red-100 text-red-700 hover:bg-red-200'\r\n                          }`}\r\n                        >\r\n                          Ausente\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {view === 'notas' && claseSeleccionada && (\r\n          <div className=\"bg-white rounded-2xl shadow-lg p-6 md:p-8\">\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6\">\r\n              <h2 className=\"text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-3\">\r\n                <ClipboardList className=\"w-8 h-8 text-purple-600\" />\r\n                Notas - {claseSeleccionada.nombre}\r\n              </h2>\r\n              <div className=\"flex gap-4 flex-wrap\">\r\n                <div className=\"bg-purple-100 px-4 md:px-6 py-3 rounded-lg\">\r\n                  <span className=\"text-xs md:text-sm text-purple-600 font-semibold\">Promedio:</span>\r\n                  <span className=\"ml-2 text-xl md:text-2xl font-bold text-purple-800\">{promedioGeneral()}/5</span>\r\n                </div>\r\n                             {/* FORZAR INCLUSIÓN DE FUNCIONES EN EL BUILD */}\r\n            {(() => {\r\n              const funcionesForzadas = [\r\n                exportarAExcel,\r\n                exportarAPDF,\r\n                exportarAWord,\r\n                generarBlobPorFormato,\r\n                subirAGoogleDrive,\r\n                OpcionesExportacion\r\n              ];\r\n              console.log('Funciones incluidas en build:', funcionesForzadas.length);\r\n              return null;\r\n            })()}\r\n\r\n            <OpcionesExportacion\r\n              datos={JSON.stringify({\r\n                clase: claseSeleccionada.nombre,\r\n                profesor: claseSeleccionada.profesor,\r\n                institucion: claseSeleccionada.institucion,\r\n                fecha: new Date().toLocaleDateString('es-PA'),\r\n                promedioGeneral: promedioGeneral(),\r\n                estudiantes: estudiantes.map(e => ({\r\n                  nombre: e.nombre,\r\n                  notasDiarias: e.notasDiarias,\r\n                  apreciacion: e.apreciacion,\r\n                  examen: e.examen,\r\n                  promedioFinal: calcularPromedioFinal(e)\r\n                }))\r\n              })}\r\n              nombreArchivo={`Notas_${claseSeleccionada.nombre.replace(/\\s+/g, '_')}`}\r\n            />\r\n             </div>\r\n            </div>\r\n            \r\n            {estudiantesEnRiesgo.length > 0 && (\r\n              <div className=\"bg-red-50 border-2 border-red-200 rounded-xl p-6 mb-6\">\r\n                <div className=\"flex items-start gap-4\">\r\n                  <AlertCircle className=\"w-6 h-6 text-red-600 flex-shrink-0 mt-1\" />\r\n                  <div>\r\n                    <h3 className=\"font-bold text-red-900 mb-2\">⚠️ Estudiantes en Riesgo ({estudiantesEnRiesgo.length})</h3>\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                      {estudiantesEnRiesgo.map(e => (\r\n                        <span key={e.id} className=\"bg-red-200 text-red-800 px-3 py-1 rounded-lg text-sm font-semibold\">\r\n                          {e.nombre}: {calcularPromedioFinal(e)}/5\r\n                        </span>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            {/* CUADRÍCULA DE NOTAS RÁPIDAS - CORREGIDA */}\r\n            {estudiantes.length > 0 && (\r\n              <div className=\"bg-white rounded-xl shadow-lg p-6 mb-6 border-2 border-purple-200\">\r\n                <h3 className=\"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2\">\r\n                  📊 Registro Rápido de Notas - {new Date().toLocaleDateString('es-PA')}\r\n                </h3>\r\n                \r\n                <div className=\"overflow-x-auto\">\r\n                  <table className=\"w-full min-w-full\">\r\n                    <thead className=\"bg-purple-600 text-white\">\r\n                      <tr>\r\n                        <th className=\"px-4 py-3 text-left font-semibold\">Estudiante</th>\r\n                        <th className=\"px-4 py-3 text-center font-semibold\">Notas Diarias</th>\r\n                        <th className=\"px-4 py-3 text-center font-semibold\">Apreciación</th>\r\n                        <th className=\"px-4 py-3 text-center font-semibold\">Examen</th>\r\n                        <th className=\"px-4 py-3 text-center font-semibold\">Promedio</th>\r\n                        <th className=\"px-4 py-3 text-center font-semibold\">Compartir</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {estudiantes.map((estudiante) => (\r\n                        <FilaNotasRapidas\r\n                          key={estudiante.id}\r\n                          estudiante={estudiante}\r\n                          onAgregarNota={agregarNota}\r\n                          calcularPromedioFinal={calcularPromedioFinal}\r\n                          claseSeleccionada={claseSeleccionada}\r\n                          usuario={usuario}\r\n                          actualizarNota={actualizarNota}\r\n                        />\r\n                      ))}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n                <p className=\"text-sm text-gray-600 mt-3 text-center\">\r\n                  💡 Ingresa las notas (0-5) y presiona \"+\" para agregar. Las notas se guardan automáticamente.\r\n                </p>\r\n              </div>\r\n            )}\r\n            \r\n            {estudiantes.length === 0 && (\r\n              <div className=\"text-center py-12 text-gray-500\">\r\n                <p className=\"text-lg\">No hay estudiantes en esta clase</p>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"space-y-6\">\r\n              {estudiantes.map(estudiante => (\r\n                <div key={estudiante.id} id={`estudiante-${estudiante.id}`} className=\"border-2 border-gray-200 rounded-xl overflow-hidden transition-all duration-300\">\r\n                  <div\r\n                    onClick={() => toggleExpansion(estudiante.id)}\r\n                    className=\"bg-gradient-to-r from-purple-100 to-blue-100 p-6 cursor-pointer hover:from-purple-200 hover:to-blue-200 transition\"\r\n                  >\r\n                    <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n                      <div className=\"flex items-center gap-4 flex-1\">\r\n                        <div className=\"bg-purple-600 text-white w-12 h-12 rounded-full flex items-center justify-center font-bold text-lg flex-shrink-0\">\r\n                          {estudiante.nombre.charAt(0).toUpperCase()}\r\n                        </div>\r\n                        <div className=\"flex-1\">\r\n                          <h4 className=\"text-xl font-bold text-gray-800\">{estudiante.nombre}</h4>\r\n                          <div className=\"flex flex-wrap gap-2 md:gap-4 mt-1 text-xs md:text-sm\">\r\n                            <span>Diarias: {calcularTotalSeccion(estudiante.notasDiarias)}</span>\r\n                            <span>Apreciación: {calcularTotalSeccion(estudiante.apreciacion)}</span>\r\n                            <span>Examen: {calcularTotalSeccion(estudiante.examen)}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"flex items-center gap-4 mt-4 md:mt-0\">\r\n                        <div className=\"text-right\">\r\n                          <p className=\"text-xs md:text-sm text-gray-600\">Promedio</p>\r\n                          <p className={`text-2xl md:text-3xl font-bold ${\r\n                            parseFloat(calcularPromedioFinal(estudiante)) >= 3.5 ? 'text-green-600' :\r\n                            parseFloat(calcularPromedioFinal(estudiante)) >= 3.0 ? 'text-yellow-600' :\r\n                            'text-red-600'\r\n                          }`}>\r\n                            {calcularPromedioFinal(estudiante)}/5\r\n                          </p>\r\n                        </div>\r\n                        {expandido[estudiante.id] ? (\r\n                          <ChevronUp className=\"w-6 h-6 text-gray-600\" />\r\n                        ) : (\r\n                          <ChevronDown className=\"w-6 h-6 text-gray-600\" />\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {expandido[estudiante.id] && (\r\n                    <div className=\"p-6 space-y-6\">\r\n                      <div>\r\n                        <div className=\"flex justify-between items-center mb-4\">\r\n                          <h5 className=\"font-bold text-lg text-gray-800\">📝 Notas Diarias</h5>\r\n                          <button\r\n                            onClick={() => agregarNota(estudiante.id, 'notasDiarias')}\r\n                            className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition text-sm font-semibold flex items-center gap-2\"\r\n                          >\r\n                            <Plus className=\"w-4 h-4\" />\r\n                            Agregar\r\n                          </button>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                          {estudiante.notasDiarias.map((nota, idx) => (\r\n                            <div key={idx} className=\"bg-gray-50 p-4 rounded-lg flex gap-3\">\r\n                              <input\r\n                                type=\"number\"\r\n                                step=\"0.1\"\r\n                                min=\"0\"\r\n                                max=\"5\"\r\n                                placeholder=\"Nota\"\r\n                                value={nota.valor || ''}\r\n                                onChange={(e) => actualizarNota(estudiante.id, 'notasDiarias', idx, 'valor', e.target.value)}\r\n                                className=\"flex-1 px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500\"\r\n                              />\r\n                              <input\r\n                                type=\"date\"\r\n                                value={nota.fecha || ''}\r\n                                onChange={(e) => actualizarNota(estudiante.id, 'notasDiarias', idx, 'fecha', e.target.value)}\r\n                                className=\"px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-blue-500\"\r\n                              />\r\n                              <button\r\n                                onClick={() => eliminarNota(estudiante.id, 'notasDiarias', idx)}\r\n                                className=\"bg-red-500 text-white p-2 rounded-lg hover:bg-red-600 transition\"\r\n                              >\r\n                                <Trash2 className=\"w-4 h-4\" />\r\n                              </button>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                        <div className=\"mt-2 text-right\">\r\n                          <span className=\"text-sm text-gray-600\">Promedio: </span>\r\n                          <span className=\"font-bold text-lg text-blue-600\">{calcularTotalSeccion(estudiante.notasDiarias)}/5</span>\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      <div>\r\n                        <div className=\"flex justify-between items-center mb-4\">\r\n                          <h5 className=\"font-bold text-lg text-gray-800\">⭐ Apreciación</h5>\r\n                          <button\r\n                            onClick={() => agregarNota(estudiante.id, 'apreciacion')}\r\n                            className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition text-sm font-semibold flex items-center gap-2\"\r\n                          >\r\n                            <Plus className=\"w-4 h-4\" />\r\n                            Agregar\r\n                          </button>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                          {estudiante.apreciacion.map((nota, idx) => (\r\n                            <div key={idx} className=\"bg-gray-50 p-4 rounded-lg flex gap-3\">\r\n                              <input\r\n                                type=\"number\"\r\n                                step=\"0.1\"\r\n                                min=\"0\"\r\n                                max=\"5\"\r\n                                placeholder=\"Nota\"\r\n                                value={nota.valor || ''}\r\n                                onChange={(e) => actualizarNota(estudiante.id, 'apreciacion', idx, 'valor', e.target.value)}\r\n                                className=\"flex-1 px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500\"\r\n                              />\r\n                              <input\r\n                                type=\"date\"\r\n                                value={nota.fecha || ''}\r\n                                onChange={(e) => actualizarNota(estudiante.id, 'apreciacion', idx, 'fecha', e.target.value)}\r\n                                className=\"px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-green-500\"\r\n                              />\r\n                              <button\r\n                                onClick={() => eliminarNota(estudiante.id, 'apreciacion', idx)}\r\n                                className=\"bg-red-500 text-white p-2 rounded-lg hover:bg-red-600 transition\"\r\n                              >\r\n                                <Trash2 className=\"w-4 h-4\" />\r\n                              </button>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                        <div className=\"mt-2 text-right\">\r\n                          <span className=\"text-sm text-gray-600\">Promedio: </span>\r\n                          <span className=\"font-bold text-lg text-green-600\">{calcularTotalSeccion(estudiante.apreciacion)}/5</span>\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      <div>\r\n                        <div className=\"flex justify-between items-center mb-4\">\r\n                          <h5 className=\"font-bold text-lg text-gray-800\">📋 Examen</h5>\r\n                          <button\r\n                            onClick={() => agregarNota(estudiante.id, 'examen')}\r\n                            className=\"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition text-sm font-semibold flex items-center gap-2\"\r\n                          >\r\n                            <Plus className=\"w-4 h-4\" />\r\n                            Agregar\r\n                          </button>\r\n                        </div>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                          {estudiante.examen.map((nota, idx) => (\r\n                            <div key={idx} className=\"bg-gray-50 p-4 rounded-lg flex gap-3\">\r\n                              <input\r\n                                type=\"number\"\r\n                                step=\"0.1\"\r\n                                min=\"0\"\r\n                                max=\"5\"\r\n                                placeholder=\"Nota\"\r\n                                value={nota.valor || ''}\r\n                                onChange={(e) => actualizarNota(estudiante.id, 'examen', idx, 'valor', e.target.value)}\r\n                                className=\"flex-1 px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                              />\r\n                              <input\r\n                                type=\"date\"\r\n                                value={nota.fecha || ''}\r\n                                onChange={(e) => actualizarNota(estudiante.id, 'examen', idx, 'fecha', e.target.value)}\r\n                                className=\"px-3 py-2 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                              />\r\n                              <button\r\n                                onClick={() => eliminarNota(estudiante.id, 'examen', idx)}\r\n                                className=\"bg-red-500 text-white p-2 rounded-lg hover:bg-red-600 transition\"\r\n                              >\r\n                                <Trash2 className=\"w-4 h-4\" />\r\n                              </button>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                        <div className=\"mt-2 text-right\">\r\n                          <span className=\"text-sm text-gray-600\">Promedio: </span>\r\n                          <span className=\"font-bold text-lg text-purple-600\">{calcularTotalSeccion(estudiante.examen)}/5</span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* NUEVA VISTA: CUADRO DE PORCENTAJES */}\r\n        {view === 'porcentajes' && claseSeleccionada && (\r\n          <CuadroPorcentajes />\r\n        )}\r\n\r\n        {/* VISTA DE PROGRESO MEJORADA */}\r\n        {view === 'progreso' && claseSeleccionada && (\r\n          <div className=\"bg-white rounded-2xl shadow-lg p-6 md:p-8\">\r\n            <div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8\">\r\n              <h2 className=\"text-2xl md:text-3xl font-bold text-gray-800 flex items-center gap-3\">\r\n                <TrendingUp className=\"w-8 h-8 text-purple-600\" />\r\n                Tablero de Progreso - {claseSeleccionada.nombre}\r\n              </h2>\r\n              <OpcionesExportacion\r\n                datos={JSON.stringify({\r\n                  clase: claseSeleccionada.nombre,\r\n                  profesor: claseSeleccionada.profesor,\r\n                  institucion: claseSeleccionada.institucion,\r\n                  fecha: new Date().toLocaleDateString('es-PA'),\r\n                  promedioGeneral: promedioGeneral(),\r\n                  totalEstudiantes: estudiantes.length,\r\n                  estudiantesEnRiesgo: estudiantesEnRiesgo.length,\r\n                  ranking: obtenerRankingEstudiantes(),\r\n                  distribucion: calcularDistribucionNotas()\r\n                })}\r\n                nombreArchivo={`Tablero_Progreso_${claseSeleccionada.nombre.replace(/\\s+/g, '_')}`}\r\n                onExportar={exportarProgreso}\r\n              />\r\n            </div>\r\n\r\n            {/* ESTADÍSTICAS GENERALES */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8\">\r\n              <div className=\"bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl p-6 text-center\">\r\n                <BarChart3 className=\"w-8 h-8 mx-auto mb-2\" />\r\n                <p className=\"text-sm opacity-90\">Promedio General</p>\r\n                <p className=\"text-3xl font-bold\">{promedioGeneral()}/5</p>\r\n              </div>\r\n              \r\n              <div className=\"bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl p-6 text-center\">\r\n                <Target className=\"w-8 h-8 mx-auto mb-2\" />\r\n                <p className=\"text-sm opacity-90\">Total Estudiantes</p>\r\n                <p className=\"text-3xl font-bold\">{estudiantes.length}</p>\r\n              </div>\r\n              \r\n              <div className=\"bg-gradient-to-r from-yellow-500 to-yellow-600 text-white rounded-xl p-6 text-center\">\r\n                <AlertTriangle className=\"w-8 h-8 mx-auto mb-2\" />\r\n                <p className=\"text-sm opacity-90\">En Riesgo</p>\r\n                <p className=\"text-3xl font-bold\">{estudiantesEnRiesgo.length}</p>\r\n              </div>\r\n              \r\n              <div className=\"bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl p-6 text-center\">\r\n                <Award className=\"w-8 h-8 mx-auto mb-2\" />\r\n                <p className=\"text-sm opacity-90\">Mejor Promedio</p>\r\n                <p className=\"text-3xl font-bold\">\r\n                  {estudiantes.length > 0 ? Math.max(...estudiantes.map(e => parseFloat(calcularPromedioFinal(e)))).toFixed(1) : 0}/5\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            {/* GRÁFICO DE DISTRIBUCIÓN Y RANKING */}\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8\">\r\n              <div className=\"bg-gray-50 rounded-xl p-6\">\r\n                <h3 className=\"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2\">\r\n                  <BarChart3 className=\"w-6 h-6 text-purple-600\" />\r\n                  Distribución de Rendimiento\r\n                </h3>\r\n                <DistribucionNotas \r\n                  estudiantes={estudiantes} \r\n                  calcularPromedioFinal={calcularPromedioFinal} \r\n                />\r\n              </div>\r\n              \r\n              <div className=\"bg-gray-50 rounded-xl p-6\">\r\n                <h3 className=\"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2\">\r\n                  <Award className=\"w-6 h-6 text-purple-600\" />\r\n                  Ranking de Estudiantes\r\n                </h3>\r\n                <div className=\"space-y-3\">\r\n                  {obtenerRankingEstudiantes().map((estudiante, index) => (\r\n                    <div key={estudiante.id} className=\"flex items-center justify-between bg-white p-4 rounded-lg border-2 border-gray-200\">\r\n                      <div className=\"flex items-center gap-3\">\r\n                        <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-white ${\r\n                          index === 0 ? 'bg-yellow-500' :\r\n                          index === 1 ? 'bg-gray-400' :\r\n                          index === 2 ? 'bg-orange-500' : 'bg-purple-500'\r\n                        }`}>\r\n                          {index + 1}\r\n                        </div>\r\n                        <div>\r\n                          <p className=\"font-semibold text-gray-800\">{estudiante.nombre}</p>\r\n                          <p className=\"text-sm text-gray-600\">\r\n                            {estudiante.notasDiarias.length + estudiante.apreciacion.length + estudiante.examen.length} notas\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"text-right\">\r\n                        <p className={`text-xl font-bold ${\r\n                          estudiante.promedio >= 4.5 ? 'text-green-600' :\r\n                          estudiante.promedio >= 3.5 ? 'text-blue-600' :\r\n                          estudiante.promedio >= 3.0 ? 'text-yellow-600' : 'text-red-600'\r\n                        }`}>\r\n                          {estudiante.promedio.toFixed(1)}/5\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                  {obtenerRankingEstudiantes().length === 0 && (\r\n                    <div className=\"text-center py-8 text-gray-500\">\r\n                      <p>No hay datos suficientes para ranking</p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* ALERTAS DE BAJO RENDIMIENTO */}\r\n            {estudiantesEnRiesgo.length > 0 && (\r\n              <div className=\"bg-red-50 border-2 border-red-200 rounded-xl p-6 mb-8\">\r\n                <h3 className=\"text-xl font-bold text-red-900 mb-4 flex items-center gap-2\">\r\n                  <AlertTriangle className=\"w-6 h-6 text-red-600\" />\r\n                  Alertas de Bajo Rendimiento ({estudiantesEnRiesgo.length})\r\n                </h3>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                  {estudiantesEnRiesgo.map(estudiante => {\r\n                    const asistencia = contarAsistencias(estudiante);\r\n                    return (\r\n                      <div key={estudiante.id} className=\"bg-white rounded-lg p-4 border-2 border-red-300\">\r\n                        <div className=\"flex items-center gap-3 mb-3\">\r\n                          <div className=\"bg-red-600 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold\">\r\n                            {estudiante.nombre.charAt(0).toUpperCase()}\r\n                          </div>\r\n                          <div>\r\n                            <p className=\"font-bold text-red-800\">{estudiante.nombre}</p>\r\n                            <p className=\"text-sm text-red-600\">Promedio: {calcularPromedioFinal(estudiante)}/5</p>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-600\">\r\n                          <p>Asistencia: {asistencia.presente}P {asistencia.tardanza}T {asistencia.ausente}A</p>\r\n                          <p>Total notas: {estudiante.notasDiarias.length + estudiante.apreciacion.length + estudiante.examen.length}</p>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* MÉTRICAS CONSOLIDADAS POR ESTUDIANTE */}\r\n            <div className=\"bg-gray-50 rounded-xl p-6\">\r\n              <h3 className=\"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2\">\r\n                <Users className=\"w-6 h-6 text-purple-600\" />\r\n                Métricas por Estudiante\r\n              </h3>\r\n              <div className=\"overflow-x-auto\">\r\n                <table className=\"w-full bg-white rounded-lg overflow-hidden\">\r\n                  <thead className=\"bg-purple-600 text-white\">\r\n                    <tr>\r\n                      <th className=\"px-4 py-3 text-left\">Estudiante</th>\r\n                      <th className=\"px-4 py-3 text-center\">Promedio</th>\r\n                      <th className=\"px-4 py-3 text-center\">Notas Diarias</th>\r\n                      <th className=\"px-4 py-3 text-center\">Apreciación</th>\r\n                      <th className=\"px-4 py-3 text-center\">Examen</th>\r\n                      <th className=\"px-4 py-3 text-center\">Asistencia</th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {estudiantes.map(estudiante => {\r\n                      const asistencia = contarAsistencias(estudiante);\r\n                      const totalAsistencias = asistencia.presente + asistencia.tardanza + asistencia.ausente;\r\n                      const porcentajeAsistencia = totalAsistencias > 0 ? Math.round((asistencia.presente / totalAsistencias) * 100) : 0;\r\n                      \r\n                      return (\r\n                        <tr key={estudiante.id} className=\"border-b border-gray-200 hover:bg-gray-50\">\r\n                          <td className=\"px-4 py-3 font-semibold\">{estudiante.nombre}</td>\r\n                          <td className=\"px-4 py-3 text-center\">\r\n                            <span className={`font-bold ${\r\n                              parseFloat(calcularPromedioFinal(estudiante)) >= 4.5 ? 'text-green-600' :\r\n                              parseFloat(calcularPromedioFinal(estudiante)) >= 3.5 ? 'text-blue-600' :\r\n                              parseFloat(calcularPromedioFinal(estudiante)) >= 3.0 ? 'text-yellow-600' : 'text-red-600'\r\n                            }`}>\r\n                              {calcularPromedioFinal(estudiante)}/5\r\n                            </span>\r\n                          </td>\r\n                          <td className=\"px-4 py-3 text-center text-sm\">\r\n                            {calcularTotalSeccion(estudiante.notasDiarias)} ({estudiante.notasDiarias.length})\r\n                          </td>\r\n                          <td className=\"px-4 py-3 text-center text-sm\">\r\n                            {calcularTotalSeccion(estudiante.apreciacion)} ({estudiante.apreciacion.length})\r\n                          </td>\r\n                          <td className=\"px-4 py-3 text-center text-sm\">\r\n                            {calcularTotalSeccion(estudiante.examen)} ({estudiante.examen.length})\r\n                          </td>\r\n                          <td className=\"px-4 py-3 text-center\">\r\n                            <span className={`font-semibold ${\r\n                              porcentajeAsistencia >= 90 ? 'text-green-600' :\r\n                              porcentajeAsistencia >= 80 ? 'text-yellow-600' : 'text-red-600'\r\n                            }`}>\r\n                              {porcentajeAsistencia}%\r\n                            </span>\r\n                          </td>\r\n                        </tr>\r\n                      );\r\n                    })}\r\n                  </tbody>\r\n                </table>\r\n              </div>\r\n              {estudiantes.length === 0 && (\r\n                <div className=\"text-center py-8 text-gray-500\">\r\n                  <p>No hay estudiantes en esta clase</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {view === 'planificacion' && (\r\n          <div className=\"bg-white rounded-2xl shadow-lg p-6 md:p-8\">\r\n            <h2 className=\"text-2xl md:text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3\">\r\n              <Sparkles className=\"w-8 h-8 text-purple-600\" />\r\n              Generador de Planes Trimestrales con IA\r\n            </h2>\r\n            \r\n            {!planGenerado ? (\r\n              <div className=\"space-y-6\">\r\n                <div className=\"bg-gradient-to-br from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-6 mb-6\">\r\n                  <div className=\"flex items-start gap-4\">\r\n                    <Sparkles className=\"w-8 h-8 text-purple-600 flex-shrink-0 mt-1\" />\r\n                    <div>\r\n                      <h3 className=\"font-bold text-purple-900 text-lg mb-2\">✨ Planes Trimestrales con IA</h3>\r\n                      <p className=\"text-purple-800 text-sm\">\r\n                        Genera planes trimestrales completos alineados con el currículo del MEDUCA de Panamá. \r\n                        Nuestra IA crea contenido detallado con contenidos, competencias, metodologías y evaluaciones \r\n                        específicas para cada trimestre.\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                \r\n                <div className=\"bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl p-6\">\r\n                  <h3 className=\"text-xl font-bold text-gray-800 mb-4\">Información del Plan Trimestral</h3>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Nombre del Profesor\"\r\n                      value={nombreProfesor}\r\n                      onChange={(e) => setNombreProfesor(e.target.value)}\r\n                      className=\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                    />\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Institución Educativa\"\r\n                      value={institucion}\r\n                      onChange={(e) => setInstitucion(e.target.value)}\r\n                      className=\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                    />\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Grado (ej: 5to)\"\r\n                      value={gradoPlan}\r\n                      onChange={(e) => setGradoPlan(e.target.value)}\r\n                      className=\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                    />\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Materia (ej: Matemáticas)\"\r\n                      value={materia}\r\n                      onChange={(e) => setMateria(e.target.value)}\r\n                      className=\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                    />\r\n                    <select\r\n                      value={trimestre}\r\n                      onChange={(e) => setTrimestre(e.target.value)}\r\n                      className=\"px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-purple-500\"\r\n                    >\r\n                      <option value=\"Primer Trimestre\">Primer Trimestre</option>\r\n                      <option value=\"Segundo Trimestre\">Segundo Trimestre</option>\r\n                      <option value=\"Tercer Trimestre\">Tercer Trimestre</option>\r\n                    </select>\r\n                    <div className=\"md:col-span-2\">\r\n                      <p className=\"text-sm text-gray-600 mb-2\">\r\n                        💡 Selecciona el trimestre para el cual deseas generar el plan de estudios completo.\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  <button\r\n                    onClick={generarPlanConOpenAI}\r\n                    disabled={generandoPlan || !nombreProfesor || !institucion || !gradoPlan || !materia || !trimestre}\r\n                    className={`w-full mt-6 py-4 rounded-lg font-bold text-lg flex items-center justify-center gap-3 transition ${\r\n                      generandoPlan || !nombreProfesor || !institucion || !gradoPlan || !materia || !trimestre\r\n                        ? 'bg-gray-400 cursor-not-allowed'\r\n                        : 'bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white shadow-lg hover:shadow-xl'\r\n                    }`}\r\n                  >\r\n                    {generandoPlan ? (\r\n                      <>\r\n                        <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-white\"></div>\r\n                        Generando Plan Trimestral...\r\n                      </>\r\n                    ) : (\r\n                      <>\r\n                        <Sparkles className=\"w-6 h-6\" />\r\n                        Generar Plan Trimestral con IA\r\n                      </>\r\n                    )}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-6\">\r\n                <div className=\"flex flex-col md:flex-row justify-between items-start gap-4 mb-6\">\r\n                  <div>\r\n                    <h3 className=\"text-2xl font-bold text-gray-800\">Plan {planGenerado.trimestre}</h3>\r\n                    <p className=\"text-gray-600 mt-1\">\r\n                      {planGenerado.asignatura || planGenerado.materia || materia} - {planGenerado.grado || gradoPlan} | {planGenerado.institucion || institucion}\r\n                    </p>\r\n                    <p className=\"text-sm text-gray-500 mt-1\">Profesor: {planGenerado.docente || planGenerado.profesor || nombreProfesor}</p>\r\n                    <p className=\"text-sm text-gray-500\">Trimestre: {planGenerado.trimestre} | Fecha: {planGenerado.fecha}</p>\r\n                    {planGenerado.duracionSemanas && (\r\n                      <p className=\"text-sm text-gray-500\">Duración: {planGenerado.duracionSemanas} semanas</p>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"flex gap-3 flex-wrap\">\r\n                    <OpcionesExportacion\r\n                      datos={JSON.stringify(planGenerado)}\r\n                      nombreArchivo={`Plan_Trimestral_${planGenerado.asignatura || materia}_${planGenerado.trimestre.replace(/\\s+/g, '_')}`}\r\n                    />\r\n                    <button\r\n                      onClick={() => setPlanGenerado(null)}\r\n                      className=\"bg-gray-600 text-white px-6 py-3 rounded-lg hover:bg-gray-700 transition font-bold\"\r\n                    >\r\n                      Nuevo Plan\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n                \r\n                {/* SECCIÓN ACTUALIZADA CON DESARROLLO DE CLASES */}\r\n                {planGenerado.contenidos && Array.isArray(planGenerado.contenidos) && planGenerado.contenidos.length > 0 && (\r\n                  <div className=\"bg-blue-50 rounded-xl p-6\">\r\n                    <h4 className=\"text-xl font-bold text-blue-900 mb-4 flex items-center gap-2\">\r\n                      📚 Contenidos del {planGenerado.trimestre}\r\n                    </h4>\r\n                    <ul className=\"space-y-2\">\r\n                      {planGenerado.contenidos.map((cont, i) => (\r\n                        <li key={i} className=\"flex gap-3\">\r\n                          <span className=\"text-blue-600 font-bold\">{i + 1}.</span>\r\n                          <span className=\"text-gray-800\">{cont}</span>\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                )}\r\n                \r\n                {/* DESARROLLO DEL CONTENIDO PARA CLASES */}\r\n                {planGenerado.desarrolloClases && Object.keys(planGenerado.desarrolloClases).length > 0 && (\r\n                  <div className=\"bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl p-6 border-2 border-teal-200\">\r\n                    <h4 className=\"text-xl font-bold text-teal-900 mb-4 flex items-center gap-2\">\r\n                      🎯 Desarrollo del Contenido para Clases\r\n                    </h4>\r\n                    <div className=\"space-y-6\">\r\n                      {Object.entries(planGenerado.desarrolloClases).map(([contenidoKey, desarrollo]) => (\r\n                        <div key={contenidoKey} className=\"bg-white rounded-lg p-4 border border-teal-100\">\r\n                          <h5 className=\"font-bold text-lg text-teal-800 mb-3\">📝 {contenidoKey}</h5>\r\n                          \r\n                          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3\">\r\n                            <div>\r\n                              <span className=\"font-semibold text-gray-700\">Duración:</span>\r\n                              <span className=\"ml-2 text-teal-600\">{desarrollo.duracion || '3 sesiones de 45 minutos'}</span>\r\n                            </div>\r\n                          </div>\r\n\r\n                          {desarrollo.objetivos && desarrollo.objetivos.length > 0 && (\r\n                            <div className=\"mb-3\">\r\n                              <h6 className=\"font-semibold text-gray-700 mb-2\">Objetivos de Aprendizaje:</h6>\r\n                              <ul className=\"space-y-1\">\r\n                                {desarrollo.objetivos.map((objetivo, idx) => (\r\n                                  <li key={idx} className=\"flex gap-2\">\r\n                                    <span className=\"text-teal-500\">•</span>\r\n                                    <span className=\"text-gray-700\">{objetivo}</span>\r\n                                  </li>\r\n                                ))}\r\n                              </ul>\r\n                            </div>\r\n                          )}\r\n\r\n                          {desarrollo.materiales && desarrollo.materiales.length > 0 && (\r\n                            <div className=\"mb-3\">\r\n                              <h6 className=\"font-semibold text-gray-700 mb-2\">Materiales necesarios:</h6>\r\n                              <ul className=\"space-y-1\">\r\n                                {desarrollo.materiales.map((material, idx) => (\r\n                                  <li key={idx} className=\"flex gap-2\">\r\n                                    <span className=\"text-teal-500\">•</span>\r\n                                    <span className=\"text-gray-700\">{material}</span>\r\n                                  </li>\r\n                                ))}\r\n                              </ul>\r\n                            </div>\r\n                          )}\r\n\r\n                          {desarrollo.fases && desarrollo.fases.length > 0 && (\r\n                            <div>\r\n                              <h6 className=\"font-semibold text-gray-700 mb-2\">Fases de la actividad:</h6>\r\n                              <div className=\"space-y-3\">\r\n                                {desarrollo.fases.map((fase, index) => (\r\n                                  <div key={index} className=\"bg-gray-50 rounded-lg p-3\">\r\n                                    <h7 className=\"font-semibold text-gray-800 mb-2\">\r\n                                      SESIÓN {index + 1} - {fase.titulo || 'Desarrollo'}\r\n                                    </h7>\r\n                                    <div className=\"space-y-2\">\r\n                                      {fase.actividades && fase.actividades.map((actividad, actIdx) => (\r\n                                        <div key={actIdx} className=\"flex gap-2 text-sm\">\r\n                                          <span className=\"font-medium text-teal-600 whitespace-nowrap\">\r\n                                            {actividad.tiempo}:\r\n                                          </span>\r\n                                          <span className=\"text-gray-700\">{actividad.descripcion}</span>\r\n                                        </div>\r\n                                      ))}\r\n                                    </div>\r\n                                  </div>\r\n                                ))}\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                \r\n                {planGenerado.competencias && Array.isArray(planGenerado.competencias) && planGenerado.competencias.length > 0 && (\r\n                  <div className=\"bg-purple-50 rounded-xl p-6\">\r\n                    <h4 className=\"text-xl font-bold text-purple-900 mb-4 flex items-center gap-2\">\r\n                      💪 Competencias a Desarrollar\r\n                    </h4>\r\n                    <ul className=\"space-y-2\">\r\n                      {planGenerado.competencias.map((comp, i) => (\r\n                        <li key={i} className=\"flex gap-3\">\r\n                          <span className=\"text-purple-600\">{i + 1}.</span>\r\n                          <span className=\"text-gray-800\">{comp}</span>\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                )}\r\n                \r\n                {planGenerado.indicadoresLogro && Array.isArray(planGenerado.indicadoresLogro) && planGenerado.indicadoresLogro.length > 0 && (\r\n                  <div className=\"bg-teal-50 rounded-xl p-6\">\r\n                    <h4 className=\"text-xl font-bold text-teal-900 mb-4 flex items-center gap-2\">\r\n                      ✅ Indicadores de Logro\r\n                    </h4>\r\n                    <ul className=\"space-y-2\">\r\n                      {planGenerado.indicadoresLogro.map((ind, i) => (\r\n                        <li key={i} className=\"flex gap-3\">\r\n                          <span className=\"text-teal-600\">•</span>\r\n                          <span className=\"text-gray-800\">{ind}</span>\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                )}\r\n                \r\n                {planGenerado.metodologia && (\r\n                  <div className=\"bg-green-50 rounded-xl p-6\">\r\n                    <h4 className=\"text-xl font-bold text-green-900 mb-4 flex items-center gap-2\">\r\n                      📖 Estrategias Metodológicas\r\n                    </h4>\r\n                    <p className=\"text-gray-800\">{planGenerado.metodologia}</p>\r\n                  </div>\r\n                )}\r\n                \r\n                {planGenerado.recursos && Array.isArray(planGenerado.recursos) && planGenerado.recursos.length > 0 && (\r\n                  <div className=\"bg-indigo-50 rounded-xl p-6\">\r\n                    <h4 className=\"text-xl font-bold text-indigo-900 mb-4 flex items-center gap-2\">\r\n                      🛠️ Recursos Educativos\r\n                    </h4>\r\n                    <ul className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">\r\n                      {planGenerado.recursos.forEach((rec, i) => (\r\n                        <li key={i} className=\"flex gap-2 items-center\">\r\n                          <span className=\"text-indigo-600\">•</span>\r\n                          <span className=\"text-gray-800\">{rec}</span>\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                )}\r\n\r\n                {planGenerado.evaluacion && Array.isArray(planGenerado.evaluacion) && planGenerado.evaluacion.length > 0 && (\r\n                  <div className=\"bg-red-50 rounded-xl p-6\">\r\n                    <h4 className=\"text-xl font-bold text-red-900 mb-4 flex items-center gap-2\">\r\n                      📊 Instrumentos de Evaluación\r\n                    </h4>\r\n                    <ul className=\"space-y-2\">\r\n                      {planGenerado.evaluacion.map((evalItem, i) => (\r\n                        <li key={i} className=\"flex gap-3\">\r\n                          <span className=\"text-red-600\">•</span>\r\n                          <span className=\"text-gray-800\">{evalItem}</span>\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                )}\r\n\r\n                {planGenerado.adaptaciones && Array.isArray(planGenerado.adaptaciones) && planGenerado.adaptaciones.length > 0 && (\r\n                  <div className=\"bg-orange-50 rounded-xl p-6\">\r\n                    <h4 className=\"text-xl font-bold text-orange-900 mb-4 flex items-center gap-2\">\r\n                      ♿ Adaptaciones Curriculares\r\n                    </h4>\r\n                    <ul className=\"space-y-2\">\r\n                      {planGenerado.adaptaciones.map((adap, i) => (\r\n                        <li key={i} className=\"flex gap-3\">\r\n                          <span className=\"text-orange-600\">•</span>\r\n                          <span className=\"text-gray-800\">{adap}</span>\r\n                        </li>\r\n                      ))}\r\n                    </ul>\r\n                  </div>\r\n                )}\r\n                \r\n                {planGenerado.observaciones && (\r\n                  <div className=\"bg-gray-100 rounded-xl p-6\">\r\n                    <h4 className=\"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2\">\r\n                      📝 Observaciones\r\n                    </h4>\r\n                    <p className=\"text-gray-800\">{planGenerado.observaciones}</p>\r\n                  </div>\r\n                )}\r\n\r\n                <div className=\"bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl p-6 text-center\">\r\n                  <p className=\"text-purple-800 font-semibold\">\r\n                    ✅ Plan trimestral generado exitosamente con IA\r\n                  </p>\r\n                  <p className=\"text-sm text-purple-600 mt-1\">\r\n                    Puedes descargar este plan en formato de texto para guardarlo o imprimirlo.\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </main>\r\n\r\n      <footer className=\"bg-gray-800 text-white py-6 mt-12\">\r\n        <div className=\"container mx-auto px-4 text-center\">\r\n          <p className=\"text-sm\">\r\n            © 2025 Bringo Edu - Asistente Inteligente para Profesores\r\n          </p>\r\n          <p className=\"text-xs text-gray-400 mt-2\">\r\n            Desarrollado por GermanApp | Potenciado por IA\r\n          </p>\r\n        </div>\r\n            </footer>\r\n    </div>\r\n  );\r\n\r\n  window._forceExportFunctions = {\r\n    exportarAExcel,\r\n    exportarAPDF, \r\n    exportarAWord,\r\n    generarBlobPorFormato,\r\n    subirAGoogleDrive,\r\n    OpcionesExportacion\r\n  };\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}